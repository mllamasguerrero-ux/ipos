
<UserControl x:Class="IposV3.Views.PuntoCompraListView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:cal="http://www.caliburnproject.org"
             xmlns:Syncfusion="http://schemas.syncfusion.com/wpf"
                xmlns:SfExt="clr-namespace:SyncfusionExt;assembly=UICommon"
            xmlns:local="clr-namespace:IposV3"
            xmlns:localCommon="clr-namespace:UICommon;assembly=UICommon"
            xmlns:localCont="clr-namespace:Controls;assembly=UICommon"
            xmlns:localConv="clr-namespace:Converters;assembly=UICommon"
              xmlns:cbind="clr-namespace:CalcBinding;assembly=CalcBinding"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:ac="clr-namespace:AdornedControl;assembly=AdornedControl"
             mc:Ignorable="d"
             Name="CurrentUserControl"
            Height="{Binding Source={x:Static SystemParameters.PrimaryScreenHeight}, Converter={localConv:WindowSizeConverter}, ConverterParameter='0.75'}" 
            Width="{Binding Source={x:Static SystemParameters.PrimaryScreenWidth}, Converter={localConv:WindowSizeConverter}, ConverterParameter='0.75'}"
             >

    <UserControl.Resources>

        <Style x:Key="customCellStyle" TargetType="Syncfusion:VirtualizingCellsControl">
            <Setter Property="cal:Message.Attach" Value="[Event MouseDoubleClick] = [Action SelectItemByCell($dataContext)]"/>
        </Style>

        <Style x:Key="filterControlStyle" TargetType="Syncfusion:GridFilterControl">
            <Setter Property="FilterMode" Value="AdvancedFilter" />
        </Style>


        <localConv:DateTimeOffsetToDateTimeConverter x:Key="DateTimeOffsetToDateTimeConverter"/>

    </UserControl.Resources>

    <ScrollViewer x:Name="MainScrollViewer" HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto" >
        <StackPanel Name="ForePanel"  HorizontalAlignment="Stretch"  VerticalAlignment="Stretch"   >
            <localCont:MessageBoxV2 MessageToUser="{Binding MessageToUser}"  Width="10"  HorizontalAlignment="Right"/>
            <ScrollViewer x:Name="ScrollViewerWrap" HorizontalAlignment="Stretch" HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto" 
                       Height="{Binding ElementName=ForePanel, Path=ActualHeight, Converter={localConv:MathConverter}, ConverterParameter=14*x/60}" MinHeight="180">
                <WrapPanel Name="MainPanel"  HorizontalAlignment="Stretch"  VerticalAlignment="Stretch" MinWidth="100" MinHeight="100" >
                    <StackPanel MinWidth="150" Width="{Binding ElementName=MainPanel, Path=ActualWidth, Converter={localConv:MathConverter}, ConverterParameter=x}"    >
                        <TextBlock Style="{StaticResource MaterialDesignHeadline5TextBlock}">Compras</TextBlock>
                    </StackPanel>



                    <StackPanel MinWidth="150" Width="{Binding ElementName=MainPanel, Path=ActualWidth, Converter={localConv:MathConverter}, ConverterParameter=1.5*x/12.5}"  Height="75" Margin="10,0" >
                        <Label Style="{DynamicResource LabelPanelHeaderTemplate}" Margin="0,0,0,0"  Content="Tipo de transaccion" />
                        <ComboBox  x:Name="P_tipodoctoid" 
			ItemsSource="{Binding Catalogs[Tipodocto_Proveeduria]}"
                        
                        SelectedValuePath="Id"
                        SelectedValue="{Binding ListParam.P_tipodoctoid}"
                        DisplayMemberPath="Nombre" />
                    </StackPanel>

                    <StackPanel MinWidth="150" Width="{Binding ElementName=MainPanel, Path=ActualWidth, Converter={localConv:MathConverter}, ConverterParameter=1.5*x/12.5}"  Height="75"  Margin="10,0" >
                        <Label Style="{DynamicResource LabelPanelHeaderTemplate}" Margin="0,0,0,0"  Content="Estado de transaccion" />
                        <ComboBox  x:Name="P_estatusdoctoid" 
			                ItemsSource="{Binding Catalogs[Estatusdocto_Proveeduria]}"
                        
                        SelectedValuePath="Id"
                        SelectedValue="{Binding ListParam.P_estatusdoctoid}"
                        DisplayMemberPath="Nombre" />
                    </StackPanel>


                    <StackPanel MinWidth="110" Width="{Binding ElementName=MainPanel, Path=ActualWidth, Converter={localConv:MathConverter}, ConverterParameter=2*x/12.5}"  Height="65"  >
                        <Label Style="{DynamicResource LabelFieldFormTemplate}" Margin="10,0,10,0"  Content="Todos los usuarios" HorizontalAlignment="Center" />
                        <CheckBox x:Name="TodosUsuarios"  IsChecked="{Binding ListParam.P_todosUsuarios, Converter={localConv:BooleanConverter}}" HorizontalAlignment="Center" Margin="10,0,10,0"  VerticalAlignment="Top"   />
                    </StackPanel>

                    <StackPanel MinWidth="150" Width="{Binding ElementName=MainPanel, Path=ActualWidth, Converter={localConv:MathConverter}, ConverterParameter=3*x/12.5}"  Height="75" Margin="10,0"  >
                        <Label Style="{DynamicResource LabelPanelHeaderTemplate}" Margin="10,0,10,0"  Content="Usuario" />
                        <WrapPanel>
                            <TextBox x:Name="P_usuarioclave" Text="{Binding ListParam.P_usuarioclave}" Margin="10,0,10,0"  HorizontalAlignment="Left" Width="50"    />
                            <TextBox x:Name="P_usuarionombre" Text="{Binding ListParam.P_usuarionombre}" Margin="10,0,10,0"  HorizontalAlignment="Left" Width="100"  IsReadOnly="True" />
                            <Button  x:Name="P_usuarioidButton" VerticalAlignment="Top" Margin="10,0,10,0" cal:Message.Attach="[Event Click] = [Action ShowPopUpSelector('P_usuarioclave')]"  Width="24"  Height="24"  Style="{StaticResource MaterialDesignIconButton}" >
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="Binoculars"/>
                                </StackPanel>
                            </Button>
                        </WrapPanel>
                    </StackPanel>

                    <StackPanel MinWidth="110" Width="{Binding ElementName=MainPanel, Path=ActualWidth, Converter={localConv:MathConverter}, ConverterParameter=2*x/12.5}"  Height="65"  >
                        <Label Style="{DynamicResource LabelFieldFormTemplate}" Margin="10,0,10,0"  Content="Corte actual" HorizontalAlignment="Center" />
                        <CheckBox x:Name="CorteActual"  IsChecked="{Binding ListParam.P_corteActual, Converter={localConv:BooleanConverter}}" HorizontalAlignment="Center" Margin="10,0,10,0"  VerticalAlignment="Top"   />
                    </StackPanel>

                    <StackPanel MinWidth="110" Width="{Binding ElementName=MainPanel, Path=ActualWidth, Converter={localConv:MathConverter}, ConverterParameter=2*x/12.5}"  Height="65"  >
                        <Label Style="{DynamicResource LabelFieldFormTemplate}" Margin="10,0,10,0"  Content="Por fecha" HorizontalAlignment="Center" />
                        <CheckBox x:Name="PorFecha"  IsChecked="{Binding ListParam.P_porFecha, Converter={localConv:BooleanConverter}}" HorizontalAlignment="Center" Margin="10,0,10,0"  VerticalAlignment="Top"   />
                    </StackPanel>


                    <StackPanel MinWidth="150" Width="{Binding ElementName=MainPanel, Path=ActualWidth, Converter={localConv:MathConverter}, ConverterParameter=1.5*x/12.5}"  Height="75" Margin="10,0"  >
                        <Label Style="{DynamicResource LabelPanelHeaderTemplate}" Margin="10,0,10,0"  Content="Fecha inicial" />
                        <DatePicker x:Name="P_fechaini" HorizontalAlignment="Left" Margin="10,0,0,0"  VerticalAlignment="Top" SelectedDate="{Binding Converter={StaticResource DateTimeOffsetToDateTimeConverter}, Path=ListParam.P_fechaini }"  />
                    </StackPanel>

                    <StackPanel MinWidth="150" Width="{Binding ElementName=MainPanel, Path=ActualWidth, Converter={localConv:MathConverter}, ConverterParameter=1.5*x/12.5}"  Height="75"  Margin="10,0" >
                        <Label Style="{DynamicResource LabelPanelHeaderTemplate}" Margin="10,0,10,0"  Content="Fecha final" />
                        <DatePicker x:Name="P_fechafin" HorizontalAlignment="Left" Margin="10,0,0,0"  VerticalAlignment="Top" SelectedDate="{Binding Converter={StaticResource DateTimeOffsetToDateTimeConverter}, Path=ListParam.P_fechafin }"  />
                    </StackPanel>





                    <StackPanel MinWidth="110" Width="{Binding ElementName=MainPanel, Path=ActualWidth, Converter={localConv:MathConverter}, ConverterParameter=2*x/12.5}"  Height="65" Visibility="{cbind:Binding BShowAlmacen}" >
                        <Label Style="{DynamicResource LabelFieldFormTemplate}" Margin="10,0,10,0"  Content="Todos los almacenes" HorizontalAlignment="Center" />
                        <CheckBox x:Name="TodosAlmacenes"  IsChecked="{Binding ListParam.P_todosAlmacenes, Converter={localConv:BooleanConverter}}" HorizontalAlignment="Center" Margin="10,0,10,0"  VerticalAlignment="Top" 
                                IsEnabled="{cbind:Binding BEnableAlmacen}"  />
                    </StackPanel>


                    <StackPanel MinWidth="150" Width="{Binding ElementName=MainPanel, Path=ActualWidth, Converter={localConv:MathConverter}, ConverterParameter=1.5*x/12.5}"  Height="75"  Margin="10,0" Visibility="{cbind:Binding BShowAlmacen}">
                        <Label Style="{DynamicResource LabelPanelHeaderTemplate}" Margin="0,0,0,0"  Content="Almacen" />
                        <ComboBox  x:Name="P_almacenid" 
			                ItemsSource="{Binding Catalogs[Almacen]}"
                        
                        SelectedValuePath="Id"
                        SelectedValue="{Binding ListParam.P_almacenid}"
                        DisplayMemberPath="Nombre" 
                        IsEnabled="{cbind:Binding BEnableAlmacen}"/>
                    </StackPanel>

                    <StackPanel  MinWidth="150" Width="{Binding ElementName=MainPanel, Path=ActualWidth, Converter={localConv:MathConverter}, ConverterParameter=1.5*x/12.5}"   >
                        <WrapPanel>
                            <Button x:Name="TSBBuscar" VerticalAlignment="Top" Width="43"  Height="30" Margin="10,30,10,0" Style="{StaticResource MaterialDesignIconButton}">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="FileDocumentBoxSearchOutline"/>
                                </StackPanel>
                            </Button>
                        </WrapPanel>
                    </StackPanel>

                </WrapPanel>
            </ScrollViewer>



            <ac:AdornedControl IsAdornerVisible="{Binding IsBusy}"
		        >
             <ac:AdornedControl.AdornerContent>
                    <localCont:LoadingWait></localCont:LoadingWait>
             </ac:AdornedControl.AdornerContent>

             <Syncfusion:SfDataGrid x:Name="SfTableDataGridView" 
                      ItemsSource="{Binding Items}" 
                      RowStyle="{StaticResource customCellStyle}"
                       AllowFiltering="True"
                       FilterPopupStyle="{StaticResource filterControlStyle}"
                      Margin="2,2,2,2"  AutoGenerateColumns="False" Background="#FFFFFFFF" IsReadOnly="True"  RowHeight="35" HorizontalAlignment="Left"   
                                   MinWidth="100" Width="{Binding ElementName=MainScrollViewer, Path=ActualWidth, Converter={localConv:MathConverter}, ConverterParameter=x}"
                       Height="{Binding ElementName=ForePanel, Path=ActualHeight, Converter={localConv:MathConverter}, ConverterParameter=42*x/60}" MinHeight="150"  >
                <Syncfusion:SfDataGrid.Columns>


                        <Syncfusion:GridTextColumn  MappingName="Folio" HeaderText="Folio" ColumnSizer="SizeToHeader"/>

                        <Syncfusion:GridTextColumn  MappingName="Proveedornombre" HeaderText="Proveedor" ColumnSizer="SizeToHeader"/>

                        <Syncfusion:GridTextColumn  MappingName="Fecha" HeaderText="Fecha" ColumnSizer="SizeToHeader"/>

                        <Syncfusion:GridTextColumn  MappingName="Tipodoctonombre" HeaderText="Tipo" ColumnSizer="SizeToHeader"/>

                        <Syncfusion:GridTextColumn  MappingName="Estatusdoctonombre" HeaderText="Estatus" ColumnSizer="SizeToHeader"/>

                        <Syncfusion:GridTextColumn  MappingName="Total" HeaderText="Total" ColumnSizer="SizeToHeader"/>

                        <Syncfusion:GridTextColumn  MappingName="Referencia" HeaderText="Referencia" ColumnSizer="SizeToHeader"/>

                        <Syncfusion:GridTextColumn  MappingName="Almacennombre" HeaderText="Almacen" ColumnSizer="SizeToHeader"/>

                        <Syncfusion:GridTextColumn  MappingName="Sucursaltnombre" HeaderText="Sucursal Origen" ColumnSizer="SizeToHeader"/>

                        <Syncfusion:GridTextColumn  MappingName="Usuarionombre" HeaderText="Usuario" ColumnSizer="SizeToHeader"/>


                    </Syncfusion:SfDataGrid.Columns>
              </Syncfusion:SfDataGrid>
            </ac:AdornedControl>

        </StackPanel>
    </ScrollViewer>

</UserControl>
