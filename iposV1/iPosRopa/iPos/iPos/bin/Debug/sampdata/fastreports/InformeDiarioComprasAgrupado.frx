<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" StartReportEvent="_StartReport" ReportInfo.Created="05/06/2014 21:00:03" ReportInfo.Modified="09/06/2017 08:37:27" ReportInfo.CreatorVersion="2013.3.2.0">
  <ScriptText>using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;
using System.Drawing;
using System.Data;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;

namespace FastReport
{
  
  public class TextPositions
  {
       public TextObject textField;
       public float initialX;
       public string strField;
    public TextPositions(ref TextObject p_textField)
    {
      textField = p_textField;
      initialX = p_textField.Left;
    }
    
    public TextPositions(ref TextObject p_textField, string p_strField)
    {
      textField = p_textField;
      initialX = p_textField.Left;
      strField = p_strField;
    }
    
    
    
  }
  
  public class ReportScript
  {
     
    static float posicionInicioTextFlex;
    static TextPositions[] textFlex;    
    static TextPositions[] textIEPSPorc; 
    
         
    private void ReportTitle1_BeforePrint(object sender, EventArgs e)
    {      
      
                        
            
    }
             
              
        

       


    private void _StartReport(object sender, EventArgs e)
    {
         Report.SetParameterValue(&quot;REMISIONFACTURA&quot;, &quot;T&quot;); 
      Report.SetParameterValue(&quot;TIPODOCTOID&quot;, -21);  
      Report.SetParameterValue(&quot;TIPODOCTONOMBRE&quot;, &quot;TODOS&quot;); 
      Report.SetParameterValue(&quot;REMISIONFACTURADESC&quot;, &quot;TODOS&quot;);
    }

    private void btnOk_Click(object sender, EventArgs e)
    {
      //Get Sucursal_Clave from sucursal combobox
      if(sucursalCheckBox.Checked)
      {
        Report.SetParameterValue(&quot;sucursal&quot;, &quot;TODOS&quot;);
        //MessageBox.Show(&quot;TODOS&quot;);
      }
      else
      {
        String[] sucData = sucursalComboBox.Text.Split('-');
        Report.SetParameterValue(&quot;sucursal&quot;, sucData[0]);
        
        //MessageBox.Show(sucData[0]);
      }
    }
  }
}
</ScriptText>
  <Dictionary>
    <FirebirdDataConnection Name="Connection" ConnectionString="rijcmlqDEsChHWgW5OFiwSyA3zls2mCAWDWIhtE3dZ3WRoD3RGa4fuV4MzKWm/7hfiVWbDFvOZVx8SOHX0gb5rmLrybnbvH2HsHWOfPgCFQoKr29izDhiy+8Awj/+LeDV/2ybkkaRwuppBeY+kFp2ZduFz9uuG/YK5QFZgnnVzy4QXbSuM=">
      <TableDataSource Name="Table" DataType="System.Int32" Enabled="true" SelectCommand="SELECT&#13;&#10;      D.FECHA,&#13;&#10;      D.timbradofechafactura,&#13;&#10;      D.FECHAHORA,&#13;&#10;      D.FOLIO DOCTOFOLIO,&#13;&#10;      D.FOLIOSAT,&#13;&#10;      D.IMPORTE,&#13;&#10;      D.DESCUENTO,&#13;&#10;      D.SUBTOTAL,&#13;&#10;      D.IVA,&#13;&#10;      D.TOTAL - COALESCE(D.montorebaja, 0) TOTAL,&#13;&#10;      coalesce(S.NOMBRE,' ') as SUCURSALT ,&#13;&#10;      coalesce(TD.nombre, ' ') AS TIPODOC,&#13;&#10;      P.NOMBRE as PERSONA ,&#13;&#10;      D.SALDO, &#13;&#10;      D.esfacturaelectronica ,&#13;&#10;     coalesce(D.foliosat,'') SERIEFOLIOSAT ,&#13;&#10;      U.nombre VENDEDOR ,&#13;&#10;      coalesce(P.vendedorid,0) VENDEDORDELCLIENTEID,&#13;&#10;      coalesce(uc.nombre,'') VENDEDORDELCLIENTENOMBRE ,&#13;&#10;      coalesce(uc.clave,'') VENDEDORDELCLIENTECLAVE,&#13;&#10;&#13;&#10;      D.IEPS,&#13;&#10;      D.IMPUESTO ,&#13;&#10;&#13;&#10;      p.clave PERSONACLAVE,&#13;&#10;      p.nombres PERSONANOMBRES,&#13;&#10;      p.apellidos PERSONAAPELLIDOS, &#13;&#10;      p.rfc,&#13;&#10;      D.VENCE FECHAVENCE,&#13;&#10;      D.ID ,&#13;&#10;      D.VENDEDORID,&#13;&#10;&#13;&#10;      CASE WHEN COALESCE(D.ESFACTURAELECTRONICA,'N') &lt;&gt; 'S' THEN 'REMISION' ELSE 'FACTURA' END ESTATUS,&#13;&#10;      COALESCE(D.doctokitrefid,0) DOCTOKITREFID ,&#13;&#10;      COALESCE(D.ALMACENID,0) ALMACENID,&#13;&#10;      COALESCE(D.VENDEDORID, 0) VENDEDORID,&#13;&#10;      D.almacentid  ,&#13;&#10;      A.nombre NOMBREALMACEN  ,&#13;&#10;      ALT.nombre NOMBREALMACENTRASPASO ,&#13;&#10;      D.MONTOREBAJA, &#13;&#10;      '' SUCURSAL_CLAVE ,&#13;&#10;&#13;&#10;cast(EXTRACT(MONTH FROM d.fecha) as varchar(10)) || '--'  || cast(EXTRACT(YEAR FROM d.fecha) as varchar(10))MES&#13;&#10;&#13;&#10;   FROM  DOCTO D &#13;&#10;       left join SUCURSAL S&#13;&#10;         ON S.ID = D.SUCURSALTID&#13;&#10;        left join TIPODOCTO  TD&#13;&#10;         on  TD.id = d.tipodoctoid &#13;&#10;         left join PERSONA P&#13;&#10;          on P.id = D.personaid  &#13;&#10;            left join PERSONA U&#13;&#10;                on D.vendedorid = u.id  &#13;&#10;            left join PERSONA Uc&#13;&#10;                on P.vendedorid = uc.id  &#13;&#10;                  left join almacen A on A.ID = D.almacenid  &#13;&#10;                    left join almacen ALT on ALT.ID = D.almacentid &#13;&#10;&#13;&#10;&#13;&#10; WHERE (TIPODOCTOID = 11)&#13;&#10;     AND D.FECHA BETWEEN cast(@FECHAINI as date) AND cast(@FECHAFIN as date)&#13;&#10;     AND D.ESTATUSDOCTOID = 1 &#13;&#10;	 AND ( @STR_REMISIONFACTURA = 'T' OR ( @STR_REMISIONFACTURA = 'F' AND  D.ESFACTURAELECTRONICA = 'S') OR ( @STR_REMISIONFACTURA = 'R' AND  D.ESFACTURAELECTRONICA = 'N') )&#13;&#10;&#13;&#10;		&#13;&#10;					&#13;&#10;  &#13;&#10;&#13;&#10;     ORDER BY d.fecha  , D.FECHAHORA">
        <Column Name="FECHA" DataType="System.DateTime"/>
        <Column Name="FECHAHORA" DataType="System.DateTime"/>
        <Column Name="IMPORTE" DataType="System.Decimal"/>
        <Column Name="DESCUENTO" DataType="System.Decimal"/>
        <Column Name="SUBTOTAL" DataType="System.Decimal"/>
        <Column Name="IVA" DataType="System.Decimal"/>
        <Column Name="TOTAL" DataType="System.Decimal"/>
        <Column Name="SUCURSALT" DataType="System.String"/>
        <Column Name="TIPODOC" DataType="System.String"/>
        <Column Name="SALDO" DataType="System.Decimal"/>
        <Column Name="ESFACTURAELECTRONICA" DataType="System.String"/>
        <Column Name="SERIEFOLIOSAT" DataType="System.String"/>
        <Column Name="PERSONA" DataType="System.String"/>
        <Column Name="VENDEDORDELCLIENTEID" DataType="System.Int64"/>
        <Column Name="VENDEDORDELCLIENTENOMBRE" DataType="System.String"/>
        <Column Name="VENDEDORDELCLIENTECLAVE" DataType="System.String"/>
        <Column Name="IEPS" DataType="System.Decimal"/>
        <Column Name="IMPUESTO" DataType="System.Decimal"/>
        <Column Name="FECHAVENCE" DataType="System.DateTime"/>
        <Column Name="NOMBREALMACEN" DataType="System.String"/>
        <Column Name="ESTATUS" DataType="System.String"/>
        <Column Name="ALMACENTID" DataType="System.Int64"/>
        <Column Name="NOMBREALMACENTRASPASO" DataType="System.String"/>
        <Column Name="MONTOREBAJA" DataType="System.Decimal"/>
        <Column Name="TIMBRADOFECHAFACTURA" DataType="System.DateTime"/>
        <Column Name="FOLIOSAT" DataType="System.Int32"/>
        <Column Name="RFC" DataType="System.String"/>
        <Column Name="ID" DataType="System.Int64"/>
        <Column Name="VENDEDORID" DataType="System.Int64"/>
        <Column Name="DOCTOKITREFID" DataType="System.Int64"/>
        <Column Name="ALMACENID" DataType="System.Int64"/>
        <Column Name="VENDEDORID1" DataType="System.Int64"/>
        <Column Name="DOCTOFOLIO" DataType="System.Int32"/>
        <Column Name="VENDEDOR" DataType="System.String"/>
        <Column Name="PERSONACLAVE" DataType="System.String"/>
        <Column Name="PERSONANOMBRES" DataType="System.String"/>
        <Column Name="PERSONAAPELLIDOS" DataType="System.String"/>
        <Column Name="SUCURSAL_CLAVE" DataType="System.String"/>
        <Column Name="MES" DataType="System.Int32"/>
        <CommandParameter Name="FECHAINI" DataType="4" Expression="[FECHAINI]" DefaultValue="01/01/2001"/>
        <CommandParameter Name="FECHAFIN" DataType="4" Expression="[FECHAFIN]" DefaultValue="01/01/2001"/>
        <CommandParameter Name="TIPODOCTOID" Expression="[TIPODOCTOID]" DefaultValue="21"/>
        <CommandParameter Name="STR_REMISIONFACTURA" DataType="22" Size="64" Expression="[REMISIONFACTURA]" DefaultValue="T"/>
        <CommandParameter Name="sucursal" DataType="22" Expression="[sucursal]"/>
      </TableDataSource>
      <TableDataSource Name="Table1" Alias="Sucursal" DataType="System.Int32" Enabled="true" SelectCommand="SELECT (SUCURSAL_CLAVE + '-' + SUC.NOMBRE) AS SUCURSAL_DATOS	 &#13;&#10;&#13;&#10;FROM REPSUC&#13;&#10;LEFT JOIN SUCURSAL SUC &#13;&#10;ON SUC.CLAVE = REPSUC.SUCURSAL_CLAVE ">
        <Column Name="SUCURSAL_DATOS" DataType="System.String"/>
      </TableDataSource>
    </FirebirdDataConnection>
    <Parameter Name="FECHAINI" DataType="System.DateTime" Expression="DateTimePicker1.Value"/>
    <Parameter Name="FECHAFIN" DataType="System.DateTime" Expression="DateTimePicker2.Value"/>
    <Parameter Name="TIPODOCTOID" DataType="System.Int32"/>
    <Parameter Name="TIPODOCTONOMBRE" DataType="System.String"/>
    <Parameter Name="REMISIONFACTURA" DataType="System.String"/>
    <Parameter Name="REMISIONFACTURADESC" DataType="System.String"/>
    <Parameter Name="sucursal" DataType="System.String"/>
    <Total Name="SumaTotal" Expression="[Table.TOTAL]" Evaluator="Data1" PrintOn="GroupFooter2"/>
  </Dictionary>
  <ReportPage Name="Page1" Landscape="true" PaperWidth="279.4" PaperHeight="215.9">
    <ReportTitleBand Name="ReportTitle1" Width="980.53" Height="122.85" BeforePrintEvent="ReportTitle1_BeforePrint">
      <TextObject Name="Text67" Left="274.05" Top="9.45" Width="311.85" Height="28.35" CanBreak="false" Text="REPORTE DE COMPRAS" AutoWidth="true" WordWrap="false" Font="Arial, 18pt, style=Bold"/>
      <TextObject Name="Text68" Left="66.15" Top="37.8" Width="66.15" Height="18.9" Text="De la fecha:" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text69" Left="274.05" Top="37.8" Width="47.25" Height="18.9" Text="a:" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text70" Left="66.15" Top="66.15" Width="66.15" Height="18.9" Text="Del tipo:" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text71" Left="132.3" Top="37.8" Width="56.7" Height="18.9" Text="[FECHAINI]" Format="Date" Format.Format="d" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text72" Left="321.3" Top="37.8" Width="236.25" Height="18.9" Text="[FECHAFIN]" Format="Date" Format.Format="d" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text73" Left="132.3" Top="66.15" Width="56.7" Height="18.9" Text="[TIPODOCTONOMBRE]" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text74" Left="623.7" Top="9.45" Width="66.15" Height="18.9" Text="[Date]" Format="Date" Format.Format="d" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text85" Left="274.05" Top="94.5" Width="47.25" Height="18.9" Text="Rem./Fact.:" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text86" Left="321.3" Top="94.5" Width="236.25" Height="18.9" Text="[REMISIONFACTURADESC]" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text23" Left="132.3" Top="94.5" Width="56.7" Height="18.9" Text="[sucursal]"/>
      <TextObject Name="Text24" Left="66.15" Top="94.5" Width="66.15" Height="18.9" Text="SUCURSAL:"/>
    </ReportTitleBand>
    <PageHeaderBand Name="PageHeader1" Top="126.85" Width="980.53" Height="18.9">
      <TextObject Name="Text2" Width="66.15" Height="18.9" Text="TIPO" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text4" Left="66.15" Width="66.15" Height="18.9" Text="FECHA" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text22" Left="812.7" Width="75.6" Height="18.9" Text="SALDO" HorzAlign="Right" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text8" Left="132.3" Width="56.7" Height="18.9" Text="FOLIO" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text38" Left="330.75" Width="226.8" Height="18.9" Text="PERSONA" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text36" Left="274.05" Width="56.7" Height="18.9" Text="PROV" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text14" Left="557.55" Width="66.15" Height="18.9" Text="SUBTOTAL" HorzAlign="Right" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text16" Left="623.7" Width="56.7" Height="18.9" Text="IVA" HorzAlign="Right" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text18" Left="727.65" Width="85.05" Height="18.9" Text="TOTAL" HorzAlign="Right" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text66" Left="680.4" Width="47.25" Height="18.9" Text="IEPS" HorzAlign="Right" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text6" Left="189" Width="85.05" Height="18.9" Text="SUCURSAL" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text44" Left="888.3" Width="85.05" Height="18.9" Text="VENCE" Font="Arial, 8pt, style=Bold"/>
    </PageHeaderBand>
    <GroupHeaderBand Name="GroupHeader1" Top="149.75" Width="980.53" Condition="[Table.SUCURSAL_CLAVE]">
      <GroupHeaderBand Name="GroupHeader2" Top="153.75" Width="980.53" Height="22.9" Condition="[Table.MES]">
        <TextObject Name="Text52" Left="103.95" Top="4" Width="94.5" Height="18.9" Text="[[Table.MES]]" Font="Arial, 9pt"/>
        <TextObject Name="Text94" Left="9.45" Top="4" Width="94.5" Height="18.9" Text="MES:" Font="Arial, 9pt"/>
        <DataBand Name="Data1" Top="180.65" Width="980.53" Height="18.9" DataSource="Table">
          <TextObject Name="Text1" Left="18.9" Width="66.15" Height="18.9" Text="[Table.TIPODOC]" Font="Arial, 8pt"/>
          <TextObject Name="Text3" Left="85.05" Width="66.15" Height="18.9" Text="[Table.FECHA]" Format="Date" Format.Format="d" Font="Arial, 8pt"/>
          <TextObject Name="Text21" Left="812.7" Width="75.6" Height="18.9" Text="[Table.SALDO]" Format="Currency" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator="," Format.CurrencySymbol="$" Format.PositivePattern="0" Format.NegativePattern="1" HorzAlign="Right" WordWrap="false" Font="Arial, 8pt" Trimming="EllipsisCharacter"/>
          <TextObject Name="Text7" Left="151.2" Width="56.7" Height="18.9" Text="[Table.DOCTOFOLIO]" Font="Arial, 8pt"/>
          <TextObject Name="Text35" Left="292.95" Width="56.7" Height="18.9" Text="[Table.PERSONACLAVE]" Font="Arial, 8pt"/>
          <TextObject Name="Text37" Left="349.65" Width="207.9" Height="18.9" Text="[Table.PERSONA]" Font="Arial, 8pt"/>
          <TextObject Name="Text13" Left="557.55" Width="66.15" Height="18.9" Text="[Table.SUBTOTAL]" Format="Currency" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator="," Format.CurrencySymbol="$" Format.PositivePattern="0" Format.NegativePattern="1" HorzAlign="Right" WordWrap="false" Font="Arial, 8pt" Trimming="EllipsisCharacter"/>
          <TextObject Name="Text15" Left="623.7" Width="56.7" Height="18.9" Text="[Table.IVA]" Format="Currency" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator="," Format.CurrencySymbol="$" Format.PositivePattern="0" Format.NegativePattern="1" HorzAlign="Right" WordWrap="false" Font="Arial, 8pt" Trimming="EllipsisCharacter"/>
          <TextObject Name="Text17" Left="727.65" Width="85.05" Height="18.9" Text="[Table.TOTAL]" Format="Currency" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator="," Format.CurrencySymbol="$" Format.PositivePattern="0" Format.NegativePattern="1" HorzAlign="Right" WordWrap="false" Font="Arial, 8pt" Trimming="EllipsisCharacter"/>
          <TextObject Name="Text65" Left="680.4" Width="47.25" Height="18.9" Text="[Table.IEPS]" Format="Currency" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator="," Format.CurrencySymbol="$" Format.PositivePattern="0" Format.NegativePattern="1" HorzAlign="Right" WordWrap="false" Font="Arial, 8pt" Trimming="EllipsisCharacter"/>
          <TextObject Name="Text5" Left="207.9" Width="85.05" Height="18.9" Text="[Table.SUCURSAL_CLAVE]" Font="Arial, 8pt"/>
          <TextObject Name="Text43" Left="888.3" Width="85.05" Height="18.9" Text="[Table.FECHAVENCE]" Format="Date" Format.Format="d" Font="Arial, 8pt"/>
          <Sort>
            <Sort Expression="[Table.SUCURSAL_CLAVE]"/>
            <Sort Expression="[Table.FECHA]"/>
            <Sort Expression="[Table.DOCTOFOLIO]"/>
          </Sort>
        </DataBand>
        <GroupFooterBand Name="GroupFooter2" Top="203.55" Width="980.53" Height="18.9">
          <TextObject Name="Text10" Left="708.75" Width="113.4" Height="18.9" Text="[SumaTotal]" Font="Arial, 9pt"/>
          <TextObject Name="Text95" Left="557.55" Width="151.2" Height="18.9" Text="TOTAL DEL MES:" Font="Arial, 9pt"/>
        </GroupFooterBand>
      </GroupHeaderBand>
      <GroupFooterBand Name="GroupFooter1" Top="226.45" Width="980.53"/>
    </GroupHeaderBand>
    <PageFooterBand Name="PageFooter1" Top="230.45" Width="980.53" Height="18.9">
      <TextObject Name="Text9" Left="888.3" Width="85.05" Height="18.9" Text="[PageN]" Font="Arial, 8pt, style=Bold"/>
    </PageFooterBand>
  </ReportPage>
  <DialogPage Name="Form1" Width="306" Height="242" AcceptButton="btnOk" CancelButton="btnCancel">
    <ButtonControl Name="btnOk" Left="54" Top="182" Anchor="Bottom, Right" Font="Tahoma, 8pt" TabIndex="0" Text="Aceptar" ClickEvent="btnOk_Click" DialogResult="OK"/>
    <ButtonControl Name="btnCancel" Left="181" Top="182" Anchor="Bottom, Right" Font="Tahoma, 8pt" TabIndex="1" Text="Cancelar" DialogResult="Cancel"/>
    <DateTimePickerControl Name="DateTimePicker1" Left="52" Top="32" Font="Tahoma, 8pt" TabIndex="2" ReportParameter="FECHAINI" FilterOperation="GreaterThanOrEqual" Value="09/01/2017 15:51:47"/>
    <LabelControl Name="Label1" Left="52" Top="16" Width="66" Height="13" Font="Tahoma, 8pt" TabIndex="3" Text="Fecha Inicial"/>
    <DateTimePickerControl Name="DateTimePicker2" Left="52" Top="80" Font="Tahoma, 8pt" TabIndex="4" ReportParameter="FECHAFIN" FilterOperation="LessThanOrEqual" Value="09/01/2017 15:51:49"/>
    <LabelControl Name="Label2" Left="52" Top="64" Width="61" Height="13" Font="Tahoma, 8pt" TabIndex="5" Text="Fecha Final"/>
    <CheckBoxControl Name="sucursalCheckBox" Left="204" Top="116" Width="55" Height="17" Font="Tahoma, 8pt" TabIndex="10" Text="Todas"/>
    <LabelControl Name="Label5" Left="52" Top="116" Width="47" Height="13" Font="Tahoma, 8pt" TabIndex="8" Text="Sucursal"/>
    <ComboBoxControl Name="sucursalComboBox" Left="52" Top="140" Width="205" Font="Tahoma, 8pt" TabIndex="12" DataColumn="Sucursal.SUCURSAL_DATOS" DataLoadedEvent="ComboBox1_DataLoaded" DropDownWidth="205" ItemHeight="13" SelectedIndexChangedEvent="ComboBox1_SelectedIndexChanged"/>
  </DialogPage>
</Report>
