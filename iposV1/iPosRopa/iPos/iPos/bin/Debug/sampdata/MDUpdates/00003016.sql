create or alter procedure RETIRO_CAJA_DELETE (
    DOCTOID D_PK)
returns (
    ERRORCODE D_ERRORCODE)
as
declare variable ESTATUSDOCTOID D_FK;
declare variable MONTOBILLETESID D_FK;
BEGIN
   SELECT ESTATUSDOCTOID, MONTOBILLETESID FROM DOCTO
   WHERE ID = :DOCTOID
   INTO :ESTATUSDOCTOID, :MONTOBILLETESID;

   IF (:ESTATUSDOCTOID <> 0) THEN
   BEGIN
      ERRORCODE = 1005;
      SUSPEND;
      EXIT;
   END

   IF(COALESCE(:MONTOBILLETESID,0) <> 0) THEN
   BEGIN
   
        DELETE FROM MONTOBILLETES WHERE ID =  :MONTOBILLETESID;
   END

   SELECT ERRORCODE FROM DOCTO_DELETE(:DOCTOID) INTO :ERRORCODE;
   IF(:ERRORCODE <> 0) THEN
   BEGIN
            
      SUSPEND;
      EXIT;
   END

   
   SUSPEND;
   
   WHEN ANY DO
   BEGIN
      ERRORCODE = 1006;
      SUSPEND;
   END
END