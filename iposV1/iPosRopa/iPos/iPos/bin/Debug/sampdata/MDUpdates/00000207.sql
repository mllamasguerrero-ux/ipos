CREATE OR ALTER PROCEDURE GET_PRECIO_CLASIFICACION (
   PRODUCTOID D_FK,
   PRECIO D_PRECIO,
   PRECIOLISTA D_PRECIO,
   PRECIOMAXPUBLICO D_PRECIO,
   COSTO D_COSTO
   
)
RETURNS (
   CLASIFICACION INTEGER,
   ERRORCODE D_ERRORCODE
)
AS
DECLARE VARIABLE PRECIOMINIMO D_PRECIO;
BEGIN
   ERRORCODE = 0;

   IF (:PRECIO >= PRECIOLISTA) THEN
   BEGIN
      CLASIFICACION = 1;
      SUSPEND;
      EXIT;
   END

   SELECT PRECIOMINIMO
   FROM GET_PRECIOMINIMO(:PRODUCTOID)
   INTO :PRECIOMINIMO;

   IF ((:PRECIO < :PRECIOLISTA) AND (:PRECIO >= :PRECIOMINIMO)) THEN
   BEGIN
      CLASIFICACION = 2;
      SUSPEND;
      EXIT;
   END

   IF ((:PRECIO < :PRECIOMINIMO) AND (:PRECIO >= :COSTO)) THEN
   BEGIN
      CLASIFICACION = 3;
      SUSPEND;
      EXIT;
   END

   IF ((:PRECIO < :COSTO) AND (:PRECIO >= 0.00)) THEN
   BEGIN
      CLASIFICACION = 4;
      SUSPEND;
      EXIT;
   END

   IF (:PRECIO <  0.00) THEN
   BEGIN
      CLASIFICACION = 5;
      SUSPEND;
      EXIT;
   END

   WHEN ANY DO
   BEGIN
      CLASIFICACION = -1;
      ERRORCODE = 3333;
      SUSPEND;
      EXIT;
   END
      
END;



