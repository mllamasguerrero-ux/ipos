create or alter procedure PAGOMOVIL_INSERT (
    TIPOPAGOID D_FK,
    ESTATUS D_FK,
    USUARIOID D_FK,
    PERSONAID D_FK,
    FORMAPAGOID D_FK,
    FECHA D_FECHA,
    CORTEID D_FK,
    IMPORTE D_IMPORTE,
    IMPORTERECIBIDO D_IMPORTE,
    IMPORTECAMBIO D_IMPORTE,
    BANCO D_FK,
    REFERENCIABANCARIA D_STDTEXT_LIGHT,
    NOTAS D_STDTEXT_MEDIUM,
    FECHAELABORACION D_FECHA,
    FECHARECEPCION D_FECHA,
    PAGOMOVILREFID D_FK,
    PERSONACLAVE D_CLAVE_NULL,
    APLICADO D_PRECIO,
    BANCOTEXT D_NOMBRE_NULL,
    TIPOTEXT D_CLAVE_NULL)
returns (
    PAGOMOVILID D_FK,
    ERRORCODE D_ERRORCODE)
as
declare variable ACTIVO D_BOOLCS;
BEGIN
  ACTIVO = 'N';
  SELECT COALESCE(ACTIVO,'N') FROM CORTE WHERE ID = :CORTEID INTO :ACTIVO;

  IF(:ACTIVO <> 'S') THEN
  BEGIN
      ERRORCODE = 1001;
      SUSPEND;
      EXIT;
  END

   INSERT INTO PAGOMOVIL
      (
    

TIPOPAGOID,

ESTATUS,

USUARIOID,

PERSONAID,

FORMAPAGOID,

FECHA,


CORTEID,

IMPORTE,

IMPORTERECIBIDO,

IMPORTECAMBIO,

BANCO,

REFERENCIABANCARIA,

NOTAS,

FECHAELABORACION,

FECHARECEPCION,

PAGOMOVILREFID,

PERSONACLAVE,

APLICADO ,

ENVIADOWS,

BANCOTEXT,

TIPOTEXT
         )

Values (


:TIPOPAGOID,

:ESTATUS,

:USUARIOID,

:PERSONAID,

:FORMAPAGOID,

:FECHA,

:CORTEID,

:IMPORTE,

:IMPORTERECIBIDO,

:IMPORTECAMBIO,

:BANCO,

:REFERENCIABANCARIA,

:NOTAS,

:FECHAELABORACION,

:FECHARECEPCION,

:PAGOMOVILREFID,

:PERSONACLAVE,

:APLICADO ,

'N' ,

:BANCOTEXT,

:TIPOTEXT
)

   RETURNING ID INTO :PAGOMOVILID;


   IF(:TIPOPAGOID = 6) THEN
   BEGIN
       UPDATE PAGOMOVIL SET ESTATUS = 2 WHERE ID = :PAGOMOVILID;
   END
   
   ERRORCODE = 0;
   SUSPEND;
   
   WHEN ANY DO
   BEGIN
      ERRORCODE = 1012;
      SUSPEND;
   END
END