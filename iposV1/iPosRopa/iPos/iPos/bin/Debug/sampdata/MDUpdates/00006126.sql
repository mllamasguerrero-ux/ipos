create or alter procedure POLIZALINEAV2_DET (
    FECHA D_FECHA)
returns (
    NUMERO integer,
    NUMCUENTA D_NOMBRE_NULL,
    LEYENDA D_STDTEXT_SHORT,
    TIPOENTRADA D_DIAS,
    MONTO D_PRECIO,
    NUMLINEA integer,
    DTL_ORDEN integer,
    HDR_CONCEPTO1 varchar(255),
    HDR_CONCEPTO2 varchar(255),
    DTL_NIV1_CONCEPTO varchar(255),
    DTL_NIV1_NOMBREID1 varchar(255),
    DTL_NIV1_ID1 bigint,
    DTL_NIV1_NOMBREID2 varchar(255),
    DTL_NIV1_ID2 bigint,
    DTL_NIV1_NOMBREFECHA1 varchar(255),
    DTL_NIV1_FECHA1 D_FECHA,
    DTL_NIV1_NOMBREREFERENCIA1 varchar(255),
    DTL_NIV1_REFERENCIA1 varchar(255),
    DTL_NIV1_NOMBREREFERENCIA2 varchar(255),
    DTL_NIV1_REFERENCIA2 varchar(255),
    DTL_NIV1_NOMBREREFERENCIA3 varchar(255),
    DTL_NIV1_REFERENCIA3 varchar(255),
    DTL_NIV1_NOMBREREFERENCIA4 varchar(255),
    DTL_NIV1_REFERENCIA4 varchar(255),
    DTL_NIV1_NOMBREREFERENCIA5 varchar(255),
    DTL_NIV1_REFERENCIA5 varchar(255),
    DTL_NIV1_NOMBREREFERENCIA6 varchar(255),
    DTL_NIV1_REFERENCIA6 varchar(255),
    DTL_NIV1_NOMBREREFERENCIA7 varchar(255),
    DTL_NIV1_REFERENCIA7 varchar(255),
    DTL_NIV1_NOMBREREFERENCIA8 varchar(255),
    DTL_NIV1_REFERENCIA8 varchar(255),
    DTL_NIV1_NOMBREREFERENCIA9 varchar(255),
    DTL_NIV1_REFERENCIA9 varchar(255),
    DTL_NIV1_NOMBREMONTO1 varchar(255),
    DTL_NIV1_MONTO1 D_PRECIO,
    DTL_NIV1_NOMBREMONTO2 varchar(255),
    DTL_NIV1_MONTO2 D_PRECIO,
    DTL_NIV1_NOMBREMONTO3 varchar(255),
    DTL_NIV1_MONTO3 D_PRECIO,
    DTL_NIV2_CONCEPTO varchar(255),
    DTL_NIV2_NOMBREID1 varchar(255),
    DTL_NIV2_ID1 bigint,
    DTL_NIV2_NOMBREID2 varchar(255),
    DTL_NIV2_ID2 bigint,
    DTL_NIV2_NOMBREFECHA1 varchar(255),
    DTL_NIV2_FECHA1 D_FECHA,
    DTL_NIV2_NOMBREREFERENCIA1 varchar(255),
    DTL_NIV2_REFERENCIA1 varchar(255),
    DTL_NIV2_NOMBREREFERENCIA2 varchar(255),
    DTL_NIV2_REFERENCIA2 varchar(255),
    DTL_NIV2_NOMBREREFERENCIA3 varchar(255),
    DTL_NIV2_REFERENCIA3 varchar(255),
    DTL_NIV2_NOMBREREFERENCIA4 varchar(255),
    DTL_NIV2_REFERENCIA4 varchar(255),
    DTL_NIV2_NOMBREREFERENCIA5 varchar(255),
    DTL_NIV2_REFERENCIA5 varchar(255),
    DTL_NIV2_NOMBREREFERENCIA6 varchar(255),
    DTL_NIV2_REFERENCIA6 varchar(255),
    DTL_NIV2_NOMBREREFERENCIA7 varchar(255),
    DTL_NIV2_REFERENCIA7 varchar(255),
    DTL_NIV2_NOMBREREFERENCIA8 varchar(255),
    DTL_NIV2_REFERENCIA8 varchar(255),
    DTL_NIV2_NOMBREREFERENCIA9 varchar(255),
    DTL_NIV2_REFERENCIA9 varchar(255),
    DTL_NIV2_NOMBREMONTO1 varchar(255),
    DTL_NIV2_MONTO1 D_PRECIO,
    DTL_NIV2_NOMBREMONTO2 varchar(255),
    DTL_NIV2_MONTO2 D_PRECIO,
    DTL_NIV2_NOMBREMONTO3 varchar(255),
    DTL_NIV2_MONTO3 D_PRECIO)
as
BEGIN

    FOR
        SELECT  
                NUMERO ,
                NUMCUENTA ,
                LEYENDA ,
                TIPOENTRADA ,
                MONTO,

               NUMLINEA ,
               DTL_ORDEN ,
               HDR_CONCEPTO1 ,
               HDR_CONCEPTO2 ,
               DTL_NIV1_CONCEPTO ,
               DTL_NIV1_NOMBREID1 ,
               DTL_NIV1_ID1 ,
               DTL_NIV1_NOMBREID2 ,
               DTL_NIV1_ID2 ,
               DTL_NIV1_NOMBREFECHA1 ,
               DTL_NIV1_FECHA1 ,
               DTL_NIV1_NOMBREREFERENCIA1 ,
               DTL_NIV1_REFERENCIA1 ,
               DTL_NIV1_NOMBREREFERENCIA2 ,
               DTL_NIV1_REFERENCIA2 ,
               DTL_NIV1_NOMBREREFERENCIA3 ,
               DTL_NIV1_REFERENCIA3 ,
               DTL_NIV1_NOMBREREFERENCIA4 ,
               DTL_NIV1_REFERENCIA4 ,
               DTL_NIV1_NOMBREREFERENCIA5 ,
               DTL_NIV1_REFERENCIA5 ,
               DTL_NIV1_NOMBREREFERENCIA6 ,
               DTL_NIV1_REFERENCIA6 ,
               DTL_NIV1_NOMBREREFERENCIA7 ,
               DTL_NIV1_REFERENCIA7 ,
               DTL_NIV1_NOMBREREFERENCIA8 ,
               DTL_NIV1_REFERENCIA8 ,
               DTL_NIV1_NOMBREREFERENCIA9 ,
               DTL_NIV1_REFERENCIA9 ,
               DTL_NIV1_NOMBREMONTO1 ,
               DTL_NIV1_MONTO1 ,
               DTL_NIV1_NOMBREMONTO2 ,
               DTL_NIV1_MONTO2  ,
               DTL_NIV1_NOMBREMONTO3 ,
               DTL_NIV1_MONTO3 ,
               DTL_NIV2_CONCEPTO ,
               DTL_NIV2_NOMBREID1 ,
               DTL_NIV2_ID1 ,
               DTL_NIV2_NOMBREID2 ,
               DTL_NIV2_ID2 ,
               DTL_NIV2_NOMBREFECHA1,
               DTL_NIV2_FECHA1 ,
               DTL_NIV2_NOMBREREFERENCIA1 ,
               DTL_NIV2_REFERENCIA1 ,
               DTL_NIV2_NOMBREREFERENCIA2 ,
               DTL_NIV2_REFERENCIA2 ,
               DTL_NIV2_NOMBREREFERENCIA3 ,
               DTL_NIV2_REFERENCIA3 ,
               DTL_NIV2_NOMBREREFERENCIA4 ,
               DTL_NIV2_REFERENCIA4 ,
               DTL_NIV2_NOMBREREFERENCIA5 ,
               DTL_NIV2_REFERENCIA5 ,
               DTL_NIV2_NOMBREREFERENCIA6 ,
               DTL_NIV2_REFERENCIA6 ,
               DTL_NIV2_NOMBREREFERENCIA7 ,
               DTL_NIV2_REFERENCIA7 ,
               DTL_NIV2_NOMBREREFERENCIA8 ,
               DTL_NIV2_REFERENCIA8 ,
               DTL_NIV2_NOMBREREFERENCIA9 ,
               DTL_NIV2_REFERENCIA9 ,
               DTL_NIV2_NOMBREMONTO1 ,
               DTL_NIV2_MONTO1 ,
               DTL_NIV2_NOMBREMONTO2 ,
               DTL_NIV2_MONTO2   ,
               DTL_NIV2_NOMBREMONTO3 ,
               DTL_NIV2_MONTO3
               FROM
            POLIZALINEAV2_DET_OPC(:FECHA,'N')
        INTO 
                    :NUMERO ,
                    :NUMCUENTA ,
                    :LEYENDA ,
                    :TIPOENTRADA ,
                    :MONTO,
                    :NUMLINEA ,
                    :DTL_ORDEN ,
                    :HDR_CONCEPTO1 ,
                    :HDR_CONCEPTO2 ,
                    :DTL_NIV1_CONCEPTO ,
                    :DTL_NIV1_NOMBREID1 ,
                    :DTL_NIV1_ID1 ,
                    :DTL_NIV1_NOMBREID2 ,
                    :DTL_NIV1_ID2 ,
                    :DTL_NIV1_NOMBREFECHA1 ,
                    :DTL_NIV1_FECHA1 ,
                    :DTL_NIV1_NOMBREREFERENCIA1 ,
                    :DTL_NIV1_REFERENCIA1 ,
                    :DTL_NIV1_NOMBREREFERENCIA2 ,
                    :DTL_NIV1_REFERENCIA2 ,
                    :DTL_NIV1_NOMBREREFERENCIA3 ,
                    :DTL_NIV1_REFERENCIA3 ,
                    :DTL_NIV1_NOMBREREFERENCIA4 ,
                    :DTL_NIV1_REFERENCIA4 ,
                    :DTL_NIV1_NOMBREREFERENCIA5 ,
                    :DTL_NIV1_REFERENCIA5 ,
                    :DTL_NIV1_NOMBREREFERENCIA6 ,
                    :DTL_NIV1_REFERENCIA6 ,
                    :DTL_NIV1_NOMBREREFERENCIA7 ,
                    :DTL_NIV1_REFERENCIA7 ,
                    :DTL_NIV1_NOMBREREFERENCIA8 ,
                    :DTL_NIV1_REFERENCIA8 ,
                    :DTL_NIV1_NOMBREREFERENCIA9 ,
                    :DTL_NIV1_REFERENCIA9 ,
                    :DTL_NIV1_NOMBREMONTO1 ,
                    :DTL_NIV1_MONTO1 ,
                    :DTL_NIV1_NOMBREMONTO2 ,
                    :DTL_NIV1_MONTO2  ,
                    :DTL_NIV1_NOMBREMONTO3 ,
                    :DTL_NIV1_MONTO3 ,
                    :DTL_NIV2_CONCEPTO ,
                    :DTL_NIV2_NOMBREID1 ,
                    :DTL_NIV2_ID1 ,
                    :DTL_NIV2_NOMBREID2 ,
                    :DTL_NIV2_ID2 ,
                    :DTL_NIV2_NOMBREFECHA1,
                    :DTL_NIV2_FECHA1 ,
                    :DTL_NIV2_NOMBREREFERENCIA1 ,
                    :DTL_NIV2_REFERENCIA1 ,
                    :DTL_NIV2_NOMBREREFERENCIA2 ,
                    :DTL_NIV2_REFERENCIA2 ,
                    :DTL_NIV2_NOMBREREFERENCIA3 ,
                    :DTL_NIV2_REFERENCIA3 ,
                    :DTL_NIV2_NOMBREREFERENCIA4 ,
                    :DTL_NIV2_REFERENCIA4 ,
                    :DTL_NIV2_NOMBREREFERENCIA5 ,
                    :DTL_NIV2_REFERENCIA5 ,
                    :DTL_NIV2_NOMBREREFERENCIA6 ,
                    :DTL_NIV2_REFERENCIA6 ,
                    :DTL_NIV2_NOMBREREFERENCIA7 ,
                    :DTL_NIV2_REFERENCIA7 ,
                    :DTL_NIV2_NOMBREREFERENCIA8 ,
                    :DTL_NIV2_REFERENCIA8 ,
                    :DTL_NIV2_NOMBREREFERENCIA9 ,
                    :DTL_NIV2_REFERENCIA9 ,
                    :DTL_NIV2_NOMBREMONTO1 ,
                    :DTL_NIV2_MONTO1 ,
                    :DTL_NIV2_NOMBREMONTO2 ,
                    :DTL_NIV2_MONTO2   ,
                    :DTL_NIV2_NOMBREMONTO3 ,
                    :DTL_NIV2_MONTO3
        DO
        BEGIN
            SUSPEND;
        END


    END