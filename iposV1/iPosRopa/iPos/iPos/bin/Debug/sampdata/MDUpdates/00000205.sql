CREATE OR ALTER PROCEDURE GET_PRECIOMINIMO (
   PRODUCTOID D_FK
)
RETURNS (
   PRECIOMINIMO INTEGER
)
AS
DECLARE VARIABLE LPMNUM INTEGER;
BEGIN
	-- Tomar cual es el campo precio minimo de la tabla de parametros IPOSTYPE
   SELECT LISTAPRECIOMINIMO
   FROM IPOSTYPE I
   WHERE I.ID = (
      SELECT IPOS_TYPE FROM PARAMETRO
   )
   INTO :LPMNUM;

	-- Elegir el precio minimo de los campos PRECIO(x)
   IF (:LPMNUM = 1) THEN
      SELECT PRECIO1 FROM PRODUCTO WHERE ID = :PRODUCTOID INTO :PRECIOMINIMO;
   ELSE IF (:LPMNUM = 2) THEN
      SELECT PRECIO2 FROM PRODUCTO WHERE ID = :PRODUCTOID INTO :PRECIOMINIMO;
   ELSE IF (:LPMNUM = 3) THEN
      SELECT PRECIO3 FROM PRODUCTO WHERE ID = :PRODUCTOID INTO :PRECIOMINIMO;
   ELSE IF (:LPMNUM = 4) THEN
      SELECT PRECIO4 FROM PRODUCTO WHERE ID = :PRODUCTOID INTO :PRECIOMINIMO;
   ELSE IF (:LPMNUM = 5) THEN
      SELECT PRECIO5 FROM PRODUCTO WHERE ID = :PRODUCTOID INTO :PRECIOMINIMO;
   ELSE
      SELECT PRECIO1 FROM PRODUCTO WHERE ID = :PRODUCTOID INTO :PRECIOMINIMO;

   SUSPEND;
END;

