CREATE OR ALTER TRIGGER DOCTO_BU_2 FOR DOCTO
ACTIVE BEFORE UPDATE POSITION 2
AS
    DECLARE VARIABLE SERIE D_DOCTOSERIE;
    DECLARE VARIABLE FOLIO D_DOCTOFOLIO; 
    declare variable ULTIMAFECHA D_FECHA ;
BEGIN
   IF ((OLD.ESTATUSDOCTOID = 0) AND (NEW.ESTATUSDOCTOID = 1)) THEN
   BEGIN
   
     SELECT FIRST 1 FECHAULTIMA FROM PARAMETRO INTO :ULTIMAFECHA;

   
     IF(OLD.TIPODOCTOID NOT in (14) and  :ULTIMAFECHA < NEW.FECHA) THEN
     BEGIN
      UPDATE PARAMETRO
      SET FECHAULTIMA = NEW.FECHA;
     END
   END
END