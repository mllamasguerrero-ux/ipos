create or alter procedure INVKIT_CAMBIARDEGLOSADO (
    DOCTOID D_FK,
    KITDESGLOSADO D_BOOLCN)
returns (
    ERRORCODE D_ERRORCODE)
as
BEGIN



   UPDATE DOCTO SET KITDESGLOSADO = :KITDESGLOSADO
   WHERE ID = :DOCTOID;

   IF(COALESCE(:KITDESGLOSADO,'N') = 'S') THEN
   BEGIN
    DELETE FROM MOVTO WHERE MOVTO.DOCTOID = :DOCTOID AND PRODUCTOID IN
     (SELECT ID FROM PRODUCTO WHERE ESKIT = 'S');
   END

   ERRORCODE = 0;
   SUSPEND;
   
   WHEN ANY DO
   BEGIN
     ERRORCODE = 1077;
     SUSPEND;
   END
END