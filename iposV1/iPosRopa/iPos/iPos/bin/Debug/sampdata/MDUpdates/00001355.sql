CREATE OR ALTER VIEW PRODUCTOSEXTENDED(
    ID,
    PRODUCTO,
    CLAVE,
    DESCRIPCION1,
    DESCRIPCION2,
    PRECIO1,
    LIMITEPRECIO2,
    PRECIO2,
    EAN,
    EXISTENCIA,
    PROVEEDOR,
    INVENTARIABLE,
    NEGATIVOS,
    TASAIVA,
    PRECIO_MAS_IVA,
    DESCONTINUADO,
    TEXTO1,
    TEXTO2,
    TEXTO3,
    TEXTO4,
    TEXTO5,
    TEXTO6,
    NUMERO1,
    NUMERO2,
    NUMERO3,
    NUMERO4,
    FECHA1,
    FECHA2,
    PRODUCTOPADRE,
    ACTIVO,
    TASAIMPUESTO,
    PRECIO_MAS_IMPUESTO,
    TASAIEPS,
    PRECIO_MAS_IEPS)
AS
SELECT P.ID,
    COALESCE(TRIM(P.CLAVE), '')
    ||COALESCE(TRIM(P.EAN), '')
    ||COALESCE(TRIM(P.NOMBRE), '')
    ||COALESCE(TRIM(P.DESCRIPCION), '')
    ||COALESCE(TRIM(P.DESCRIPCION1),'')
    ||COALESCE(TRIM(P.DESCRIPCION2), '') producto,
     P.CLAVE, P.DESCRIPCION1, P.DESCRIPCION2, P.PRECIO1, P.LIMITEPRECIO2, P.PRECIO2 , P.EAN , P.EXISTENCIA, PR.NOMBRE as PROVEEDOR , P.INVENTARIABLE, P.NEGATIVOS
     , P.tasaiva TASAIVA, (P.precio1  * (1 + (P.TASAIEPS/100))* (1 + (P.TASAIVA/100))) AS PRECIO_MAS_IVA
     , COALESCE(M.descontinuado,'N') AS DESCONTINUADO ,
        c.TEXTO1, c.TEXTO2, c.TEXTO3, c.TEXTO4, c.TEXTO5, c.TEXTO6, c.NUMERO1, c.NUMERO2, c.NUMERO3, c.NUMERO4, c.FECHA1, c.FECHA2
      , P.PRODUCTOPADRE , P.ACTIVO
      , P.tasaimpuesto TASAIMPUESTO, (P.precio1  * (1 + (P.TASAIEPS/100)) * (1 + (P.TASAIVA/100))) AS PRECIO_MAS_IMPUESTO
      , P.tasaieps TASAIEPS, (P.precio1 * (1 + (P.TASAIEPS/100))) AS PRECIO_MAS_IEPS


  FROM PRODUCTO  P
   LEFT join persona PR
      on PR.id = P.proveedor1id
      LEFT JOIN MARCA M ON M.id = P.marcaid
       LEFT OUTER JOIN
                         PRODUCTOCARACTERISTICAS c ON p.ID = c.PRODUCTOID


  ORDER BY CLAVE
;