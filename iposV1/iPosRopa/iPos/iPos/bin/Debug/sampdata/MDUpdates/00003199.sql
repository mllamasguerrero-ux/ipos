create or alter procedure ASIGNARPAGO_FACTELECTRONICA (
    DOCTOID D_FK,
    FORMAPAGOID D_FK)
returns (
    ERRORCODE D_ERRORCODE)
as
declare variable DOCTOPAGOID D_FK;
BEGIN

   DOCTOPAGOID = null;
   SELECT FIRST 1 ID FROM DOCTOPAGO WHERE (DOCTOID = :DOCTOID or DOCTOSALIDAID = :DOCTOID)
   AND FORMAPAGOID = :FORMAPAGOID INTO :DOCTOPAGOID;

   IF( :DOCTOPAGOID IS null) THEN
   BEGIN   
      ERRORCODE = 1012;
      SUSPEND;
      EXIT;
   END

   UPDATE DOCTO SET DOCTOPAGOSAT = :DOCTOPAGOID, ESFACTURAELECTRONICA = 'S' WHERE ID = :DOCTOID;
   
   ERRORCODE = 0;
   SUSPEND;
   
   WHEN ANY DO
   BEGIN
      ERRORCODE = 1012;
      SUSPEND;
   END
END