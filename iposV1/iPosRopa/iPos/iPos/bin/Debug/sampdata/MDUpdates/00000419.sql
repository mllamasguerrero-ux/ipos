CREATE OR ALTER VIEW PRODUCTLOCATIONS_GROUPED(
    PRODUCTOID,
    ANAQUEL,
    LOCALIDAD,
    ANAQUEL_LOCALIDAD)
AS
SELECT CAST(S.PRODUCTOID AS D_FK) PRODUCTOID,CAST(S.ANAQUEL AS d_locacion), CAST(MIN(P.LOCALIDAD) AS D_LOCACION) LOCALIDAD ,
         ( CAST(S.ANAQUEL AS d_locacion) || ' - ' || CAST(MIN(P.LOCALIDAD) AS d_locacion ) )  ANAQUEL_LOCALIDAD
 FROM
  (SELECT PRODUCTOID,MIN(ANAQUEL) ANAQUEL
  FROM productolocations 
  GROUP BY PRODUCTOID)  S
  INNER JOIN PRODUCTOLOCATIONS p on s.productoid = p.productoid and s.anaquel = p.anaquel
  group by s.productoid, s.anaquel
;