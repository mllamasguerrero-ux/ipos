create or alter procedure DOCTO_ACTUALIZAR_CLIENTE (
    DOCTOID type of D_FK,
    PERSONAID type of D_FK)
returns (
    ERRORCODE type of D_ERRORCODE)
as
declare variable MONEDAID D_FK;
declare variable TIPOCAMBIO D_TIPOCAMBIO;
BEGIN

  ERRORCODE = 0;

  SELECT COALESCE(MONEDAID,1) FROM PERSONA WHERE ID = :PERSONAID INTO :MONEDAID;
  SELECT COALESCE(TIPOCAMBIO,1) FROM MONEDA WHERE ID = :MONEDAID INTO :TIPOCAMBIO;

   UPDATE DOCTO
   SET PERSONAID = :PERSONAID ,
   MONEDAID = :MONEDAID,
   TIPOCAMBIO = :TIPOCAMBIO
   WHERE ID = :DOCTOID;


      SELECT ERRORCODE
      FROM DOCTO_RECALCULAR_DETALLES (
         :DOCTOID
      ) INTO :ERRORCODE;

      SUSPEND;

    WHEN ANY DO
   BEGIN
      ERRORCODE = 1016;
      SUSPEND;
   END

END