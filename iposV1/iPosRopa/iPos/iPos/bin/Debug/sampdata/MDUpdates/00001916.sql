CREATE OR ALTER TRIGGER DOCTOPAGOMOVIL_AU0 FOR DOCTOPAGOMOVIL
ACTIVE AFTER UPDATE POSITION 0
AS
declare variable DELTA D_PRECIO;
begin
  /* Trigger text */
  IF(NEW.estatus = 1) THEN
  BEGIN
    IF(NEW.tipopagoid = 5) THEN
    BEGIN
         DELTA = NEW.IMPORTE - OLD.IMPORTE;
        UPDATE PAGOMOVIL SET APLICADO = APLICADO + :DELTA WHERE ID = NEW.pagomovilid;
        UPDATE COBRANZAMOVIL SET SALDOMOVIL = SALDOMOVIL - :DELTA, ABONOSMOVIL = ABONOSMOVIL + :DELTA WHERE ID = NEW.cobranzaid;

    END
  END
end