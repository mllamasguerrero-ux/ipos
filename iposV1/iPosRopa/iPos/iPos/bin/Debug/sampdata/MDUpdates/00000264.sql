CREATE OR ALTER VIEW INVENTARIOCOSTEADO(
    ID,
    CLAVE,
    NOMBRE,
    LINEA,
    PROVEEDOR,
    ALMACEN,
    CANTIDAD,
    COSTOPROMEDIO,
    COSTOULTIMO,
    COSTOREPOSICION,
    COSTOPROMEDIOTOTAL,
    COSTOULTIMOTOTAL,
    COSTOREPOSICIONTOTAL)
AS
SELECT
      P.ID,
      P.CLAVE,
      P.NOMBRE,
      L.CLAVE AS LINEA,
      PR.CLAVE AS PROVEEDOR,
      A.CLAVE AS ALMACEN,
      I.CANTIDAD,
      P.COSTOPROMEDIO,
      P.COSTOULTIMO,
      P.COSTOREPOSICION,
      P.COSTOPROMEDIO * I.CANTIDAD AS COSTOPROMEDIOTOTAL,
      P.COSTOULTIMO * I.CANTIDAD AS COSTOULTIMOTOTAL,
      P.COSTOREPOSICION * I.CANTIDAD AS COSTOREPOSICIONTOTAL
   FROM INVENTARIO I
      LEFT JOIN PRODUCTO P
         ON P.ID = I.PRODUCTOID
      LEFT JOIN LINEA L
         ON L.ID = P.LINEAID
      LEFT JOIN PERSONA PR
         ON PR.ID = P.PROVEEDOR1ID
      LEFT JOIN ALMACEN A
         ON A.ID = I.ALMACENID
;