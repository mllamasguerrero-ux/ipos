create or alter procedure BANCOMERPARAM_GUARDAR (
    BANCOMERPARAMID_ORIG D_FK,
    CREADOPOR_USERID D_FK,
    MODIFICADOPOR_USERID D_FK,
    AID D_NOMBRE_NULL,
    AMEX smallint,
    BANCOMER D_BOOLCN_NULL,
    BITCAMPANAS D_BOOLCN_NULL,
    CAMPANAAUTORIZACION D_NOMBRE_NULL,
    CAMPANAREFERENCIA D_NOMBRE_NULL,
    CAMPANAREFERENCIANUM D_FK,
    CARDREQUEST D_NOMBRE_NULL,
    CARDTIPO integer,
    PROMOCIONES D_BOOLCN_NULL,
    CLIENTE_CMP_COMERCIO D_NOMBRE_NULL,
    CLIENTE_TDC_STOCK D_NOMBRE_NULL,
    CLSREQUESTID D_FK,
    CLSRESPONSEID D_FK,
    CODIGO_BENEFICIO1 D_NOMBRE_NULL,
    CODIGO_BENEFICIO2 D_NOMBRE_NULL,
    CODIGO_BENEFICIO3 D_NOMBRE_NULL,
    CODIGO_BENEFICIO4 D_NOMBRE_NULL,
    CODIGO_BENEFICIO5 D_NOMBRE_NULL,
    CODIGO_BENEFICIO6 D_NOMBRE_NULL,
    CODIGO_BENEFICIO7 D_NOMBRE_NULL,
    COMERCIO_CMP_COMERCIO D_NOMBRE_NULL,
    COMERCIO_TDC_STOCK D_NOMBRE_NULL,
    COMISION1 D_NOMBRE_NULL,
    COMISION2 D_NOMBRE_NULL,
    COMISION3 D_NOMBRE_NULL,
    COMISION4 D_NOMBRE_NULL,
    COMISION5 D_NOMBRE_NULL,
    COMISION6 D_NOMBRE_NULL,
    COMISION7 D_NOMBRE_NULL,
    CREDITODEBITO D_NOMBRE_NULL,
    CRIPTOGRAMA D_NOMBRE_NULL,
    ECOUPNUMBER D_NOMBRE_NULL,
    FACTOREXP D_NOMBRE_NULL,
    FIRMAAUTOGRAFA D_BOOLCN_NULL,
    FIRMAELECTRONICA D_BOOLCN_NULL,
    FIRMAQPS D_BOOLCN_NULL,
    GUIA_CIE D_NOMBRE_NULL,
    IDTOKEN12 D_BOOLCN_NULL,
    IDTOKEN13 D_BOOLCN_NULL,
    IDTOKEN16 D_BOOLCN_NULL,
    IDTOKENR7 D_BOOLCN_NULL,
    IDTOKENR8 D_BOOLCN_NULL,
    IMPORTE_BENEFICIO D_NOMBRE_NULL,
    IMPORTE_UDIS D_NOMBRE_NULL,
    INDICADOR_CAMBIO_PLAZO D_NOMBRE_NULL,
    INDICADOR_DE_AVISO D_NOMBRE_NULL,
    INDICAODR_DE_BENEFICIO D_NOMBRE_NULL,
    ISFOLIO D_NOMBRE_NULL,
    ISOFFLINE D_BOOLCN_NULL,
    LEYENDA D_NOMBRE_NULL,
    MACADDALTERNATIVA D_NOMBRE_NULL,
    MENSAJE_BASE_CHEQUE D_NOMBRE_NULL,
    MENSAJE_BASE_CONTINUOS D_NOMBRE_NULL,
    MENSAJE_CLIENTE D_NOMBRE_NULL,
    MENSAJE_CLIENTE_EMISRO D_NOMBRE_NULL,
    MENSAJE_COMERCIO D_NOMBRE_NULL,
    MODOINGRESO D_NOMBRE_NULL,
    MONTO_BENEFICIO_MULTIPLE1 D_NOMBRE_NULL,
    MONTO_BENEFICIO_SIMPLE1 D_NOMBRE_NULL,
    MONTO_CHEQUE_ACTUAL D_NOMBRE_NULL,
    MONTO_CHEQUE_ANTERIOR D_NOMBRE_NULL,
    MONTO_CHEQUE_REDIMIDOS D_NOMBRE_NULL,
    MONTO_CONTINUOS_ACTUAL D_NOMBRE_NULL,
    MONTO_CONTINUOS_ANTERIOR D_NOMBRE_NULL,
    MONTO_CONTINUOS_REDIMIDOS D_NOMBRE_NULL,
    MONTO_MULTIPLE2 D_NOMBRE_NULL,
    MONTO_MULTIPLE3 D_NOMBRE_NULL,
    MONTO_MULTIPLE4 D_NOMBRE_NULL,
    MONTO_MULTIPLE5 D_NOMBRE_NULL,
    MONTO_MULTIPLE6 D_NOMBRE_NULL,
    MONTO_MULTIPLE7 D_NOMBRE_NULL,
    MONTO_SIMPLE2 D_NOMBRE_NULL,
    MONTO_SIMPLE3 D_NOMBRE_NULL,
    MONTO_SIMPLE4 D_NOMBRE_NULL,
    MONTO_SIMPLE5 D_NOMBRE_NULL,
    MONTO_SIMPLE6 D_NOMBRE_NULL,
    MONTO_SIMPLE7 D_NOMBRE_NULL,
    NOAUTORIZACION D_NOMBRE_NULL,
    NOMBREAPLICACION D_NOMBRE_NULL,
    NOMBRECLIENTE D_NOMBRE_NULL,
    NUMERO_DE_BENEFICIOS D_NOMBRE_NULL,
    NUMEROTARJETA D_NOMBRE_NULL,
    NUMTARJETAII D_NOMBRE_NULL,
    PAGOSMULTIPAGOSID D_FK,
    PESOSREDIMIDOS D_NOMBRE_NULL,
    PESOSSALDOANTERIOR D_NOMBRE_NULL,
    PESOSSALDODISPONIBLE D_NOMBRE_NULL,
    PESOSSALDODISPONINLEEXP D_NOMBRE_NULL,
    PESOSSALDOREDIMIDOSEXP D_NOMBRE_NULL,
    PINPAD_USO D_BOOLCN_NULL,
    POOLADJUSTTYPE D_NOMBRE_NULL,
    POOLID D_NOMBRE_NULL,
    POOLNUMBER D_NOMBRE_NULL,
    POOLUNITLABEL D_NOMBRE_NULL,
    PUNTOSID D_FK,
    PUNTOSREDIMIDOS D_NOMBRE_NULL,
    PUNTOSSALDOANTERIOR D_NOMBRE_NULL,
    PUNTOSSALDODISPONIBLE D_NOMBRE_NULL,
    PUNTOSSALDODISPONIBLEEXP D_NOMBRE_NULL,
    PUNTOSSALDOREDIMIDOSEXP D_NOMBRE_NULL,
    R8_CODIGO_LEYENDA D_NOMBRE_NULL,
    R8_LEYENDA D_NOMBRE_NULL,
    RAZON_SOCIAL D_NOMBRE_NULL,
    REFERENCIA_RESPUESTA D_NOMBRE_NULL,
    REFERENCIAAFIN D_NOMBRE_NULL,
    REQUEST D_STDTEXT_LARGE,
    RESPDLL integer,
    RESPONSE D_STDTEXT_LARGE,
    SEGMENTNUMBER D_NOMBRE_NULL,
    TBINES D_NOMBRE_NULL,
    TIPO_BENEFICIO1 D_NOMBRE_NULL,
    TIPO_BENEFICIO2 D_NOMBRE_NULL,
    TIPO_BENEFICIO3 D_NOMBRE_NULL,
    TIPO_BENEFICIO4 D_NOMBRE_NULL,
    TIPO_BENEFICIO5 D_NOMBRE_NULL,
    TIPO_BENEFICIO6 D_NOMBRE_NULL,
    TIPO_BENEFICIO7 D_NOMBRE_NULL,
    TIPO_RESPUESTA1 D_NOMBRE_NULL,
    TIPO_RESPUESTA2 D_NOMBRE_NULL,
    TIPO_RESPUESTA3 D_NOMBRE_NULL,
    TIPO_RESPUESTA4 D_NOMBRE_NULL,
    TIPO_RESPUESTA5 D_NOMBRE_NULL,
    TIPO_RESPUESTA6 D_NOMBRE_NULL,
    TIPO_RESPUESTA7 D_NOMBRE_NULL,
    TIPOPOS D_NOMBRE_NULL,
    TNXCONPUNTOS D_BOOLCN_NULL,
    TOPERADOR D_NOMBRE_NULL,
    VALTIPOCARD D_NOMBRE_NULL,
    VIGENCIAPROMOCIONESEXP D_NOMBRE_NULL,
    DOCTOID D_FK,
    DOCTOPAGOID D_FK,
    TIPOTRANSACCION D_STDTEXT_LIGHT,
    ESTADOTRANSACCIONID D_FK,
    REFID D_FK,
    REQ_ISSINTJROPERADOR D_BOOLCN_NULL,
    REQ_NOMAUTORIZACION D_NOMBRE_NULL,
    REQ_NOMBRE D_NOMBRE_NULL,
    REQ_PAN D_NOMBRE_NULL,
    REQ_TOPERADOR D_NOMBRE_NULL,
    REQ_CODTRANSACTION D_NOMBRE_NULL,
    REQ_TERMINAL D_NOMBRE_NULL,
    REQ_SESSION D_NOMBRE_NULL,
    REQ_SECUENCIA D_NOMBRE_NULL,
    REQ_IMPORTE D_NOMBRE_NULL,
    REQ_PROPINA D_NOMBRE_NULL,
    REQ_FOLIO D_NOMBRE_NULL,
    REQ_CAPEMV D_NOMBRE_NULL,
    REQ_TIPOLECTOR D_NOMBRE_NULL,
    REQ_CAPCVV2 D_NOMBRE_NULL,
    REQ_MESESFIN D_NOMBRE_NULL,
    REQ_PARCIALIZACION D_NOMBRE_NULL,
    REQ_PROMOCIONES D_NOMBRE_NULL,
    REQ_TIPOMONEDA D_NOMBRE_NULL,
    REQ_NOAUTORIZACION D_NOMBRE_NULL,
    REQ_MODOINGRESO D_NOMBRE_NULL,
    REQ_CVV2 D_NOMBRE_NULL,
    REQ_TRACK2 D_NOMBRE_NULL,
    REQ_NOSECUENCIA D_NOMBRE_NULL,
    REQ_IMPORTECASH D_NOMBRE_NULL,
    REQ_FECHAHORACOMERCIO D_NOMBRE_NULL,
    REQ_REFERENCIACOMERCIO D_NOMBRE_NULL,
    REQ_OTROIMPORTE D_NOMBRE_NULL,
    REQ_CLAVEOPERADOR D_NOMBRE_NULL,
    REQ_AFILIACION D_NOMBRE_NULL,
    REQ_NUMEROCUARTO D_NOMBRE_NULL,
    REQ_REFERENCIAFINANCIERA D_NOMBRE_NULL,
    REQ_CODIGOCONDCHIP D_NOMBRE_NULL,
    REQ_LONGEMVFULL D_NOMBRE_NULL,
    REQ_DATOSEMVFULL D_NOMBRE_NULL,
    REQ_LONGLEALTAD D_NOMBRE_NULL,
    REQ_DATOSLEALTAD D_NOMBRE_NULL,
    REQ_LONGMULTIPAGOS D_NOMBRE_NULL,
    REQ_DATOSMULTIPAGOS D_NOMBRE_NULL,
    REQ_LONGDATOSCIFRADOS D_NOMBRE_NULL,
    REQ_DATOSCIFRADOS D_NOMBRE_NULL,
    REQ_LONGCAMPANA D_NOMBRE_NULL,
    REQ_DATOSCAMPANA D_NOMBRE_NULL,
    REQ_CONVENIOCIE D_NOMBRE_NULL,
    REQ_VERSION D_NOMBRE_NULL,
    RESP_CODTRANSACTION D_NOMBRE_NULL,
    RESP_TERMINAL D_NOMBRE_NULL,
    RESP_SESSION D_NOMBRE_NULL,
    RESP_SECUENCIA D_NOMBRE_NULL,
    RESP_CODIGORESPUESTA D_NOMBRE_NULL,
    RESP_NOAUTORIZACION D_NOMBRE_NULL,
    RESP_AFILIACION D_NOMBRE_NULL,
    RESP_FILLER1 D_NOMBRE_NULL,
    RESP_IMPORTE D_NOMBRE_NULL,
    RESP_FILLER2 D_NOMBRE_NULL,
    RESP_TARJETA D_NOMBRE_NULL,
    RESP_CVEOPERADOR D_NOMBRE_NULL,
    RESP_FILLER3 D_NOMBRE_NULL,
    RESP_FOLIO D_NOMBRE_NULL,
    RESP_LONGLEYENDA D_NOMBRE_NULL,
    RESP_LEYENDA D_NOMBRE_NULL,
    RESP_REFERENCIAFINAN D_NOMBRE_NULL,
    RESP_LONGEMV D_NOMBRE_NULL,
    RESP_DATOSEMV D_NOMBRE_NULL,
    RESP_LONGLEALTAD D_NOMBRE_NULL,
    RESP_DATOSLEALTAD D_NOMBRE_NULL,
    RESP_REGISTRO1 D_NOMBRE_NULL,
    RESP_REGISTRO2 D_NOMBRE_NULL,
    RESP_REGISTRO3 D_NOMBRE_NULL,
    RESP_REGISTRO4 D_NOMBRE_NULL,
    RESP_REGISTRO5 D_NOMBRE_NULL,
    RESP_LONGMULTIPAGOS D_NOMBRE_NULL,
    RESP_MULTIPAGOS D_NOMBRE_NULL,
    RESP_LONGDATOSCIFRADOS D_NOMBRE_NULL,
    RESP_DATOSCIFRADOS D_NOMBRE_NULL,
    RESP_LONGCAMPANA D_NOMBRE_NULL,
    RESP_DATOSCAMPANA D_NOMBRE_NULL,
    RESP_IDENCABEZADO D_FK,
    PTS_CARDREQUEST D_NOMBRE_NULL,
    PTS_ECOUPNUMBER D_NOMBRE_NULL,
    PTS_FACTOREXP D_NOMBRE_NULL,
    PTS_PESOSREDIMIDOS D_NOMBRE_NULL,
    PTS_PESOSSALDOANTERIOR D_NOMBRE_NULL,
    PTS_PESOSSALDODISPONIBLE D_NOMBRE_NULL,
    PTS_PESOSSALDODISPONINLEEXP D_NOMBRE_NULL,
    PTS_PESOSSALDOREDIMIDOSEXP D_NOMBRE_NULL,
    PTS_POOLADJUSTTYPE D_NOMBRE_NULL,
    PTS_POOLID D_NOMBRE_NULL,
    PTS_POOLNUMBER D_NOMBRE_NULL,
    PTS_POOLUNITLABEL D_NOMBRE_NULL,
    PTS_PUNTOSREDIMIDOS D_NOMBRE_NULL,
    PTS_PUNTOSSALDOANTERIOR D_NOMBRE_NULL,
    PTS_PUNTOSSALDODISPONIBLE D_NOMBRE_NULL,
    PTS_PUNTOSSALDODISPONIBLEEXP D_NOMBRE_NULL,
    PTS_PUNTOSSALDOREDIMIDOEXP D_NOMBRE_NULL,
    PTS_SEGMENTNUMBER D_NOMBRE_NULL,
    PTS_TIPOPOS D_NOMBRE_NULL,
    PTS_VIGENCIAPROMOCIONEXP D_NOMBRE_NULL,
    ENC_ENCABEZADOIP D_NOMBRE_NULL,
    ENC_MENSAJE D_NOMBRE_NULL,
    ENC_TIPOMENSAJE D_NOMBRE_NULL,
    ENC_IDSANDF D_NOMBRE_NULL,
    ENC_IDSECUENCIAL D_NOMBRE_NULL,
    ENC_DIRECCIONIP D_NOMBRE_NULL,
    ENC_ENCABEZADOVERSION D_NOMBRE_NULL,
    ENC_MACADDRESS D_NOMBRE_NULL,
    ENC_VERSIONDLL D_NOMBRE_NULL,
    ENC_CONECTADOPINPAD D_NOMBRE_NULL,
    ENC_USOPINPAD D_NOMBRE_NULL,
    ENC_LONGSEBEHPOS D_NOMBRE_NULL,
    ENC_MACADDALTERNATIVA D_NOMBRE_NULL,
    ENC_PINPADDETECTADO D_BOOLCN_NULL,
    ENC_QPSENLONGMACADD D_NOMBRE_NULL,
    ENC_TELECARGAPINPAD D_NOMBRE_NULL)
returns (
    BANCOMERPARAMID type of D_FK,
    ERRORCODE type of D_ERRORCODE)
as
BEGIN  
    IF(COALESCE(:BANCOMERPARAMID_ORIG,0) = 0) THEN
    BEGIN  
            INSERT INTO BANCOMERPARAM
             (  
                CREADOPOR_USERID, 
                MODIFICADOPOR_USERID, 
                AID, 
                AMEX, 
                BANCOMER, 
                BITCAMPANAS, 
                CAMPANAAUTORIZACION, 
                CAMPANAREFERENCIA, 
                CAMPANAREFERENCIANUM, 
                CARDREQUEST, 
                CARDTIPO, 
                PROMOCIONES, 
                CLIENTE_CMP_COMERCIO, 
                CLIENTE_TDC_STOCK, 
                --CLSREQUESTID, 
                --CLSRESPONSEID, 
                CODIGO_BENEFICIO1, 
                CODIGO_BENEFICIO2, 
                CODIGO_BENEFICIO3, 
                CODIGO_BENEFICIO4, 
                CODIGO_BENEFICIO5, 
                CODIGO_BENEFICIO6, 
                CODIGO_BENEFICIO7, 
                COMERCIO_CMP_COMERCIO, 
                COMERCIO_TDC_STOCK, 
                COMISION1, 
                COMISION2, 
                COMISION3, 
                COMISION4, 
                COMISION5, 
                COMISION6, 
                COMISION7, 
                CREDITODEBITO, 
                CRIPTOGRAMA, 
                ECOUPNUMBER, 
                FACTOREXP, 
                FIRMAAUTOGRAFA, 
                FIRMAELECTRONICA, 
                FIRMAQPS, 
                GUIA_CIE, 
                IDTOKEN12, 
                IDTOKEN13, 
                IDTOKEN16, 
                IDTOKENR7, 
                IDTOKENR8, 
                IMPORTE_BENEFICIO, 
                IMPORTE_UDIS, 
                INDICADOR_CAMBIO_PLAZO, 
                INDICADOR_DE_AVISO, 
                INDICAODR_DE_BENEFICIO, 
                ISFOLIO, 
                ISOFFLINE, 
                LEYENDA, 
                MACADDALTERNATIVA, 
                MENSAJE_BASE_CHEQUE, 
                MENSAJE_BASE_CONTINUOS, 
                MENSAJE_CLIENTE, 
                MENSAJE_CLIENTE_EMISRO, 
                MENSAJE_COMERCIO, 
                MODOINGRESO, 
                MONTO_BENEFICIO_MULTIPLE1, 
                MONTO_BENEFICIO_SIMPLE1, 
                MONTO_CHEQUE_ACTUAL, 
                MONTO_CHEQUE_ANTERIOR, 
                MONTO_CHEQUE_REDIMIDOS, 
                MONTO_CONTINUOS_ACTUAL, 
                MONTO_CONTINUOS_ANTERIOR, 
                MONTO_CONTINUOS_REDIMIDOS, 
                MONTO_MULTIPLE2, 
                MONTO_MULTIPLE3, 
                MONTO_MULTIPLE4, 
                MONTO_MULTIPLE5, 
                MONTO_MULTIPLE6, 
                MONTO_MULTIPLE7, 
                MONTO_SIMPLE2, 
                MONTO_SIMPLE3, 
                MONTO_SIMPLE4, 
                MONTO_SIMPLE5, 
                MONTO_SIMPLE6, 
                MONTO_SIMPLE7, 
                NOAUTORIZACION, 
                NOMBREAPLICACION, 
                NOMBRECLIENTE, 
                NUMERO_DE_BENEFICIOS, 
                NUMEROTARJETA, 
                NUMTARJETAII, 
                PAGOSMULTIPAGOSID, 
                PESOSREDIMIDOS, 
                PESOSSALDOANTERIOR, 
                PESOSSALDODISPONIBLE, 
                PESOSSALDODISPONINLEEXP, 
                PESOSSALDOREDIMIDOSEXP, 
                PINPAD_USO, 
                POOLADJUSTTYPE, 
                POOLID, 
                POOLNUMBER, 
                POOLUNITLABEL, 
                --PUNTOSID, 
                PUNTOSREDIMIDOS, 
                PUNTOSSALDOANTERIOR, 
                PUNTOSSALDODISPONIBLE, 
                PUNTOSSALDODISPONIBLEEXP, 
                PUNTOSSALDOREDIMIDOSEXP, 
                R8_CODIGO_LEYENDA, 
                R8_LEYENDA, 
                RAZON_SOCIAL, 
                REFERENCIA_RESPUESTA, 
                REFERENCIAAFIN, 
                REQUEST, 
                RESPDLL, 
                RESPONSE, 
                SEGMENTNUMBER, 
                TBINES, 
                TIPO_BENEFICIO1, 
                TIPO_BENEFICIO2, 
                TIPO_BENEFICIO3, 
                TIPO_BENEFICIO4, 
                TIPO_BENEFICIO5, 
                TIPO_BENEFICIO6, 
                TIPO_BENEFICIO7, 
                TIPO_RESPUESTA1, 
                TIPO_RESPUESTA2, 
                TIPO_RESPUESTA3, 
                TIPO_RESPUESTA4, 
                TIPO_RESPUESTA5, 
                TIPO_RESPUESTA6, 
                TIPO_RESPUESTA7, 
                TIPOPOS, 
                TNXCONPUNTOS, 
                TOPERADOR, 
                VALTIPOCARD, 
                VIGENCIAPROMOCIONESEXP, 
                DOCTOID, 
                DOCTOPAGOID, 
                ESTADOTRANSACCIONID ,
                TIPOTRANSACCION,
                REFID
                         ) 
                Values (  
                :CREADOPOR_USERID, 
                :MODIFICADOPOR_USERID, 
                :AID, 
                :AMEX, 
                :BANCOMER, 
                :BITCAMPANAS, 
                :CAMPANAAUTORIZACION, 
                :CAMPANAREFERENCIA, 
                :CAMPANAREFERENCIANUM, 
                :CARDREQUEST, 
                :CARDTIPO, 
                :PROMOCIONES, 
                :CLIENTE_CMP_COMERCIO, 
                :CLIENTE_TDC_STOCK, 
                --:CLSREQUESTID, 
                --:CLSRESPONSEID, 
                :CODIGO_BENEFICIO1, 
                :CODIGO_BENEFICIO2, 
                :CODIGO_BENEFICIO3, 
                :CODIGO_BENEFICIO4, 
                :CODIGO_BENEFICIO5, 
                :CODIGO_BENEFICIO6, 
                :CODIGO_BENEFICIO7, 
                :COMERCIO_CMP_COMERCIO, 
                :COMERCIO_TDC_STOCK, 
                :COMISION1, 
                :COMISION2, 
                :COMISION3, 
                :COMISION4, 
                :COMISION5, 
                :COMISION6, 
                :COMISION7, 
                :CREDITODEBITO, 
                :CRIPTOGRAMA, 
                :ECOUPNUMBER, 
                :FACTOREXP, 
                :FIRMAAUTOGRAFA, 
                :FIRMAELECTRONICA, 
                :FIRMAQPS, 
                :GUIA_CIE, 
                :IDTOKEN12, 
                :IDTOKEN13, 
                :IDTOKEN16, 
                :IDTOKENR7, 
                :IDTOKENR8, 
                :IMPORTE_BENEFICIO, 
                :IMPORTE_UDIS, 
                :INDICADOR_CAMBIO_PLAZO, 
                :INDICADOR_DE_AVISO, 
                :INDICAODR_DE_BENEFICIO, 
                :ISFOLIO, 
                :ISOFFLINE, 
                :LEYENDA, 
                :MACADDALTERNATIVA, 
                :MENSAJE_BASE_CHEQUE, 
                :MENSAJE_BASE_CONTINUOS, 
                :MENSAJE_CLIENTE, 
                :MENSAJE_CLIENTE_EMISRO, 
                :MENSAJE_COMERCIO, 
                :MODOINGRESO, 
                :MONTO_BENEFICIO_MULTIPLE1, 
                :MONTO_BENEFICIO_SIMPLE1, 
                :MONTO_CHEQUE_ACTUAL, 
                :MONTO_CHEQUE_ANTERIOR, 
                :MONTO_CHEQUE_REDIMIDOS, 
                :MONTO_CONTINUOS_ACTUAL, 
                :MONTO_CONTINUOS_ANTERIOR, 
                :MONTO_CONTINUOS_REDIMIDOS, 
                :MONTO_MULTIPLE2, 
                :MONTO_MULTIPLE3, 
                :MONTO_MULTIPLE4, 
                :MONTO_MULTIPLE5, 
                :MONTO_MULTIPLE6, 
                :MONTO_MULTIPLE7, 
                :MONTO_SIMPLE2, 
                :MONTO_SIMPLE3, 
                :MONTO_SIMPLE4, 
                :MONTO_SIMPLE5, 
                :MONTO_SIMPLE6, 
                :MONTO_SIMPLE7, 
                :NOAUTORIZACION, 
                :NOMBREAPLICACION, 
                :NOMBRECLIENTE, 
                :NUMERO_DE_BENEFICIOS, 
                :NUMEROTARJETA, 
                :NUMTARJETAII, 
                :PAGOSMULTIPAGOSID, 
                :PESOSREDIMIDOS, 
                :PESOSSALDOANTERIOR, 
                :PESOSSALDODISPONIBLE, 
                :PESOSSALDODISPONINLEEXP, 
                :PESOSSALDOREDIMIDOSEXP, 
                :PINPAD_USO, 
                :POOLADJUSTTYPE, 
                :POOLID, 
                :POOLNUMBER, 
                :POOLUNITLABEL, 
                --:PUNTOSID, 
                :PUNTOSREDIMIDOS, 
                :PUNTOSSALDOANTERIOR, 
                :PUNTOSSALDODISPONIBLE, 
                :PUNTOSSALDODISPONIBLEEXP, 
                :PUNTOSSALDOREDIMIDOSEXP, 
                :R8_CODIGO_LEYENDA, 
                :R8_LEYENDA, 
                :RAZON_SOCIAL, 
                :REFERENCIA_RESPUESTA, 
                :REFERENCIAAFIN, 
                :REQUEST, 
                :RESPDLL, 
                :RESPONSE, 
                :SEGMENTNUMBER, 
                :TBINES, 
                :TIPO_BENEFICIO1, 
                :TIPO_BENEFICIO2, 
                :TIPO_BENEFICIO3, 
                :TIPO_BENEFICIO4, 
                :TIPO_BENEFICIO5, 
                :TIPO_BENEFICIO6, 
                :TIPO_BENEFICIO7, 
                :TIPO_RESPUESTA1, 
                :TIPO_RESPUESTA2, 
                :TIPO_RESPUESTA3, 
                :TIPO_RESPUESTA4, 
                :TIPO_RESPUESTA5, 
                :TIPO_RESPUESTA6, 
                :TIPO_RESPUESTA7, 
                :TIPOPOS, 
                :TNXCONPUNTOS, 
                :TOPERADOR, 
                :VALTIPOCARD, 
                :VIGENCIAPROMOCIONESEXP, 
                :DOCTOID, 
                :DOCTOPAGOID, 
                :ESTADOTRANSACCIONID,
                :TIPOTRANSACCION,
                :REFID
                ) 
   RETURNING ID INTO :BANCOMERPARAMID;  
    END
    ELSE
    BEGIN
            BANCOMERPARAMID = :BANCOMERPARAMID_ORIG; 
                  update  BANCOMERPARAM
                  set  
                CREADOPOR_USERID = :CREADOPOR_USERID, 
                MODIFICADOPOR_USERID = :MODIFICADOPOR_USERID, 
                AID = :AID, 
                AMEX = :AMEX, 
                BANCOMER = :BANCOMER, 
                BITCAMPANAS = :BITCAMPANAS, 
                CAMPANAAUTORIZACION = :CAMPANAAUTORIZACION, 
                CAMPANAREFERENCIA = :CAMPANAREFERENCIA, 
                CAMPANAREFERENCIANUM = :CAMPANAREFERENCIANUM, 
                CARDREQUEST = :CARDREQUEST, 
                CARDTIPO = :CARDTIPO, 
                PROMOCIONES = :PROMOCIONES, 
                CLIENTE_CMP_COMERCIO = :CLIENTE_CMP_COMERCIO, 
                CLIENTE_TDC_STOCK = :CLIENTE_TDC_STOCK, 
                --CLSREQUESTID = :CLSREQUESTID, 
                --CLSRESPONSEID = :CLSRESPONSEID, 
                CODIGO_BENEFICIO1 = :CODIGO_BENEFICIO1, 
                CODIGO_BENEFICIO2 = :CODIGO_BENEFICIO2, 
                CODIGO_BENEFICIO3 = :CODIGO_BENEFICIO3, 
                CODIGO_BENEFICIO4 = :CODIGO_BENEFICIO4, 
                CODIGO_BENEFICIO5 = :CODIGO_BENEFICIO5, 
                CODIGO_BENEFICIO6 = :CODIGO_BENEFICIO6, 
                CODIGO_BENEFICIO7 = :CODIGO_BENEFICIO7, 
                COMERCIO_CMP_COMERCIO = :COMERCIO_CMP_COMERCIO, 
                COMERCIO_TDC_STOCK = :COMERCIO_TDC_STOCK, 
                COMISION1 = :COMISION1, 
                COMISION2 = :COMISION2, 
                COMISION3 = :COMISION3, 
                COMISION4 = :COMISION4, 
                COMISION5 = :COMISION5, 
                COMISION6 = :COMISION6, 
                COMISION7 = :COMISION7, 
                CREDITODEBITO = :CREDITODEBITO, 
                CRIPTOGRAMA = :CRIPTOGRAMA, 
                ECOUPNUMBER = :ECOUPNUMBER, 
                FACTOREXP = :FACTOREXP, 
                FIRMAAUTOGRAFA = :FIRMAAUTOGRAFA, 
                FIRMAELECTRONICA = :FIRMAELECTRONICA, 
                FIRMAQPS = :FIRMAQPS, 
                GUIA_CIE = :GUIA_CIE, 
                IDTOKEN12 = :IDTOKEN12, 
                IDTOKEN13 = :IDTOKEN13, 
                IDTOKEN16 = :IDTOKEN16, 
                IDTOKENR7 = :IDTOKENR7, 
                IDTOKENR8 = :IDTOKENR8, 
                IMPORTE_BENEFICIO = :IMPORTE_BENEFICIO, 
                IMPORTE_UDIS = :IMPORTE_UDIS, 
                INDICADOR_CAMBIO_PLAZO = :INDICADOR_CAMBIO_PLAZO, 
                INDICADOR_DE_AVISO = :INDICADOR_DE_AVISO, 
                INDICAODR_DE_BENEFICIO = :INDICAODR_DE_BENEFICIO, 
                ISFOLIO = :ISFOLIO, 
                ISOFFLINE = :ISOFFLINE, 
                LEYENDA = :LEYENDA, 
                MACADDALTERNATIVA = :MACADDALTERNATIVA, 
                MENSAJE_BASE_CHEQUE = :MENSAJE_BASE_CHEQUE, 
                MENSAJE_BASE_CONTINUOS = :MENSAJE_BASE_CONTINUOS, 
                MENSAJE_CLIENTE = :MENSAJE_CLIENTE, 
                MENSAJE_CLIENTE_EMISRO = :MENSAJE_CLIENTE_EMISRO, 
                MENSAJE_COMERCIO = :MENSAJE_COMERCIO, 
                MODOINGRESO = :MODOINGRESO, 
                MONTO_BENEFICIO_MULTIPLE1 = :MONTO_BENEFICIO_MULTIPLE1, 
                MONTO_BENEFICIO_SIMPLE1 = :MONTO_BENEFICIO_SIMPLE1, 
                MONTO_CHEQUE_ACTUAL = :MONTO_CHEQUE_ACTUAL, 
                MONTO_CHEQUE_ANTERIOR = :MONTO_CHEQUE_ANTERIOR, 
                MONTO_CHEQUE_REDIMIDOS = :MONTO_CHEQUE_REDIMIDOS, 
                MONTO_CONTINUOS_ACTUAL = :MONTO_CONTINUOS_ACTUAL, 
                MONTO_CONTINUOS_ANTERIOR = :MONTO_CONTINUOS_ANTERIOR, 
                MONTO_CONTINUOS_REDIMIDOS = :MONTO_CONTINUOS_REDIMIDOS, 
                MONTO_MULTIPLE2 = :MONTO_MULTIPLE2, 
                MONTO_MULTIPLE3 = :MONTO_MULTIPLE3, 
                MONTO_MULTIPLE4 = :MONTO_MULTIPLE4, 
                MONTO_MULTIPLE5 = :MONTO_MULTIPLE5, 
                MONTO_MULTIPLE6 = :MONTO_MULTIPLE6, 
                MONTO_MULTIPLE7 = :MONTO_MULTIPLE7, 
                MONTO_SIMPLE2 = :MONTO_SIMPLE2, 
                MONTO_SIMPLE3 = :MONTO_SIMPLE3, 
                MONTO_SIMPLE4 = :MONTO_SIMPLE4, 
                MONTO_SIMPLE5 = :MONTO_SIMPLE5, 
                MONTO_SIMPLE6 = :MONTO_SIMPLE6, 
                MONTO_SIMPLE7 = :MONTO_SIMPLE7, 
                NOAUTORIZACION = :NOAUTORIZACION, 
                NOMBREAPLICACION = :NOMBREAPLICACION, 
                NOMBRECLIENTE = :NOMBRECLIENTE, 
                NUMERO_DE_BENEFICIOS = :NUMERO_DE_BENEFICIOS, 
                NUMEROTARJETA = :NUMEROTARJETA, 
                NUMTARJETAII = :NUMTARJETAII, 
                PAGOSMULTIPAGOSID = :PAGOSMULTIPAGOSID, 
                PESOSREDIMIDOS = :PESOSREDIMIDOS, 
                PESOSSALDOANTERIOR = :PESOSSALDOANTERIOR, 
                PESOSSALDODISPONIBLE = :PESOSSALDODISPONIBLE, 
                PESOSSALDODISPONINLEEXP = :PESOSSALDODISPONINLEEXP, 
                PESOSSALDOREDIMIDOSEXP = :PESOSSALDOREDIMIDOSEXP, 
                PINPAD_USO = :PINPAD_USO, 
                POOLADJUSTTYPE = :POOLADJUSTTYPE, 
                POOLID = :POOLID, 
                POOLNUMBER = :POOLNUMBER, 
                POOLUNITLABEL = :POOLUNITLABEL, 
                --PUNTOSID = :PUNTOSID, 
                PUNTOSREDIMIDOS = :PUNTOSREDIMIDOS, 
                PUNTOSSALDOANTERIOR = :PUNTOSSALDOANTERIOR, 
                PUNTOSSALDODISPONIBLE = :PUNTOSSALDODISPONIBLE, 
                PUNTOSSALDODISPONIBLEEXP = :PUNTOSSALDODISPONIBLEEXP, 
                PUNTOSSALDOREDIMIDOSEXP = :PUNTOSSALDOREDIMIDOSEXP, 
                R8_CODIGO_LEYENDA = :R8_CODIGO_LEYENDA, 
                R8_LEYENDA = :R8_LEYENDA, 
                RAZON_SOCIAL = :RAZON_SOCIAL, 
                REFERENCIA_RESPUESTA = :REFERENCIA_RESPUESTA, 
                REFERENCIAAFIN = :REFERENCIAAFIN, 
                REQUEST = :REQUEST, 
                RESPDLL = :RESPDLL, 
                RESPONSE = :RESPONSE, 
                SEGMENTNUMBER = :SEGMENTNUMBER, 
                TBINES = :TBINES, 
                TIPO_BENEFICIO1 = :TIPO_BENEFICIO1, 
                TIPO_BENEFICIO2 = :TIPO_BENEFICIO2, 
                TIPO_BENEFICIO3 = :TIPO_BENEFICIO3, 
                TIPO_BENEFICIO4 = :TIPO_BENEFICIO4, 
                TIPO_BENEFICIO5 = :TIPO_BENEFICIO5, 
                TIPO_BENEFICIO6 = :TIPO_BENEFICIO6, 
                TIPO_BENEFICIO7 = :TIPO_BENEFICIO7, 
                TIPO_RESPUESTA1 = :TIPO_RESPUESTA1, 
                TIPO_RESPUESTA2 = :TIPO_RESPUESTA2, 
                TIPO_RESPUESTA3 = :TIPO_RESPUESTA3, 
                TIPO_RESPUESTA4 = :TIPO_RESPUESTA4, 
                TIPO_RESPUESTA5 = :TIPO_RESPUESTA5, 
                TIPO_RESPUESTA6 = :TIPO_RESPUESTA6, 
                TIPO_RESPUESTA7 = :TIPO_RESPUESTA7, 
                TIPOPOS = :TIPOPOS, 
                TNXCONPUNTOS = :TNXCONPUNTOS, 
                TOPERADOR = :TOPERADOR, 
                VALTIPOCARD = :VALTIPOCARD, 
                VIGENCIAPROMOCIONESEXP = :VIGENCIAPROMOCIONESEXP, 
                DOCTOID = :DOCTOID, 
                DOCTOPAGOID = :DOCTOPAGOID, 
                ESTADOTRANSACCIONID = :ESTADOTRANSACCIONID 
                  where  
                ID = :BANCOMERPARAMID; 
  
    END  
        SELECT CLSREQUESTID FROM BANCOMERPARAM WHERE ID = :BANCOMERPARAMID INTO :CLSREQUESTID; 
        IF(COALESCE(:CLSREQUESTID,0) = 0) THEN
        BEGIN 
              INSERT INTO REQUESTBANCOMER
                      (  
                CREADOPOR_USERID, 
                MODIFICADOPOR_USERID, 
                ISSINTJROPERADOR, 
                NOMAUTORIZACION, 
                NOMBRE, 
                PAN, 
                TOPERADOR, 
                CODTRANSACTION, 
                TERMINAL, 
                SESSION, 
                SECUENCIA, 
                IMPORTE, 
                PROPINA, 
                FOLIO, 
                CAPEMV, 
                TIPOLECTOR, 
                CAPCVV2, 
                MESESFIN, 
                PARCIALIZACION, 
                PROMOCIONES, 
                TIPOMONEDA, 
                NOAUTORIZACION, 
                MODOINGRESO, 
                CVV2, 
                TRACK2, 
                NOSECUENCIA, 
                IMPORTECASH, 
                FECHAHORACOMERCIO, 
                REFERENCIACOMERCIO, 
                OTROIMPORTE, 
                CLAVEOPERADOR, 
                AFILIACION, 
                NUMEROCUARTO, 
                REFERENCIAFINANCIERA, 
                CODIGOCONDCHIP, 
                LONGEMVFULL, 
                DATOSEMVFULL, 
                LONGLEALTAD, 
                DATOSLEALTAD, 
                LONGMULTIPAGOS, 
                DATOSMULTIPAGOS, 
                LONGDATOSCIFRADOS, 
                DATOSCIFRADOS, 
                LONGCAMPANA, 
                DATOSCAMPANA, 
                CONVENIOCIE, 
                VERSION
                         ) 
                Values (  
                :CREADOPOR_USERID, 
                :MODIFICADOPOR_USERID, 
                :REQ_ISSINTJROPERADOR, 
                :REQ_NOMAUTORIZACION, 
                :REQ_NOMBRE, 
                :REQ_PAN, 
                :REQ_TOPERADOR, 
                :REQ_CODTRANSACTION, 
                :REQ_TERMINAL, 
                :REQ_SESSION, 
                :REQ_SECUENCIA, 
                :REQ_IMPORTE, 
                :REQ_PROPINA, 
                :REQ_FOLIO, 
                :REQ_CAPEMV, 
                :REQ_TIPOLECTOR, 
                :REQ_CAPCVV2, 
                :REQ_MESESFIN, 
                :REQ_PARCIALIZACION, 
                :REQ_PROMOCIONES, 
                :REQ_TIPOMONEDA, 
                :REQ_NOAUTORIZACION, 
                :REQ_MODOINGRESO, 
                :REQ_CVV2, 
                :REQ_TRACK2, 
                :REQ_NOSECUENCIA, 
                :REQ_IMPORTECASH, 
                :REQ_FECHAHORACOMERCIO, 
                :REQ_REFERENCIACOMERCIO, 
                :REQ_OTROIMPORTE, 
                :REQ_CLAVEOPERADOR, 
                :REQ_AFILIACION, 
                :REQ_NUMEROCUARTO, 
                :REQ_REFERENCIAFINANCIERA, 
                :REQ_CODIGOCONDCHIP, 
                :REQ_LONGEMVFULL, 
                :REQ_DATOSEMVFULL, 
                :REQ_LONGLEALTAD, 
                :REQ_DATOSLEALTAD, 
                :REQ_LONGMULTIPAGOS, 
                :REQ_DATOSMULTIPAGOS, 
                :REQ_LONGDATOSCIFRADOS, 
                :REQ_DATOSCIFRADOS, 
                :REQ_LONGCAMPANA, 
                :REQ_DATOSCAMPANA, 
                :REQ_CONVENIOCIE, 
                :REQ_VERSION
                ) RETURNING ID INTO :CLSREQUESTID ; 
                UPDATE bancomerparam SET CLSREQUESTID = :CLSREQUESTID WHERE ID = :BANCOMERPARAMID;
        END
        ELSE
        BEGIN 
                  
                update  REQUESTBANCOMER
                  set  
                CREADOPOR_USERID = :CREADOPOR_USERID, 
                MODIFICADOPOR_USERID = :MODIFICADOPOR_USERID, 
                ISSINTJROPERADOR = :REQ_ISSINTJROPERADOR, 
                NOMAUTORIZACION = :REQ_NOMAUTORIZACION, 
                NOMBRE = :REQ_NOMBRE, 
                PAN = :REQ_PAN, 
                TOPERADOR = :REQ_TOPERADOR, 
                CODTRANSACTION = :REQ_CODTRANSACTION, 
                TERMINAL = :REQ_TERMINAL, 
                SESSION = :REQ_SESSION, 
                SECUENCIA = :REQ_SECUENCIA, 
                IMPORTE = :REQ_IMPORTE, 
                PROPINA = :REQ_PROPINA, 
                FOLIO = :REQ_FOLIO, 
                CAPEMV = :REQ_CAPEMV, 
                TIPOLECTOR = :REQ_TIPOLECTOR, 
                CAPCVV2 = :REQ_CAPCVV2, 
                MESESFIN = :REQ_MESESFIN, 
                PARCIALIZACION = :REQ_PARCIALIZACION, 
                PROMOCIONES = :REQ_PROMOCIONES, 
                TIPOMONEDA = :REQ_TIPOMONEDA, 
                NOAUTORIZACION = :REQ_NOAUTORIZACION, 
                MODOINGRESO = :REQ_MODOINGRESO, 
                CVV2 = :REQ_CVV2, 
                TRACK2 = :REQ_TRACK2, 
                NOSECUENCIA = :REQ_NOSECUENCIA, 
                IMPORTECASH = :REQ_IMPORTECASH, 
                FECHAHORACOMERCIO = :REQ_FECHAHORACOMERCIO, 
                REFERENCIACOMERCIO = :REQ_REFERENCIACOMERCIO, 
                OTROIMPORTE = :REQ_OTROIMPORTE, 
                CLAVEOPERADOR = :REQ_CLAVEOPERADOR, 
                AFILIACION = :REQ_AFILIACION, 
                NUMEROCUARTO = :REQ_NUMEROCUARTO, 
                REFERENCIAFINANCIERA = :REQ_REFERENCIAFINANCIERA, 
                CODIGOCONDCHIP = :REQ_CODIGOCONDCHIP, 
                LONGEMVFULL = :REQ_LONGEMVFULL, 
                DATOSEMVFULL = :REQ_DATOSEMVFULL, 
                LONGLEALTAD = :REQ_LONGLEALTAD, 
                DATOSLEALTAD = :REQ_DATOSLEALTAD, 
                LONGMULTIPAGOS = :REQ_LONGMULTIPAGOS, 
                DATOSMULTIPAGOS = :REQ_DATOSMULTIPAGOS, 
                LONGDATOSCIFRADOS = :REQ_LONGDATOSCIFRADOS, 
                DATOSCIFRADOS = :REQ_DATOSCIFRADOS, 
                LONGCAMPANA = :REQ_LONGCAMPANA, 
                DATOSCAMPANA = :REQ_DATOSCAMPANA, 
                CONVENIOCIE = :REQ_CONVENIOCIE, 
                VERSION = :REQ_VERSION
                  where  
                ID = :CLSREQUESTID; 
            
        END 
              
        SELECT CLSRESPONSEID FROM BANCOMERPARAM WHERE ID = :BANCOMERPARAMID INTO :CLSRESPONSEID; 
        IF(COALESCE(:CLSRESPONSEID,0) = 0) THEN
        BEGIN
                        INSERT INTO RESPONSEBANCOMER
                      (  
                CREADOPOR_USERID, 
                MODIFICADOPOR_USERID, 
                CODTRANSACTION, 
                TERMINAL, 
                SESSION, 
                SECUENCIA, 
                CODIGORESPUESTA, 
                NOAUTORIZACION, 
                AFILIACION, 
                FILLER1, 
                IMPORTE, 
                FILLER2, 
                TARJETA, 
                CVEOPERADOR, 
                FILLER3, 
                FOLIO, 
                LONGLEYENDA, 
                LEYENDA, 
                REFERENCIAFINAN, 
                LONGEMV, 
                DATOSEMV, 
                LONGLEALTAD, 
                DATOSLEALTAD, 
                REGISTRO1, 
                REGISTRO2, 
                REGISTRO3, 
                REGISTRO4, 
                REGISTRO5, 
                LONGMULTIPAGOS, 
                MULTIPAGOS, 
                LONGDATOSCIFRADOS, 
                DATOSCIFRADOS, 
                LONGCAMPANA, 
                DATOSCAMPANA 
                --IDENCABEZADO
                         ) 
                Values (  
                :CREADOPOR_USERID, 
                :MODIFICADOPOR_USERID, 
                :RESP_CODTRANSACTION, 
                :RESP_TERMINAL, 
                :RESP_SESSION, 
                :RESP_SECUENCIA, 
                :RESP_CODIGORESPUESTA, 
                :RESP_NOAUTORIZACION, 
                :RESP_AFILIACION, 
                :RESP_FILLER1, 
                :RESP_IMPORTE, 
                :RESP_FILLER2, 
                :RESP_TARJETA, 
                :RESP_CVEOPERADOR, 
                :RESP_FILLER3, 
                :RESP_FOLIO, 
                :RESP_LONGLEYENDA, 
                :RESP_LEYENDA, 
                :RESP_REFERENCIAFINAN, 
                :RESP_LONGEMV, 
                :RESP_DATOSEMV, 
                :RESP_LONGLEALTAD, 
                :RESP_DATOSLEALTAD, 
                :RESP_REGISTRO1, 
                :RESP_REGISTRO2, 
                :RESP_REGISTRO3, 
                :RESP_REGISTRO4, 
                :RESP_REGISTRO5, 
                :RESP_LONGMULTIPAGOS, 
                :RESP_MULTIPAGOS, 
                :RESP_LONGDATOSCIFRADOS, 
                :RESP_DATOSCIFRADOS, 
                :RESP_LONGCAMPANA, 
                :RESP_DATOSCAMPANA 
                --:RESP_IDENCABEZADO
                ) RETURNING ID INTO :CLSRESPONSEID;  
                UPDATE bancomerparam SET CLSRESPONSEID = :CLSRESPONSEID WHERE ID = :BANCOMERPARAMID; 
        END
        ELSE
        BEGIN   
                  update  RESPONSEBANCOMER
                  set   
                MODIFICADOPOR_USERID = :MODIFICADOPOR_USERID, 
                CODTRANSACTION = :RESP_CODTRANSACTION, 
                TERMINAL = :RESP_TERMINAL, 
                SESSION = :RESP_SESSION, 
                SECUENCIA = :RESP_SECUENCIA, 
                CODIGORESPUESTA = :RESP_CODIGORESPUESTA, 
                NOAUTORIZACION = :RESP_NOAUTORIZACION, 
                AFILIACION = :RESP_AFILIACION, 
                FILLER1 = :RESP_FILLER1, 
                IMPORTE = :RESP_IMPORTE, 
                FILLER2 = :RESP_FILLER2, 
                TARJETA = :RESP_TARJETA, 
                CVEOPERADOR = :RESP_CVEOPERADOR, 
                FILLER3 = :RESP_FILLER3, 
                FOLIO = :RESP_FOLIO, 
                LONGLEYENDA = :RESP_LONGLEYENDA, 
                LEYENDA = :RESP_LEYENDA, 
                REFERENCIAFINAN = :RESP_REFERENCIAFINAN, 
                LONGEMV = :RESP_LONGEMV, 
                DATOSEMV = :RESP_DATOSEMV, 
                LONGLEALTAD = :RESP_LONGLEALTAD, 
                DATOSLEALTAD = :RESP_DATOSLEALTAD, 
                REGISTRO1 = :RESP_REGISTRO1, 
                REGISTRO2 = :RESP_REGISTRO2, 
                REGISTRO3 = :RESP_REGISTRO3, 
                REGISTRO4 = :RESP_REGISTRO4, 
                REGISTRO5 = :RESP_REGISTRO5, 
                LONGMULTIPAGOS = :RESP_LONGMULTIPAGOS, 
                MULTIPAGOS = :RESP_MULTIPAGOS, 
                LONGDATOSCIFRADOS = :RESP_LONGDATOSCIFRADOS, 
                DATOSCIFRADOS = :RESP_DATOSCIFRADOS, 
                LONGCAMPANA = :RESP_LONGCAMPANA, 
                DATOSCAMPANA = :RESP_DATOSCAMPANA 
                --IDENCABEZADO = :RESP_IDENCABEZADO
                  where  
                ID = :CLSRESPONSEID;
                                          
        END  
        
        SELECT PUNTOSID FROM BANCOMERPARAM WHERE ID = :BANCOMERPARAMID INTO :PUNTOSID; 
        IF(COALESCE(:PUNTOSID,0) = 0) THEN
        BEGIN  
                        INSERT INTO STRUCPTOSBANCOMER
                      ( 
                CREADOPOR_USERID, 
                MODIFICADOPOR_USERID, 
                CARDREQUEST, 
                ECOUPNUMBER, 
                FACTOREXP, 
                PESOSREDIMIDOS, 
                PESOSSALDOANTERIOR, 
                PESOSSALDODISPONIBLE, 
                PESOSSALDODISPONINLEEXP, 
                PESOSSALDOREDIMIDOSEXP, 
                POOLADJUSTTYPE, 
                POOLID, 
                POOLNUMBER, 
                POOLUNITLABEL, 
                PUNTOSREDIMIDOS, 
                PUNTOSSALDOANTERIOR, 
                PUNTOSSALDODISPONIBLE, 
                PUNTOSSALDODISPONIBLEEXP, 
                PUNTOSSALDOREDIMIDOEXP, 
                SEGMENTNUMBER, 
                TIPOPOS, 
                VIGENCIAPROMOCIONEXP
                         ) 
                Values ( 
                :CREADOPOR_USERID, 
                :MODIFICADOPOR_USERID, 
                :PTS_CARDREQUEST, 
                :PTS_ECOUPNUMBER, 
                :PTS_FACTOREXP, 
                :PTS_PESOSREDIMIDOS, 
                :PTS_PESOSSALDOANTERIOR, 
                :PTS_PESOSSALDODISPONIBLE, 
                :PTS_PESOSSALDODISPONINLEEXP, 
                :PTS_PESOSSALDOREDIMIDOSEXP, 
                :PTS_POOLADJUSTTYPE, 
                :PTS_POOLID, 
                :PTS_POOLNUMBER, 
                :PTS_POOLUNITLABEL, 
                :PTS_PUNTOSREDIMIDOS, 
                :PTS_PUNTOSSALDOANTERIOR, 
                :PTS_PUNTOSSALDODISPONIBLE, 
                :PTS_PUNTOSSALDODISPONIBLEEXP, 
                :PTS_PUNTOSSALDOREDIMIDOEXP, 
                :PTS_SEGMENTNUMBER, 
                :PTS_TIPOPOS, 
                :PTS_VIGENCIAPROMOCIONEXP
                )RETURNING ID INTO :PUNTOSID;   
                UPDATE bancomerparam SET PUNTOSID = :PUNTOSID WHERE ID = :BANCOMERPARAMID; 
         END
         ELSE
         BEGIN  
                  update  STRUCPTOSBANCOMER
                  set  
                CREADOPOR_USERID = :CREADOPOR_USERID, 
                MODIFICADOPOR_USERID = :MODIFICADOPOR_USERID, 
                CARDREQUEST = :PTS_CARDREQUEST, 
                ECOUPNUMBER = :PTS_ECOUPNUMBER, 
                FACTOREXP = :PTS_FACTOREXP, 
                PESOSREDIMIDOS = :PTS_PESOSREDIMIDOS, 
                PESOSSALDOANTERIOR = :PTS_PESOSSALDOANTERIOR, 
                PESOSSALDODISPONIBLE = :PTS_PESOSSALDODISPONIBLE, 
                PESOSSALDODISPONINLEEXP = :PTS_PESOSSALDODISPONINLEEXP, 
                PESOSSALDOREDIMIDOSEXP = :PTS_PESOSSALDOREDIMIDOSEXP, 
                POOLADJUSTTYPE = :PTS_POOLADJUSTTYPE, 
                POOLID = :PTS_POOLID, 
                POOLNUMBER = :PTS_POOLNUMBER, 
                POOLUNITLABEL = :PTS_POOLUNITLABEL, 
                PUNTOSREDIMIDOS = :PTS_PUNTOSREDIMIDOS, 
                PUNTOSSALDOANTERIOR = :PTS_PUNTOSSALDOANTERIOR, 
                PUNTOSSALDODISPONIBLE = :PTS_PUNTOSSALDODISPONIBLE, 
                PUNTOSSALDODISPONIBLEEXP = :PTS_PUNTOSSALDODISPONIBLEEXP, 
                PUNTOSSALDOREDIMIDOEXP = :PTS_PUNTOSSALDOREDIMIDOEXP, 
                SEGMENTNUMBER = :PTS_SEGMENTNUMBER, 
                TIPOPOS = :PTS_TIPOPOS, 
                VIGENCIAPROMOCIONEXP = :PTS_VIGENCIAPROMOCIONEXP
                  where  
                ID = :PUNTOSID;  
         END  



         
        SELECT IDENCABEZADO FROM RESPONSEBANCOMER  WHERE ID = :CLSRESPONSEID INTO :RESP_IDENCABEZADO;
        IF(COALESCE(:RESP_IDENCABEZADO,0) = 0) THEN
        BEGIN  
                 
                INSERT INTO ENCABEZADORESPONSEBANCOMER
                      (  
                CREADOPOR_USERID, 
                MODIFICADOPOR_USERID, 
                ENCABEZADOIP, 
                MENSAJE, 
                TIPOMENSAJE, 
                IDSANDF, 
                IDSECUENCIAL, 
                DIRECCIONIP, 
                ENCABEZADOVERSION, 
                MACADDRESS, 
                VERSIONDLL, 
                CONECTADOPINPAD, 
                USOPINPAD, 
                LONGSEBEHPOS, 
                MACADDALTERNATIVA, 
                PINPADDETECTADO, 
                QPSENLONGMACADD, 
                TELECARGAPINPAD
                         ) 
                Values (  
                :CREADOPOR_USERID, 
                :MODIFICADOPOR_USERID, 
                :ENC_ENCABEZADOIP, 
                :ENC_MENSAJE, 
                :ENC_TIPOMENSAJE, 
                :ENC_IDSANDF, 
                :ENC_IDSECUENCIAL, 
                :ENC_DIRECCIONIP, 
                :ENC_ENCABEZADOVERSION, 
                :ENC_MACADDRESS, 
                :ENC_VERSIONDLL, 
                :ENC_CONECTADOPINPAD, 
                :ENC_USOPINPAD, 
                :ENC_LONGSEBEHPOS, 
                :ENC_MACADDALTERNATIVA, 
                :ENC_PINPADDETECTADO, 
                :ENC_QPSENLONGMACADD, 
                :ENC_TELECARGAPINPAD
                )  RETURNING ID INTO :RESP_IDENCABEZADO;   
                UPDATE RESPONSEBANCOMER SET IDENCABEZADO = :RESP_IDENCABEZADO WHERE ID = :CLSRESPONSEID; 
 


        END
        ELSE
        BEGIN

          update  ENCABEZADORESPONSEBANCOMER
                  set
                MODIFICADOPOR_USERID = :MODIFICADOPOR_USERID,
                ENCABEZADOIP = :ENC_ENCABEZADOIP,
                MENSAJE = :ENC_MENSAJE,
                TIPOMENSAJE = :ENC_TIPOMENSAJE,
                IDSANDF = :ENC_IDSANDF,
                IDSECUENCIAL = :ENC_IDSECUENCIAL,
                DIRECCIONIP = :ENC_DIRECCIONIP,
                ENCABEZADOVERSION = :ENC_ENCABEZADOVERSION,
                MACADDRESS = :ENC_MACADDRESS,
                VERSIONDLL = :ENC_VERSIONDLL,
                CONECTADOPINPAD = :ENC_CONECTADOPINPAD,
                USOPINPAD = :ENC_USOPINPAD,
                LONGSEBEHPOS = :ENC_LONGSEBEHPOS,
                MACADDALTERNATIVA = :ENC_MACADDALTERNATIVA,
                PINPADDETECTADO = :ENC_PINPADDETECTADO,
                QPSENLONGMACADD = :ENC_QPSENLONGMACADD,
                TELECARGAPINPAD = :ENC_TELECARGAPINPAD
                  where 
                ID = :RESP_IDENCABEZADO;
                        



        END


   SUSPEND; 
   
              /*
   WHEN ANY DO
   BEGIN
      ERRORCODE = 9000;
      SUSPEND;
   END   */
END