CREATE OR ALTER PROCEDURE POST_INVENTARIO_INICIAL
RETURNS (
    ERRORCODE D_ERRORCODE)
AS
DECLARE VARIABLE PRODUCTOID D_FK;
DECLARE VARIABLE CANTIDAD D_CANTIDAD;
BEGIN
   UPDATE PRODUCTO SET EXISTENCIA = 0;

   FOR SELECT PRODUCTOID, SUM(CANTIDAD)
   FROM INVENTARIO
   GROUP BY PRODUCTOID
   ORDER BY PRODUCTOID
   INTO :PRODUCTOID, :CANTIDAD DO
   BEGIN
      UPDATE PRODUCTO
      SET EXISTENCIA = :CANTIDAD
      WHERE ID = :PRODUCTOID;
   END

   ERRORCODE = 0;
   SUSPEND;

   WHEN ANY DO
   BEGIN
      ERRORCODE = 1016;
      SUSPEND;
   END 
END;