CREATE OR ALTER VIEW TICKET_HEADER(
    DOCTOID,
    ESTATUSDOCTOID,
    ALMACENID,
    SUCURSALID,
    PERSONAID,
    TIPODOCTOID,
    TOTAL,
    NOMBRE,
    DESCRIPCION,
    RFC,
    COLONIA,
    DOMICICIO,
    NUMEROEXTERIOR,
    NUMEROINTERIOR,
    CODIGOPOSTAL,
    RAZON_SOCIAL,
    TELEFONO,
    CIUDAD,
    ESTADO,
    MUNICIPIO,
    TICKET,
    SUCURSALTID,
    VENDEDORID,
    ORIGENFISCALID,
    FECHA,
    VENDEDOR,
    PERSONAAPARTADOID,
    REFERENCIA,
    DOCTOREF_FOLIO,
    DOCTOREF_REFERENCIA,
    SUBTIPODOCTOID,
    ALMACENTID)
AS
SELECT
      DOCTO.ID DOCTOID,
      DOCTO.ESTATUSDOCTOID,
      DOCTO.ALMACENID,
      DOCTO.SUCURSALID,
      DOCTO.PERSONAID,
      DOCTO.TIPODOCTOID,
      DOCTO.TOTAL   ,
      SUCURSAL.nombre         NOMBRE,
      SUCURSAL.descripcion    DESCRIPCION,


      P.rfc                     RFC,
      P.colonia                 COLONIA,
      P.calle                   DOMICICIO,
      p.numeroexterior          NUMEROEXTERIOR,
      P.numeroINterior          NUMEROINTERIOR,
      P.cp                      CODIGOPOSTAL,
      'Razon Social'            RAZON_SOCIAL,
      P.telefono                TELEFONO,
      P.localidad               CIUDAD,
      P.estado                  ESTADO,
      P.localidad               MUNICIPIO ,
      DOCTO.folio               TICKET ,
      DOCTO.SUCURSALTID          ,
      DOCTO.vendedorid          VENDEDORID ,
      DOCTO.origenfiscalid      origenfiscalid ,
      DOCTO.FECHA               FECHA ,
      V.nombre                  VENDEDOR  ,
      DOCTO.personaapartadoid   personaapartadoid ,
      DOCTO.referencia          REFERENCIA   ,
      DOCTOREF.FOLIO            DOCTOREF_FOLIO,
      DOCTOREF.referencia       DOCTOREF_REFERENCIA,
      DOCTO.subtipodoctoid          ,
      DOCTO.ALMACENTID

   FROM DOCTO  LEFT JOIN SUCURSAL ON SUCURSAL.ID = DOCTO.SUCURSALID
        left join parametro P on p.sucursalid = sucursal.id
        left join persona V on V.id = docto.vendedorid
        LEFT JOIN DOCTO DOCTOREF ON DOCTO.doctorefid = DOCTOREF.ID
;