create or alter procedure CORTE_TOTALES_PORID (
    CORTEID D_FK)
returns (
    FECHACORTE D_FECHA,
    SALDOINICIAL D_IMPORTE,
    INGRESO D_IMPORTE,
    EGRESO D_IMPORTE,
    DEVOLUCION D_IMPORTE,
    SALDOFINAL D_IMPORTE,
    APORTACION D_IMPORTE,
    RETIRO D_IMPORTE,
    INGRESOTARJETA D_IMPORTE,
    INGRESOEFECTIVO D_IMPORTE,
    INGRESOCREDITO D_IMPORTE,
    INGRESOCHEQUE D_IMPORTE,
    INGRESOVALE D_IMPORTE,
    CAMBIOCHEQUE D_IMPORTE,
    SALDOREAL D_IMPORTE,
    PAGOPROVEEDORES D_IMPORTE,
    EGRESOTARJETA D_IMPORTE,
    EGRESOEFECTIVO D_IMPORTE,
    EGRESOCREDITO D_IMPORTE,
    EGRESOCHEQUE D_IMPORTE,
    EGRESOVALE D_IMPORTE,
    SALDOREALCREDITO D_IMPORTE,
    INGRESOMONEDERO D_IMPORTE,
    EGRESOMONEDERO D_IMPORTE,
    INGRESOTRANSFERENCIA D_IMPORTE,
    EGRESOTRANSFERENCIA D_IMPORTE,
    INGRESOINDEFINIDO D_IMPORTE,
    EGRESOINDEFINIDO D_IMPORTE,
    NUMEROCANCELACIONES integer,
    NUMEROTICKETSSOLOTRASLADOS integer,
    NUMEROCANCSOLOTRASLADOS integer,
    NUMEROVENTATRASLADOS integer,
    NUMERODEVOVENTATRASLADOS integer,
    NUMEROCANCVENTATRASLADOS integer,
    CANCELACION D_IMPORTE,
    CANCVENTATRASLADOS D_IMPORTE,
    INGRESOTARJETASOLOTRASLADO D_IMPORTE,
    INGRESOEFECTIVOSOLOTRASLADO D_IMPORTE,
    INGRESOCREDITOSOLOTRASLADO D_IMPORTE,
    INGRESOCHEQUESOLOTRASLADO D_IMPORTE,
    INGRESOVALESOLOTRASLADO D_IMPORTE,
    INGRESOMONEDEROSOLOTRASLADO D_IMPORTE,
    INGRESOPORIVASOLOTRASLADO D_IMPORTE,
    INGRESOSUBTOTALSOLOTRASLADO D_IMPORTE,
    INGRESODESCUENTOSOLOTRASLADO D_IMPORTE,
    INGRESOIMPORTESOLOTRASLADO D_IMPORTE,
    INGRESOTARJETAVENTATRASLADO D_IMPORTE,
    INGRESOEFECTIVOVENTATRASLADO D_IMPORTE,
    INGRESOCREDITOVENTATRASLADO D_IMPORTE,
    INGRESOCHEQUEVENTATRASLADO D_IMPORTE,
    INGRESOVALEVENTATRASLADO D_IMPORTE,
    INGRESOMONEDEROVENTATRASLADO D_IMPORTE,
    INGRESOPORIVAVENTATRASLADO D_IMPORTE,
    INGRESOSUBTOTALVENTATRASLADO D_IMPORTE,
    INGRESODESCUENTOVENTATRASLADO D_IMPORTE,
    INGRESOIMPORTEVENTATRASLADO D_IMPORTE,
    SOLOTRASLADOS D_IMPORTE,
    CANCSOLOTRASLADOS D_IMPORTE,
    VENTATRASLADOS D_IMPORTE,
    DEVOVENTATRASLADOS D_IMPORTE,
    INGRESOTRANSFSOLOTRASLADO D_IMPORTE,
    INGRESOTRANSFVENTATRASLADO D_IMPORTE,
    INGRESOEFE_OD D_IMPORTE,
    INGRESOCRED_OD D_IMPORTE,
    INGRESOTARJ_OD D_IMPORTE,
    INGRESOCHEQUE_OD D_IMPORTE,
    INGRESOVALE_OD D_IMPORTE,
    INGRESOMONED_OD D_IMPORTE,
    INGRESOTRANSF_OD D_IMPORTE,
    INGRESOEFE_OD_VENTATRASLADO D_IMPORTE,
    INGRESOCRED_OD_VENTATRASLADO D_IMPORTE,
    INGRESOTARJ_OD_VENTATRASLADO D_IMPORTE,
    INGRESOCHEQUE_OD_VENTATRASLADO D_IMPORTE,
    INGRESOVALE_OD_VENTATRASLADO D_IMPORTE,
    INGRESOMONED_OD_VENTATRASLADO D_IMPORTE,
    INGRESOTRANSF_OD_VENTATRASLADO D_IMPORTE,
    EGRESOEFEVENTATRASLADO D_IMPORTE,
    REV_ABONOEFE_OD D_IMPORTE,
    REV_ABONOEFE_MD D_IMPORTE,
    REV_ABONOEFE_VENTATRASLA_OD D_IMPORTE,
    REV_ABONOEFE_VENTATRASLA_MD D_IMPORTE,
    REV_ABONOCHEQUE_OD D_IMPORTE,
    REV_ABONOCHEQUE_MD D_IMPORTE,
    REV_ABONOCHEQUE_VENTATRASLA_OD D_IMPORTE,
    REV_ABONOCHEQUE_VENTATRASLA_MD D_IMPORTE,
    REV_ABONOCRED_OD D_IMPORTE,
    REV_ABONOCRED_MD D_IMPORTE,
    REV_ABONOCRED_VENTATRASLA_OD D_IMPORTE,
    REV_ABONOCRED_VENTATRASLA_MD D_IMPORTE,
    REV_ABONOTARJ_OD D_IMPORTE,
    REV_ABONOTARJ_MD D_IMPORTE,
    REV_ABONOTARJ_VENTATRASLA_OD D_IMPORTE,
    REV_ABONOTARJ_VENTATRASLA_MD D_IMPORTE,
    REV_ABONOTRANSF_OD D_IMPORTE,
    REV_ABONOTRANSF_MD D_IMPORTE,
    REV_ABONOTRANSF_VENTATRASLA_OD D_IMPORTE,
    REV_ABONOTRANSF_VENTATRASLA_MD D_IMPORTE,
    REV_ABONOVALE_OD D_IMPORTE,
    REV_ABONOVALE_MD D_IMPORTE,
    REV_ABONOVALE_VENTATRASLA_OD D_IMPORTE,
    REV_ABONOVALE_VENTATRASLA_MD D_IMPORTE,
    REV_ABONOMONED_OD D_IMPORTE,
    REV_ABONOMONED_MD D_IMPORTE,
    REV_ABONOMONED_VENTATRASLA_OD D_IMPORTE,
    REV_ABONOMONED_VENTATRASLA_MD D_IMPORTE,
    ERRORCODE D_ERRORCODE)
as
declare variable ACTIVO D_BOOLCN;
declare variable TICKETSVENTA integer;
declare variable TICKETSDEVOLUCION integer;
declare variable INGRESOPORIVA D_IMPORTE;
declare variable INGRESOSUBTOTAL D_IMPORTE;
declare variable INGRESODESCUENTO D_IMPORTE;
declare variable INGRESOIMPORTE D_IMPORTE;
declare variable TOTALAFECTACION D_IMPORTE;
declare variable SUBTOTALSINIVA D_IMPORTE;
declare variable SUBTOTALCONIVA D_IMPORTE;
declare variable MONTOIVA D_IMPORTE;
declare variable MONTOIEPS D_IMPORTE;
declare variable MONTOIMPUESTO D_IMPORTE;
declare variable MANEJAIEPS D_BOOLCN;
declare variable DEVOLUCIONEFECTIVO D_IMPORTE;
declare variable DEVOLUCIONCREDITO D_IMPORTE;
declare variable DEVOLUCIONTARJETA D_IMPORTE;
declare variable DEVOLUCIONCHEQUE D_IMPORTE;
declare variable DEVOLUCIONVALE D_IMPORTE;
declare variable DEVOLUCIONMONEDERO D_IMPORTE;
declare variable DEVOLUCIONTRANSFERENCIA D_IMPORTE;
declare variable DEVOLUCIONINDEFINIDO D_IMPORTE;
declare variable RETIROSDECAJA D_IMPORTE;
declare variable GASTOS D_IMPORTE;
declare variable CANCELACIONEFECTIVO D_IMPORTE;
declare variable CANCELACIONCREDITO D_IMPORTE;
declare variable CANCELACIONTARJETA D_IMPORTE;
declare variable CANCELACIONCHEQUE D_IMPORTE;
declare variable CANCELACIONVALE D_IMPORTE;
declare variable CANCELACIONMONEDERO D_IMPORTE;
declare variable CANCELACIONTRANSFERENCIA D_IMPORTE;
declare variable CANCELACIONINDEFINIDO D_IMPORTE;
BEGIN


   ERRORCODE = 0;

    
   IF (:CORTEID IS NULL) THEN
   BEGIN
      ERRORCODE = 1020;
      SUSPEND;
      EXIT;
   END


   SELECT  ACTIVO, SALDOINICIAL, APORTACION, RETIRO, FECHACORTE , SALDOREAL, coalesce(SALDOREALCREDITO,0)
   FROM CORTE
   WHERE ID = :CORTEID
   INTO :ACTIVO, :SALDOINICIAL, :APORTACION, :RETIRO,  :FECHACORTE, :SALDOREAL, :SALDOREALCREDITO;

   /*
   IF (:ACTIVO <> 'S') THEN
   BEGIN
      ERRORCODE = 1021;
      SUSPEND;
      EXIT;
   END  */







    select  coalesce(sum(p.importe * (case when coalesce(d.total,0) = 0 then 0 else (coalesce(d.iva,0)/d.total) end)),0)  from doctopago P
    INNER JOIN docto D ON p.doctoid = d.id
    WHERE P.CORTEID = :CORTEID AND P.FORMAPAGOID IN (1,2,3,4,5,14,15,16) AND  P.TIPOPAGOID = 1
    INTO :INGRESOPORIVA;

            
     select  coalesce(sum(p.importe * (case when coalesce(d.total,0) = 0 then 0 else (coalesce(d.subtotal,0)/d.total) end)),0)  from doctopago P
    INNER JOIN docto D ON p.doctoid = d.id
    WHERE P.CORTEID = :CORTEID AND P.FORMAPAGOID IN (1,2,3,4,5,14,15,16) AND  P.TIPOPAGOID = 1
    INTO :INGRESOSUBTOTAL;

    
    select  coalesce(sum(p.importe * (case when coalesce(d.total,0) = 0 then 0 else (coalesce(d.descuento,0)/d.total) end)),0)  from doctopago P
    INNER JOIN docto D ON p.doctoid = d.id
    WHERE P.CORTEID = :CORTEID AND P.FORMAPAGOID IN (1,2,3,4,5,14,15,16) AND  P.TIPOPAGOID = 1
    INTO :INGRESODESCUENTO;

    
    select  coalesce(sum(p.importe * (case when coalesce(d.total,0) = 0 then 0 else (coalesce(d.importe,0)/d.total) end)),0)  from doctopago P
    INNER JOIN docto D ON p.doctoid = d.id
    WHERE P.CORTEID = :CORTEID AND P.FORMAPAGOID IN (1,2,3,4,5,14,15,16) AND  P.TIPOPAGOID = 1
    INTO :INGRESOIMPORTE;




   SELECT COALESCE(COUNT(*), 0)
   FROM DOCTO
   WHERE TIPODOCTOID = 21
     AND FECHA = :FECHACORTE
     AND CORTEID = :CORTEID
      AND ESTATUSDOCTOID IN (1, 2)
   INTO :TICKETSVENTA;



   SELECT COALESCE(COUNT(*), 0)
   FROM DOCTO
   WHERE TIPODOCTOID = 22
     AND FECHA = :FECHACORTE  
     AND CORTEID = :CORTEID
      AND ESTATUSDOCTOID = 1
   INTO :TICKETSDEVOLUCION;

   

   SELECT COALESCE(COUNT(*), 0)
   FROM DOCTO
   WHERE TIPODOCTOID in (23)
     AND FECHA = :FECHACORTE  
     AND CORTEID = :CORTEID
      AND ESTATUSDOCTOID = 1
   INTO :NUMEROCANCELACIONES;



      SELECT COALESCE(COUNT(*), 0)
   FROM DOCTO
   WHERE TIPODOCTOID = 21  AND SUBTIPODOCTOID IN (7,8)
     AND FECHA = :FECHACORTE
     AND CORTEID = :CORTEID
      AND ESTATUSDOCTOID IN (1, 2)
   INTO :NUMEROVENTATRASLADOS;



   SELECT COALESCE(COUNT(*), 0)
   FROM DOCTO
   WHERE TIPODOCTOID = 22  AND SUBTIPODOCTOID IN (7,8)
     AND FECHA = :FECHACORTE  
     AND CORTEID = :CORTEID
      AND ESTATUSDOCTOID = 1
   INTO :NUMERODEVOVENTATRASLADOS;

   
   SELECT COALESCE(COUNT(*), 0)
   FROM DOCTO
   WHERE TIPODOCTOID = 23  AND SUBTIPODOCTOID IN (7,8)
     AND FECHA = :FECHACORTE  
     AND CORTEID = :CORTEID
      AND ESTATUSDOCTOID = 1
   INTO :NUMEROCANCVENTATRASLADOS;


   
   SELECT COALESCE(COUNT(*), 0)
   FROM DOCTO
   WHERE TIPODOCTOID = 31  AND coalesce(SUBTIPODOCTOID,0) not IN (7,8)
     AND FECHA = :FECHACORTE
     AND CORTEID = :CORTEID
      AND ESTATUSDOCTOID IN (1, 2)
   INTO :NUMEROTICKETSSOLOTRASLADOS;


   SELECT COALESCE(COUNT(*), 0)
   FROM DOCTO
   WHERE TIPODOCTOID = 33  AND coalesce(SUBTIPODOCTOID,0) not IN (7,8)
     AND FECHA = :FECHACORTE  
     AND CORTEID = :CORTEID
      AND ESTATUSDOCTOID = 1
   INTO :NUMEROCANCSOLOTRASLADOS;










     SELECT INGRESO, EGRESO, DEVOLUCION, RETIRO, PAGOPROVEEDORES,
     INGRESOEFECTIVO, INGRESOCREDITO, INGRESOCHEQUE, CAMBIOCHEQUE, INGRESOVALE, INGRESOTARJETA,
     EGRESOEFECTIVO, EGRESOCREDITO, EGRESOCHEQUE, EGRESOVALE, EGRESOTARJETA , TOTAL, INGRESOMONEDERO, EGRESOMONEDERO ,
     cast(SUBTOTALSINIVA as d_importe),
     cast(SUBTOTALCONIVA as d_importe),
     cast(MONTOIVA as d_importe),
     INGRESOTRANSFERENCIA, EGRESOTRANSFERENCIA,
     INGRESOINDEFINIDO, EGRESOINDEFINIDO ,
     cast(MONTOIEPS as d_importe),     
     cast(MONTOIMPUESTO as d_importe),
     DEVOLUCIONEFECTIVO, DEVOLUCIONCREDITO, DEVOLUCIONTARJETA, DEVOLUCIONCHEQUE, DEVOLUCIONVALE, DEVOLUCIONMONEDERO, DEVOLUCIONTRANSFERENCIA, DEVOLUCIONINDEFINIDO,
     RETIROSDECAJA, GASTOS ,
     CANCELACION , CANCVENTATRASLADOS , INGRESOTARJETASOLOTRASLADO  ,
     INGRESOEFECTIVOSOLOTRASLADO  , INGRESOCREDITOSOLOTRASLADO  , INGRESOCHEQUESOLOTRASLADO  ,
     INGRESOVALESOLOTRASLADO  ,  INGRESOMONEDEROSOLOTRASLADO ,
     INGRESOTARJETAVENTATRASLADO  , INGRESOEFECTIVOVENTATRASLADO  , INGRESOCREDITOVENTATRASLADO   , INGRESOCHEQUEVENTATRASLADO  ,
     INGRESOVALEVENTATRASLADO   , INGRESOMONEDEROVENTATRASLADO   ,
     SOLOTRASLADOS, CANCSOLOTRASLADOS, VENTATRASLADOS, DEVOVENTATRASLADOS   ,
     CANCELACIONEFECTIVO, CANCELACIONCREDITO, CANCELACIONTARJETA, CANCELACIONCHEQUE, CANCELACIONVALE, CANCELACIONMONEDERO, CANCELACIONTRANSFERENCIA, CANCELACIONINDEFINIDO,
     INGRESOTRANSFSOLOTRASLADO , INGRESOTRANSFVENTATRASLADO ,
    INGRESOEFE_OD ,
    INGRESOCRED_OD ,
    INGRESOTARJ_OD ,
    INGRESOCHEQUE_OD ,
    INGRESOVALE_OD ,
    INGRESOMONED_OD ,  
    INGRESOTRANSF_OD ,
    INGRESOEFE_OD_VENTATRASLADO ,
    INGRESOCRED_OD_VENTATRASLADO ,
    INGRESOTARJ_OD_VENTATRASLADO ,
    INGRESOCHEQUE_OD_VENTATRASLADO ,
    INGRESOVALE_OD_VENTATRASLADO ,
    INGRESOMONED_OD_VENTATRASLADO  ,
    INGRESOTRANSF_OD_VENTATRASLADO  ,
    EGRESOEFEVENTATRASLADO ,

    
    REV_ABONOEFE_OD ,
    REV_ABONOEFE_MD ,
    REV_ABONOEFE_VENTATRASLA_OD ,
    REV_ABONOEFE_VENTATRASLA_MD ,
    REV_ABONOCHEQUE_OD ,
    REV_ABONOCHEQUE_MD ,
    REV_ABONOCHEQUE_VENTATRASLA_OD ,
    REV_ABONOCHEQUE_VENTATRASLA_MD ,
    REV_ABONOCRED_OD ,
    REV_ABONOCRED_MD ,
    REV_ABONOCRED_VENTATRASLA_OD ,
    REV_ABONOCRED_VENTATRASLA_MD ,
    REV_ABONOTARJ_OD ,
    REV_ABONOTARJ_MD ,
    REV_ABONOTARJ_VENTATRASLA_OD ,
    REV_ABONOTARJ_VENTATRASLA_MD ,
    REV_ABONOTRANSF_OD ,
    REV_ABONOTRANSF_MD ,
    REV_ABONOTRANSF_VENTATRASLA_OD ,
    REV_ABONOTRANSF_VENTATRASLA_MD ,
    REV_ABONOVALE_OD ,
    REV_ABONOVALE_MD ,
    REV_ABONOVALE_VENTATRASLA_OD ,
    REV_ABONOVALE_VENTATRASLA_MD ,
    REV_ABONOMONED_OD ,
    REV_ABONOMONED_MD ,
    REV_ABONOMONED_VENTATRASLA_OD ,
    REV_ABONOMONED_VENTATRASLA_MD 


     FROM CORTE_CALCULO_TOTALES WHERE CORTEID = :CORTEID
     INTO :INGRESO, :EGRESO, :DEVOLUCION, :RETIRO, :PAGOPROVEEDORES,
     :INGRESOEFECTIVO, :INGRESOCREDITO, :INGRESOCHEQUE, :CAMBIOCHEQUE, :INGRESOVALE, :INGRESOTARJETA,
     :EGRESOEFECTIVO, :EGRESOCREDITO, :EGRESOCHEQUE, :EGRESOVALE, :EGRESOTARJETA , :TOTALAFECTACION, :INGRESOMONEDERO, :EGRESOMONEDERO,
     :SUBTOTALSINIVA, :SUBTOTALCONIVA , :MONTOIVA,
     :INGRESOTRANSFERENCIA, :EGRESOTRANSFERENCIA,
     :INGRESOINDEFINIDO, :EGRESOINDEFINIDO,
     :MONTOIEPS, :MONTOIMPUESTO,
     :DEVOLUCIONEFECTIVO, :DEVOLUCIONCREDITO, :DEVOLUCIONTARJETA, :DEVOLUCIONCHEQUE, :DEVOLUCIONVALE, :DEVOLUCIONMONEDERO, :DEVOLUCIONTRANSFERENCIA, :DEVOLUCIONINDEFINIDO,
     :RETIROSDECAJA, :GASTOS,
     :CANCELACION , :CANCVENTATRASLADOS , :INGRESOTARJETASOLOTRASLADO  ,
     :INGRESOEFECTIVOSOLOTRASLADO  , :INGRESOCREDITOSOLOTRASLADO  , :INGRESOCHEQUESOLOTRASLADO  ,
     :INGRESOVALESOLOTRASLADO  ,  :INGRESOMONEDEROSOLOTRASLADO ,
     :INGRESOTARJETAVENTATRASLADO  , :INGRESOEFECTIVOVENTATRASLADO  , :INGRESOCREDITOVENTATRASLADO   , :INGRESOCHEQUEVENTATRASLADO  ,
     :INGRESOVALEVENTATRASLADO   , :INGRESOMONEDEROVENTATRASLADO ,
     :SOLOTRASLADOS, :CANCSOLOTRASLADOS, :VENTATRASLADOS, :DEVOVENTATRASLADOS,
     :CANCELACIONEFECTIVO, :CANCELACIONCREDITO, :CANCELACIONTARJETA, :CANCELACIONCHEQUE, :CANCELACIONVALE, :CANCELACIONMONEDERO, :CANCELACIONTRANSFERENCIA, :CANCELACIONINDEFINIDO ,
     :INGRESOTRANSFSOLOTRASLADO , :INGRESOTRANSFVENTATRASLADO,
     :INGRESOEFE_OD ,
    :INGRESOCRED_OD ,
    :INGRESOTARJ_OD ,
    :INGRESOCHEQUE_OD ,
    :INGRESOVALE_OD ,
    :INGRESOMONED_OD , 
    :INGRESOTRANSF_OD ,
    :INGRESOEFE_OD_VENTATRASLADO ,
    :INGRESOCRED_OD_VENTATRASLADO ,
    :INGRESOTARJ_OD_VENTATRASLADO ,
    :INGRESOCHEQUE_OD_VENTATRASLADO ,
    :INGRESOVALE_OD_VENTATRASLADO ,
    :INGRESOMONED_OD_VENTATRASLADO,
    :INGRESOTRANSF_OD_VENTATRASLADO,
    :EGRESOEFEVENTATRASLADO ,

    
    :REV_ABONOEFE_OD ,
    :REV_ABONOEFE_MD ,
    :REV_ABONOEFE_VENTATRASLA_OD ,
    :REV_ABONOEFE_VENTATRASLA_MD ,
    :REV_ABONOCHEQUE_OD ,
    :REV_ABONOCHEQUE_MD ,
    :REV_ABONOCHEQUE_VENTATRASLA_OD ,
    :REV_ABONOCHEQUE_VENTATRASLA_MD ,
    :REV_ABONOCRED_OD ,
    :REV_ABONOCRED_MD ,
    :REV_ABONOCRED_VENTATRASLA_OD ,
    :REV_ABONOCRED_VENTATRASLA_MD ,
    :REV_ABONOTARJ_OD ,
    :REV_ABONOTARJ_MD ,
    :REV_ABONOTARJ_VENTATRASLA_OD ,
    :REV_ABONOTARJ_VENTATRASLA_MD ,
    :REV_ABONOTRANSF_OD ,
    :REV_ABONOTRANSF_MD ,
    :REV_ABONOTRANSF_VENTATRASLA_OD ,
    :REV_ABONOTRANSF_VENTATRASLA_MD ,
    :REV_ABONOVALE_OD ,
    :REV_ABONOVALE_MD ,
    :REV_ABONOVALE_VENTATRASLA_OD ,
    :REV_ABONOVALE_VENTATRASLA_MD ,
    :REV_ABONOMONED_OD ,
    :REV_ABONOMONED_MD ,
    :REV_ABONOMONED_VENTATRASLA_OD ,
    :REV_ABONOMONED_VENTATRASLA_MD 
     ;




   SALDOFINAL = :SALDOINICIAL + :TOTALAFECTACION;  --+ :INGRESO - :EGRESO;

   UPDATE CORTE
   SET
      INGRESO = :INGRESO,
      EGRESO = :EGRESO,
      SALDOFINAL = :SALDOFINAL,
      DEVOLUCION = :DEVOLUCION,
        NUMEROTICKETS = :TICKETSVENTA,
        NUMERODEVOLUCIONES = :TICKETSDEVOLUCION ,
        INGRESOEFECTIVO = :INGRESOEFECTIVO,
        INGRESOTARJETA = :INGRESOTARJETA,
        INGRESOCREDITO = :INGRESOCREDITO,    
        INGRESOCHEQUE = :INGRESOCHEQUE ,
        INGRESOVALE = :INGRESOVALE ,
        CAMBIOCHEQUE = :CAMBIOCHEQUE,
        INGRESOPORIVA = :INGRESOPORIVA,
        INGRESOSUBTOTAL = :INGRESOSUBTOTAL,
        INGRESODESCUENTO = :INGRESODESCUENTO,
        INGRESOIMPORTE = :INGRESOIMPORTE,
        RETIRO = :RETIRO ,
        PAGOPROVEEDORES = :PAGOPROVEEDORES,
        EGRESOEFECTIVO = :EGRESOEFECTIVO,
        EGRESOTARJETA = :EGRESOTARJETA,
        EGRESOCREDITO = :EGRESOCREDITO,
        EGRESOCHEQUE = :EGRESOCHEQUE ,
        EGRESOVALE = :EGRESOVALE   ,
        INGRESOMONEDERO = :INGRESOMONEDERO,
        EGRESOMONEDERO = :EGRESOMONEDERO,

        SUBTOTALSINIVA = :SUBTOTALSINIVA, 
        SUBTOTALCONIVA = :SUBTOTALCONIVA,
        MONTOIVA = :MONTOIVA  ,

        INGRESOTRANSFERENCIA = :INGRESOTRANSFERENCIA,
        EGRESOTRANSFERENCIA = :EGRESOTRANSFERENCIA,
        INGRESOINDEFINIDO = :INGRESOINDEFINIDO,
        EGRESOINDEFINIDO = :EGRESOINDEFINIDO,
        MONTOIEPS = :MONTOIEPS ,
        MONTOIMPUESTO = :MONTOIMPUESTO ,
        DEVOLUCIONEFECTIVO = :DEVOLUCIONEFECTIVO,
        DEVOLUCIONCREDITO = :DEVOLUCIONCREDITO,
        DEVOLUCIONTARJETA = :DEVOLUCIONTARJETA,
        DEVOLUCIONCHEQUE = :DEVOLUCIONCHEQUE,
        DEVOLUCIONVALE = :DEVOLUCIONVALE,
        DEVOLUCIONMONEDERO = :DEVOLUCIONMONEDERO,
        DEVOLUCIONTRANSFERENCIA = :DEVOLUCIONTRANSFERENCIA,
        DEVOLUCIONINDEFINIDO = :DEVOLUCIONINDEFINIDO ,
        RETIROSDECAJA = :RETIROSDECAJA,
        GASTOS = :GASTOS ,


        NUMEROCANCELACIONES  = :NUMEROCANCELACIONES ,
        NUMEROSOLOTRASLADOS  = :NUMEROTICKETSSOLOTRASLADOS ,
        NUMEROCANCSOLOTRASLADOS  = :NUMEROCANCSOLOTRASLADOS ,
        NUMEROVENTATRASLADOS  = :NUMEROVENTATRASLADOS ,
        NUMERODEVOVENTATRASLADOS  = :NUMERODEVOVENTATRASLADOS ,
        NUMEROCANCVENTATRASLADOS  = :NUMEROCANCVENTATRASLADOS ,

        CANCELACION = :CANCELACION,
        CANCVENTATRASLADOS = :CANCVENTATRASLADOS,
        INGRESOTARJETASOLOTRASLADO = :INGRESOTARJETASOLOTRASLADO,
        INGRESOEFECTIVOSOLOTRASLADO = :INGRESOEFECTIVOSOLOTRASLADO,
        INGRESOCREDITOSOLOTRASLADO = :INGRESOCREDITOSOLOTRASLADO,
        INGRESOCHEQUESOLOTRASLADO = :INGRESOCHEQUESOLOTRASLADO,
        INGRESOVALESOLOTRASLADO = :INGRESOVALESOLOTRASLADO,   
        INGRESOMONEDEROSOLOTRASLADO = :INGRESOMONEDEROSOLOTRASLADO,
        INGRESOTARJETAVENTATRASLADO = :INGRESOTARJETAVENTATRASLADO,
        INGRESOEFECTIVOVENTATRASLADO = :INGRESOEFECTIVOVENTATRASLADO,
        INGRESOCREDITOVENTATRASLADO = :INGRESOCREDITOVENTATRASLADO,
        INGRESOCHEQUEVENTATRASLADO = :INGRESOCHEQUEVENTATRASLADO,
        INGRESOVALEVENTATRASLADO = :INGRESOVALEVENTATRASLADO, 
        INGRESOMONEDEROVENTATRASLADO = :INGRESOMONEDEROVENTATRASLADO ,
        SOLOTRASLADOS = :SOLOTRASLADOS,
        CANCSOLOTRASLADOS = :CANCSOLOTRASLADOS,
        VENTATRASLADOS = :VENTATRASLADOS,
        DEVOVENTATRASLADOS = :DEVOVENTATRASLADOS ,
        CANCELACIONEFECTIVO = :CANCELACIONEFECTIVO,
        CANCELACIONCREDITO = :CANCELACIONCREDITO,
        CANCELACIONTARJETA = :CANCELACIONTARJETA,
        CANCELACIONCHEQUE = :CANCELACIONCHEQUE,
        CANCELACIONVALE = :CANCELACIONVALE,
        CANCELACIONMONEDERO = :CANCELACIONMONEDERO,
        CANCELACIONTRANSFERENCIA = :CANCELACIONTRANSFERENCIA,
        CANCELACIONINDEFINIDO = :CANCELACIONINDEFINIDO  ,
        INGRESOTRANSFSOLOTRASLADO = :INGRESOTRANSFSOLOTRASLADO ,
        INGRESOTRANSFVENTATRASLADO = :INGRESOTRANSFVENTATRASLADO ,
        INGRESOEFE_OD = :INGRESOEFE_OD    ,
        INGRESOCRED_OD = :INGRESOCRED_OD    ,
        INGRESOTARJ_OD = :INGRESOTARJ_OD    ,
        INGRESOCHEQUE_OD = :INGRESOCHEQUE_OD    ,
        INGRESOVALE_OD = :INGRESOVALE_OD    ,
        INGRESOMONED_OD = :INGRESOMONED_OD    ,  
        INGRESOTRANSF_OD = :INGRESOTRANSF_OD    ,
        INGRESOEFE_OD_VENTATRASLADO = :INGRESOEFE_OD_VENTATRASLADO    ,
        INGRESOCRED_OD_VENTATRASLADO = :INGRESOCRED_OD_VENTATRASLADO    ,
        INGRESOTARJ_OD_VENTATRASLADO = :INGRESOTARJ_OD_VENTATRASLADO    ,
        INGRESOCHEQUE_OD_VENTATRASLADO = :INGRESOCHEQUE_OD_VENTATRASLADO    ,
        INGRESOVALE_OD_VENTATRASLADO = :INGRESOVALE_OD_VENTATRASLADO    ,
        INGRESOMONED_OD_VENTATRASLADO = :INGRESOMONED_OD_VENTATRASLADO   ,
        INGRESOTRANSF_OD_VENTATRASLADO = :INGRESOTRANSF_OD_VENTATRASLADO,
        EGRESOEFEVENTATRASLADO = :EGRESOEFEVENTATRASLADO ,

        REV_ABONOEFE_OD = :REV_ABONOEFE_OD,
        REV_ABONOEFE_MD = :REV_ABONOEFE_MD,
        REV_ABONOEFE_VENTATRASLA_OD = :REV_ABONOEFE_VENTATRASLA_OD,
        REV_ABONOEFE_VENTATRASLA_MD = :REV_ABONOEFE_VENTATRASLA_MD,
        REV_ABONOCHEQUE_OD = :REV_ABONOCHEQUE_OD,
        REV_ABONOCHEQUE_MD = :REV_ABONOCHEQUE_MD,
        REV_ABONOCHEQUE_VENTATRASLA_OD = :REV_ABONOCHEQUE_VENTATRASLA_OD,
        REV_ABONOCHEQUE_VENTATRASLA_MD = :REV_ABONOCHEQUE_VENTATRASLA_MD,
        REV_ABONOCRED_OD = :REV_ABONOCRED_OD,
        REV_ABONOCRED_MD = :REV_ABONOCRED_MD,
        REV_ABONOCRED_VENTATRASLA_OD = :REV_ABONOCRED_VENTATRASLA_OD,
        REV_ABONOCRED_VENTATRASLA_MD = :REV_ABONOCRED_VENTATRASLA_MD,
        REV_ABONOTARJ_OD = :REV_ABONOTARJ_OD,
        REV_ABONOTARJ_MD = :REV_ABONOTARJ_MD,
        REV_ABONOTARJ_VENTATRASLA_OD = :REV_ABONOTARJ_VENTATRASLA_OD,
        REV_ABONOTARJ_VENTATRASLA_MD = :REV_ABONOTARJ_VENTATRASLA_MD,
        REV_ABONOTRANSF_OD = :REV_ABONOTRANSF_OD,
        REV_ABONOTRANSF_MD = :REV_ABONOTRANSF_MD,
        REV_ABONOTRANSF_VENTATRASLA_OD = :REV_ABONOTRANSF_VENTATRASLA_OD,
        REV_ABONOTRANSF_VENTATRASLA_MD = :REV_ABONOTRANSF_VENTATRASLA_MD,
        REV_ABONOVALE_OD = :REV_ABONOVALE_OD,
        REV_ABONOVALE_MD = :REV_ABONOVALE_MD,
        REV_ABONOVALE_VENTATRASLA_OD = :REV_ABONOVALE_VENTATRASLA_OD,
        REV_ABONOVALE_VENTATRASLA_MD = :REV_ABONOVALE_VENTATRASLA_MD,
        REV_ABONOMONED_OD = :REV_ABONOMONED_OD,
        REV_ABONOMONED_MD = :REV_ABONOMONED_MD,
        REV_ABONOMONED_VENTATRASLA_OD = :REV_ABONOMONED_VENTATRASLA_OD,
        REV_ABONOMONED_VENTATRASLA_MD = :REV_ABONOMONED_VENTATRASLA_MD










   WHERE ID = :CORTEID;






   ERRORCODE = 0;
   SUSPEND;

   WHEN ANY DO
   BEGIN
      ERRORCODE = 1022;
      SUSPEND;
   END
END