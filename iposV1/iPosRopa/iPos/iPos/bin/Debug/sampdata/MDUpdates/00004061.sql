create or alter procedure IMPORTAR_DBF_CHECAYAIMPORTADO (
    REFERENCIA D_REFERENCIA,
    REFERENCIAS varchar(255),
    SUCURSALTID D_FK,
    TIPODOCTOID D_FK,
    FECHA D_FECHA
   )
returns (
    YAIMPORTADO D_BOOLCN,
    ERRORCODE D_ERRORCODE)
as
    declare variable CUENTA INTEGER;
BEGIN
    YAIMPORTADO = 'N';
    ERRORCODE = 0;

    SELECT COUNT(*) FROM DOCTO WHERE REFERENCIA = :REFERENCIA AND REFERENCIAS = :REFERENCIAS
    AND SUCURSALTID = :SUCURSALTID AND TIPODOCTOID = :TIPODOCTOID AND FECHA >= :FECHA
    AND DOCTO.estatusdoctoid IN (0,1)
    INTO :CUENTA;

    IF(COALESCE(:CUENTA,0) >= 1) THEN
    BEGIN
       YAIMPORTADO = 'S';
    END

    SUSPEND;
    EXIT;
    
   WHEN ANY DO
    BEGIN
        ERRORCODE = 1009;
        SUSPEND;
    END

END
