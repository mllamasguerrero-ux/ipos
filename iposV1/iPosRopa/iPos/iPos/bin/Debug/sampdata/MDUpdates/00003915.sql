create or alter procedure GUIA_CANCEL (
    GUIAID D_FK,
    CAJEROID D_FK)
returns (
    ERRORCODE type of D_ERRORCODE)
as
BEGIN

  -- FALTA COMPLETAR

   
   UPDATE DOCTO SET ESTADOGUIAID = 0, GUIAID = NULL , FECHAGUIAENVIADO = NULL, FECHAGUIARECIBIDO = NULL
    WHERE ID IN (SELECT DOCTOID FROM GUIADETALLE WHERE GUIAID = :GUIAID)
    AND GUIAID = :GUIAID;


    UPDATE GUIADETALLE SET ESTADOGUIAID = 2
    WHERE GUIAID = :GUIAID;

    UPDATE GUIA SET ESTADOGUIAID = 2
    WHERE ID = :GUIAID;



   ERRORCODE = 0;
   SUSPEND;
END