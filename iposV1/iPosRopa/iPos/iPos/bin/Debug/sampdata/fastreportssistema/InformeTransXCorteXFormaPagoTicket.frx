<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" DoublePass="true" ReportInfo.Created="03/04/2014 09:12:59" ReportInfo.Modified="12/06/2018 04:09:48" ReportInfo.CreatorVersion="2013.3.2.0">
  <ScriptText>using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;
using System.Drawing;
using System.Data;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;

namespace FastReport
{
  public class ReportScript
  {

   
    private float reportHeight = 0;

    private void Text1_BeforePrint(object sender, EventArgs e)
    {
      
      if(  ((Decimal)Report.GetParameterValue(&quot;lineaid&quot;)) == 0)
      {
        Text1.Text = &quot;Todos&quot;;
      }
      else
      {
        Text1.Text = ((String)Report.GetColumnValue(&quot;Linea.CLAVE&quot;)) + &quot; &quot; +  ((String)Report.GetColumnValue(&quot;Linea.NOMBRE&quot;));
      }  
    }

    private void Data1_BeforePrint(object sender, EventArgs e)
    {
      
      /*try{
        
      
        Data1.Visible = ( ((String)Report.GetParameterValue(&quot;desglosekits&quot;)).Equals(&quot;S&quot;) &amp;&amp; 
          ((Int64)Report.GetColumnValue(&quot;REC_DETAIL.KITMOVTOID&quot;)) &gt; 0) ||
                          
          ((Int64)Report.GetColumnValue(&quot;REC_DETAIL.GASTOADICID&quot;)) &gt; 0;
      }
      catch(Exception ex)
      {
        Data1.Visible = false;
      }       */
    }

    private void Page1_StartPage(object sender, EventArgs e)
    {
      
      if (Engine.FinalPass)
      {                                            
                                                   
        Page1.PaperHeight = (reportHeight) / Units.Millimeters 
          + Page1.TopMargin + Page1.BottomMargin;
      }
    }
    
    
    
    private void LayerX_AfterLayout(object sender, EventArgs e)
    {
              
      if((sender as BandBase).Visible)
      {
        reportHeight += (sender as BandBase).Height;    
      }
    }
    
    
  }
}
</ScriptText>
  <Dictionary>
    <FirebirdDataConnection Name="Connection" ConnectionString="rijcmlqDEsChHWgW5OFiwSyA3zls2mCAWDWIhtE3dZ3WRoD3RF5WWE8c9YSssMMMxA9lT1NbFjTBIq3X1lsnSD68eYgYsPODkxh2g8OtYG4uEW5ifX81CCrtxtqt3duCOYroNmsWw3ZEWjlmsQ/5tbLYbNA2WWwws5C7WVVBz5biu5XGPs=">
      <TableDataSource Name="Table" DataType="System.Int32" Enabled="true" SelectCommand="select&#13;&#10;max(cd.corteid) corteid,&#13;&#10;min(cd.doctoid) doctoid,&#13;&#10;case when cd.tipodoctoid = 23 then 21 else cd.tipodoctoid end tipodoctoid,&#13;&#10;max(cd.subtipodoctoid) subtipodoctoid,&#13;&#10;max(cd.formapagoid) formapagoid,&#13;&#10;sum(cd.monto) monto ,&#13;&#10;case when count(*) &gt; 1 then 0 else max(docto.total) end total,&#13;&#10;case when count(*) &gt; 1 then 0 else max(docto.saldo) end saldo,&#13;&#10;docto.folio,&#13;&#10;case when count(*) &gt; 1 then 'CANCELADA' else max(estatusdocto.nombre) end estatusdoctonombre ,&#13;&#10;max(persona.nombre) clientenombre,&#13;&#10;max(v.nombre) vendedornombre,&#13;&#10;case when count(*) &gt; 1 then&#13;&#10;        case when min(cd.tipodoctoid) = 21 then  'VENTA - CANCELACION' else '' end&#13;&#10;        else max(tipodocto.nombre) end tipodoctonombre ,&#13;&#10;max(subtipodocto.nombre) subtipodoctonombre,&#13;&#10;case when docto.subtipodoctoid in (7,8) then formapago.nombre || ' Traslados ' else formapago.nombre end  formapagonombre,&#13;&#10;max(persona.clave) clienteclave&#13;&#10;from&#13;&#10; CORTE_BASE_POR_DOCTOYFORMAPAGO cd left join&#13;&#10; docto on docto.id = cd.doctoid left join&#13;&#10; formapago on formapago.id = cd.formapagoid left join&#13;&#10; tipodocto on tipodocto.id = cd.tipodoctoid  left join&#13;&#10; subtipodocto on subtipodocto.id = docto.subtipodoctoid left join&#13;&#10; estatusdocto on estatusdocto.id = docto.estatusdoctoid left join&#13;&#10; persona on persona.id = docto.personaid left join&#13;&#10; persona v on v.id = docto.vendedorid&#13;&#10; where  cd.corteid = @corteid  and &#13;&#10;(cd.formapagoid in (2,3,4,5,15,20,21) or(cd.formapagoid = 1 and docto.tipodoctoid in (60,61,62))  or (cd.formapagoid = 1 and docto.tipodoctoid in (21,23) and docto.subtipodoctoid in (7,8)))&#13;&#10;&#13;&#10; group by docto.folio,  case when cd.tipodoctoid = 23 then 21 else cd.tipodoctoid end ,&#13;&#10;case when docto.subtipodoctoid in (7,8) then formapago.nombre || ' Traslados ' else formapago.nombre end , &#13;&#10;formapago.id">
        <Column Name="TOTAL" DataType="System.Decimal"/>
        <Column Name="CORTEID" DataType="System.Int64"/>
        <Column Name="DOCTOID" DataType="System.Int64"/>
        <Column Name="TIPODOCTOID" DataType="System.Int64"/>
        <Column Name="SUBTIPODOCTOID" DataType="System.Int64"/>
        <Column Name="FORMAPAGOID" DataType="System.Int64"/>
        <Column Name="MONTO" DataType="System.Decimal"/>
        <Column Name="SALDO" DataType="System.Decimal"/>
        <Column Name="FOLIO" DataType="System.Int32"/>
        <Column Name="ESTATUSDOCTONOMBRE" DataType="System.String"/>
        <Column Name="CLIENTENOMBRE" DataType="System.String"/>
        <Column Name="VENDEDORNOMBRE" DataType="System.String"/>
        <Column Name="TIPODOCTONOMBRE" DataType="System.String"/>
        <Column Name="SUBTIPODOCTONOMBRE" DataType="System.String"/>
        <Column Name="FORMAPAGONOMBRE" DataType="System.String"/>
        <Column Name="CLIENTECLAVE" DataType="System.String"/>
        <CommandParameter Name="corteid" DataType="1" Expression="[corteid]" DefaultValue="0"/>
      </TableDataSource>
      <TableDataSource Name="Table1" Alias="Empresa" DataType="System.Int32" Enabled="true" SelectCommand="select &#13;&#10;nombre,&#13;&#10;calle,&#13;&#10;numeroexterior,&#13;&#10;numerointerior,&#13;&#10;colonia,&#13;&#10;localidad,&#13;&#10;estado,&#13;&#10;cp,&#13;&#10;telefono,&#13;&#10;rfc,&#13;&#10;correoe&#13;&#10;&#13;&#10;from parametro;">
        <Column Name="NOMBRE" DataType="System.String"/>
        <Column Name="CALLE" DataType="System.String"/>
        <Column Name="NUMEROEXTERIOR" DataType="System.String"/>
        <Column Name="NUMEROINTERIOR" DataType="System.String"/>
        <Column Name="COLONIA" DataType="System.String"/>
        <Column Name="LOCALIDAD" DataType="System.String"/>
        <Column Name="ESTADO" DataType="System.String"/>
        <Column Name="CP" DataType="System.String"/>
        <Column Name="TELEFONO" DataType="System.String"/>
        <Column Name="RFC" DataType="System.String"/>
        <Column Name="CORREOE" DataType="System.String"/>
      </TableDataSource>
      <TableDataSource Name="Table2" Alias="Corte" DataType="System.Int32" Enabled="true" SelectCommand="select corte.id, corte.fechacorte, vendedor.nombre vendedornombre, vendedor.clave vendedorclave&#13;&#10;from corte &#13;&#10;left join persona vendedor on corte.cajeroid = vendedor.id&#13;&#10;where corte.id = @corteid">
        <Column Name="ID" DataType="System.Int64"/>
        <Column Name="FECHACORTE" DataType="System.DateTime"/>
        <Column Name="VENDEDORNOMBRE" DataType="System.String"/>
        <Column Name="VENDEDORCLAVE" DataType="System.String"/>
        <CommandParameter Name="corteid" DataType="1" Expression="[corteid]" DefaultValue="0"/>
      </TableDataSource>
    </FirebirdDataConnection>
    <Parameter Name="US_ID" DataType="System.Decimal"/>
    <Parameter Name="US_NAME" DataType="System.String"/>
    <Parameter Name="corteid" DataType="System.Int32"/>
    <Total Name="TotalPorFormaPago" Expression="[Table.MONTO]" Evaluator="Data1" PrintOn="GroupFooter1"/>
    <Total Name="Total" Expression="[Table.MONTO]" Evaluator="Data1" PrintOn="ReportSummary1"/>
  </Dictionary>
  <ReportPage Name="Page1" Landscape="true" PaperWidth="70" PaperHeight="50" LeftMargin="2" TopMargin="2" RightMargin="2" BottomMargin="2" FirstPageSource="15" OtherPagesSource="15" StartPageEvent="Page1_StartPage">
    <ReportTitleBand Name="ReportTitle1" Width="249.48" Height="189" AfterLayoutEvent="LayerX_AfterLayout">
      <TextObject Name="Text39" Left="1.89" Top="71.82" Width="234.36" Height="18.9" Text="[Empresa.NOMBRE]" Font="Arial, 8pt"/>
      <TextObject Name="Text40" Left="1.89" Top="94.5" Width="234.36" Height="41.58" Text="[Empresa.CALLE] [Empresa.NUMEROEXTERIOR] [Empresa.NUMEROINTERIOR]" Font="Arial, 8pt"/>
      <TextObject Name="Text27" Left="1.89" Top="32.13" Width="232.47" Height="37.8" Text="Transacciones por corte y forma de pago " Font="Arial, 12pt, style=Bold"/>
      <TextObject Name="Text24" Left="3.78" Top="9.45" Width="94.5" Height="18.9" Text="[Date]" Format="Date" Format.Format="d" Font="Arial, 9pt"/>
      <TextObject Name="Text50" Left="145.53" Top="139.86" Width="92.61" Height="18.9" Text="[Corte.FECHACORTE]" Format="Date" Format.Format="d" Font="Arial, 9pt"/>
      <TextObject Name="Text51" Left="-3.78" Top="139.86" Width="147.42" Height="22.68" Text="Fecha de corte:" Font="Arial, 9pt, style=Bold"/>
      <TextObject Name="Text53" Left="-3.78" Top="162.54" Width="75.6" Height="22.68" Text="Vendedor:" Font="Arial, 9pt, style=Bold"/>
      <TextObject Name="Text6" Left="79.38" Top="162.54" Width="162.54" Height="18.9" Text="[Corte.VENDEDORNOMBRE]" Font="Arial, 9pt"/>
    </ReportTitleBand>
    <GroupHeaderBand Name="GroupHeader1" Top="193" Width="249.48" Height="34.02" AfterLayoutEvent="LayerX_AfterLayout" Condition="[Table.FORMAPAGOID]">
      <TextObject Name="Text1" Top="15.12" Width="228.69" Height="18.9" Text="[Table.FORMAPAGONOMBRE]" Font="Arial, 11pt, style=Bold"/>
      <GroupHeaderBand Name="GroupHeader2" Top="231.02" Width="249.48" Height="37.8" AfterLayoutEvent="LayerX_AfterLayout" Condition="[Table.TIPODOCTOID]">
        <TextObject Name="Text18" Width="175.77" Height="18.9" Text="[Table.TIPODOCTONOMBRE]" Font="Arial, 9pt, style=Underline"/>
        <TextObject Name="Text3" Left="-1.89" Top="20.79" Width="62.37" Height="11.34" Text="FOLIO" Font="Arial, 8pt, style=Bold"/>
        <TextObject Name="Text17" Left="164.43" Top="20.79" Width="75.6" Height="11.34" Text="MONTO" Font="Arial, 8pt, style=Bold"/>
        <TextObject Name="Text5" Left="60.48" Top="20.79" Width="102.06" Height="11.34" Text="CLIENTE" Font="Arial, 8pt, style=Bold"/>
        <DataBand Name="Data1" Top="272.82" Width="249.48" Height="18.9" CanGrow="true" BeforePrintEvent="Data1_BeforePrint" AfterLayoutEvent="LayerX_AfterLayout" DataSource="Table">
          <TextObject Name="Text2" Left="1.89" Width="58.59" Height="18.9" Text="[Table.FOLIO]" Font="Arial, 8pt"/>
          <TextObject Name="Text16" Left="164.43" Width="75.6" Height="18.9" Text="[Table.MONTO]" Format="Currency" Format.UseLocale="true" HorzAlign="Right" WordWrap="false" Font="Arial, 8pt" Trimming="EllipsisCharacter"/>
          <TextObject Name="Text4" Left="60.48" Width="102.06" Height="18.9" Text="[Table.CLIENTECLAVE]" Font="Arial, 8pt"/>
        </DataBand>
        <GroupFooterBand Name="GroupFooter2" Top="295.72" Width="249.48" Height="7.56" AfterLayoutEvent="LayerX_AfterLayout"/>
      </GroupHeaderBand>
      <GroupFooterBand Name="GroupFooter1" Top="307.28" Width="249.48" Height="30.24" AfterLayoutEvent="LayerX_AfterLayout">
        <TextObject Name="Text20" Left="147.42" Width="92.61" Height="18.9" Text="[TotalPorFormaPago]" Font="Arial, 9pt"/>
        <TextObject Name="Text21" Left="-1.89" Width="154.98" Height="22.68" Text="Total por forma de pago" Font="Arial, 9pt, style=Bold"/>
      </GroupFooterBand>
    </GroupHeaderBand>
    <ReportSummaryBand Name="ReportSummary1" Top="341.52" Width="249.48" Height="39.69" AfterLayoutEvent="LayerX_AfterLayout"/>
  </ReportPage>
</Report>
