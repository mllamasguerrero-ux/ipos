<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReportInfo.Created="03/04/2014 09:12:59" ReportInfo.Modified="09/20/2016 14:34:38" ReportInfo.CreatorVersion="2013.3.2.0">
  <ScriptText>using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;
using System.Drawing;
using System.Data;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;

namespace FastReport
{
  public class ReportScript
  {

  }
}
</ScriptText>
  <Dictionary>
    <FirebirdDataConnection Name="Connection" ConnectionString="rijcmlqDEsChHWgW5OFiwSyA3zls2mCAWDWIhtE3dZ3WRoD3RGa4fuV4MzKWm/7hfiVWbDFvOZVx8SOHX0gb5rmLrybnbvH2HsHWOfPgCFQoKr29izDhiy+8Awj/+LeDV/2ybkkaRwuppBeY+kFp2ZduFz9urS6juTmWQXfQDOGhCgM52U=">
      <TableDataSource Name="Table" DataType="System.Int32" Enabled="true" SelectCommand="select&#13;&#10;       m.productoid ,&#13;&#10;       p.clave claveproducto,&#13;&#10;       p.nombre nombreproducto,&#13;&#10;       p.descripcion1 descripcion1producto ,&#13;&#10;       p.descripcion2 descripcion2producto,&#13;&#10;&#13;&#10;       &#13;&#10;       sum(coalesce(m.importe,0) * (case when d.tipodoctoid = 21 then 1 else -1 end)) importe,&#13;&#10;       sum(m.subtotal * (case when d.tipodoctoid = 21 then 1 else -1 end))   subtotal,&#13;&#10;       sum(m.iva * (case when d.tipodoctoid = 21 then 1 else -1 end))  iva,&#13;&#10;&#13;&#10;       sum(coalesce(m.cantidad,0) * (case when d.tipodoctoid = 21 then 1 else -1 end)) cantidad,&#13;&#10;       sum(coalesce(m.total,0) * (case when d.tipodoctoid = 21 then 1 else -1 end)) totalconimpuestosydescuentos,&#13;&#10;&#13;&#10;        sum(coalesce(m.precio,0) * coalesce(m.cantidad,0) * (case when d.tipodoctoid = 21 then 1 else -1 end) ) /&#13;&#10;                    case when sum(coalesce(m.cantidad,0) * (case when d.tipodoctoid = 21 then 1 else -1 end)) &gt; 0 then&#13;&#10;                              sum(coalesce(m.cantidad,0) * (case when d.tipodoctoid = 21 then 1 else -1 end))&#13;&#10;                    else 1&#13;&#10;                    end   preciopromedio ,&#13;&#10;&#13;&#10;&#13;&#10;        sum(coalesce(m.costopromedio,0) * coalesce(m.cantidad,0) * (case when d.tipodoctoid = 21 then 1 else -1 end) ) /&#13;&#10;            case when sum(coalesce(m.cantidad,0) * (case when d.tipodoctoid = 21 then 1 else -1 end)) &gt; 0 then&#13;&#10;                    sum(coalesce(m.cantidad,0) * (case when d.tipodoctoid = 21 then 1 else -1 end))&#13;&#10;            else 1&#13;&#10;        end   costopromedio ,&#13;&#10;&#13;&#10;       sum( (coalesce(m.precio,0) - coalesce(m.costopromedio,0)) * coalesce(m.cantidad,0) * (case when d.tipodoctoid = 21 then 1 else -1 end) )  utilidad&#13;&#10;&#13;&#10;       ,&#13;&#10;&#13;&#10;       &#13;&#10;case&#13;&#10;    when  p.unidad = 'KG' then&#13;&#10;          cast(sum((case when d.tipodoctoid = 21 then 1 else -1 end) * cast(m.cantidad   as numeric(18,3)) ) as varchar(20) )  || ' KG'&#13;&#10;    when p.unidad &lt;&gt; 'PZA' and p.unidad &lt;&gt; 'KG' then&#13;&#10;        cast(sum((case when d.tipodoctoid = 21 then 1 else -1 end) * cast(m.cantidad   as numeric(18,2))) as varchar(20) )&#13;&#10;    when  ( coalesce(p.pzacaja,0) = 0 or  coalesce(p.pzacaja,0) = 1 ) then&#13;&#10;         cast(sum((case when d.tipodoctoid = 21 then 1 else -1 end) * cast(m.cantidad   as numeric(18,2)) ) as varchar(20) ) || ' PZAS'&#13;&#10;    else&#13;&#10;        cast(trunc(coalesce(     sum((case when d.tipodoctoid = 21 then 1 else -1 end) * cast(m.cantidad   as numeric(18,2)) )   ,0)/coalesce(p.pzacaja,1)) as varchar(20)) || ' cajas ' ||  cast(mod(coalesce(    sum((case when d.tipodoctoid = 21 then 1 else -1 end) * cast(m.cantidad   as numeric(18,2)) )   ,0),coalesce(p.pzacaja,1)) as varchar(10)) || ' piezas '&#13;&#10;end &#13;&#10;&#13;&#10;descpzacaja&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;from   DOCTO d left join&#13;&#10;       MOVTO m on m.doctoid = d.id left join&#13;&#10;       producto p on p.id = m.productoid left join&#13;&#10;       RUTAEMBARQUE r ON d.RUTAEMBARQUEID = r.ID&#13;&#10;&#13;&#10;where  (d.fecha &lt;= @fechaFin AND  d.fecha &gt;= @fechaIni) &#13;&#10;and (coalesce(d.esfacturaelectronica,'N') = @esfactura or @esfactura = 'T')&#13;&#10;and (@rutaclave like '%|' || r.clave || '|%') &#13;&#10;and m.cantidad &gt; 0  &#13;&#10;and d.tipodoctoid in (21,22)&#13;&#10;and d.estatusdoctoid = 1&#13;&#10;&#13;&#10;group by&#13;&#10;       m.productoid ,&#13;&#10;       p.clave ,&#13;&#10;       p.nombre ,&#13;&#10;       p.descripcion1 ,&#13;&#10;       p.descripcion2,&#13;&#10;       p.unidad  ,&#13;&#10;       p.pzacaja">
        <Column Name="PRODUCTOID" DataType="System.Int64"/>
        <Column Name="CLAVEPRODUCTO" DataType="System.String"/>
        <Column Name="NOMBREPRODUCTO" DataType="System.String"/>
        <Column Name="DESCRIPCION1PRODUCTO" DataType="System.String"/>
        <Column Name="SUBTOTAL" DataType="System.Decimal"/>
        <Column Name="IVA" DataType="System.Decimal"/>
        <Column Name="CANTIDAD" DataType="System.Decimal"/>
        <Column Name="TOTALCONIMPUESTOSYDESCUENTOS" DataType="System.Decimal"/>
        <Column Name="PRECIOPROMEDIO" DataType="System.Decimal"/>
        <Column Name="COSTOPROMEDIO" DataType="System.Decimal"/>
        <Column Name="UTILIDAD" DataType="System.Decimal"/>
        <Column Name="DESCPZACAJA" DataType="System.String"/>
        <Column Name="DESCRIPCION2PRODUCTO" DataType="System.String"/>
        <Column Name="IMPORTE" DataType="System.Decimal"/>
        <CommandParameter Name="fechafin" DataType="5" Expression="[fechafin]" DefaultValue="01/01/2021"/>
        <CommandParameter Name="fechaini" DataType="5" Expression="[fechaini]" DefaultValue="01/01/2010"/>
        <CommandParameter Name="esfactura" DataType="4" Expression="[esfactura]"/>
        <CommandParameter Name="rutaclave" DataType="4" Expression="[rutaclave]"/>
      </TableDataSource>
      <TableDataSource Name="Table1" Alias="Empresa" DataType="System.Int32" Enabled="true" SelectCommand="select &#13;&#10;nombre,&#13;&#10;calle,&#13;&#10;numeroexterior,&#13;&#10;numerointerior,&#13;&#10;colonia,&#13;&#10;localidad,&#13;&#10;estado,&#13;&#10;cp,&#13;&#10;telefono,&#13;&#10;rfc,&#13;&#10;correoe&#13;&#10;&#13;&#10;from parametro;">
        <Column Name="NOMBRE" DataType="System.String"/>
        <Column Name="CALLE" DataType="System.String"/>
        <Column Name="NUMEROEXTERIOR" DataType="System.String"/>
        <Column Name="NUMEROINTERIOR" DataType="System.String"/>
        <Column Name="COLONIA" DataType="System.String"/>
        <Column Name="LOCALIDAD" DataType="System.String"/>
        <Column Name="ESTADO" DataType="System.String"/>
        <Column Name="CP" DataType="System.String"/>
        <Column Name="TELEFONO" DataType="System.String"/>
        <Column Name="RFC" DataType="System.String"/>
        <Column Name="CORREOE" DataType="System.String"/>
      </TableDataSource>
    </FirebirdDataConnection>    <Parameter Name="US_ID" DataType="System.Decimal"/>    <Parameter Name="US_NAME" DataType="System.String"/>
    <Parameter Name="fechaini" DataType="System.DateTime"/>
    <Parameter Name="fechafin" DataType="System.DateTime"/>
    <Parameter Name="esfactura" DataType="System.Char"/>
    <Parameter Name="rutaclave" DataType="System.Char"/>
  </Dictionary>
  <ReportPage Name="Page1" Landscape="true" PaperWidth="297" PaperHeight="210" RawPaperSize="9">
    <ReportTitleBand Name="ReportTitle1" Width="1047.06" Height="207.9">
      <TextObject Name="Text38" Left="9.45" Top="37.8" Width="170.1" Height="18.9" Text="Datos de la empresa:" Font="Arial, 11pt, style=Bold"/>
      <TextObject Name="Text39" Left="103.95" Top="66.15" Width="302.4" Height="18.9" Text="[Empresa.NOMBRE]" Font="Arial, 8pt"/>
      <TextObject Name="Text48" Left="9.45" Top="66.15" Width="75.6" Height="18.9" Text="Nombre:" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text34" Left="481.95" Top="66.15" Width="75.6" Height="18.9" Text="RFC:" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text43" Left="567" Top="66.15" Width="302.4" Height="18.9" Text="[Empresa.RFC]" Font="Arial, 8pt"/>
      <TextObject Name="Text40" Left="103.95" Top="85.05" Width="302.4" Height="18.9" Text="[Empresa.CALLE] [Empresa.NUMEROEXTERIOR] [Empresa.NUMEROINTERIOR]" Font="Arial, 8pt"/>
      <TextObject Name="Text41" Left="567" Top="85.05" Width="302.4" Height="18.9" Text="[Empresa.COLONIA]" Font="Arial, 8pt"/>
      <TextObject Name="Text30" Left="9.45" Top="85.05" Width="75.6" Height="18.9" Text="Domicilio:" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text35" Left="481.95" Top="85.05" Width="75.6" Height="18.9" Text="Colonia:" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text42" Left="103.95" Top="103.95" Width="302.4" Height="18.9" Text="[Empresa.LOCALIDAD]" Font="Arial, 8pt"/>
      <TextObject Name="Text31" Left="9.45" Top="103.95" Width="75.6" Height="18.9" Text="Localidad:" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text36" Left="481.95" Top="103.95" Width="75.6" Height="18.9" Text="Estado:" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text44" Left="567" Top="103.95" Width="302.4" Height="18.9" Text="[Empresa.ESTADO]" Font="Arial, 8pt"/>
      <TextObject Name="Text45" Left="103.95" Top="122.85" Width="302.4" Height="18.9" Text="[Empresa.CP]" Font="Arial, 8pt"/>
      <TextObject Name="Text32" Left="9.45" Top="122.85" Width="75.6" Height="18.9" Text="Codigo postal:" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text37" Left="481.95" Top="122.85" Width="75.6" Height="18.9" Text="Teléfono:" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text46" Left="567" Top="122.85" Width="302.4" Height="18.9" Text="[Empresa.TELEFONO]" Font="Arial, 8pt"/>
      <TextObject Name="Text47" Left="103.95" Top="141.75" Width="302.4" Height="18.9" Text="[Empresa.CORREOE]" Font="Arial, 8pt"/>
      <TextObject Name="Text33" Left="9.45" Top="141.75" Width="75.6" Height="18.9" Text="Correo:" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text27" Left="9.45" Top="9.45" Width="378" Height="18.9" Text="Ventas por Ruta" Font="Arial, 12pt, style=Bold"/>
      <TextObject Name="Text50" Left="9.45" Top="179.55" Width="94.5" Height="18.9" Text="Fecha inicio:" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text51" Left="529.2" Top="179.55" Width="75.6" Height="18.9" Text="Fecha fin:" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text20" Left="122.85" Top="179.55" Width="94.5" Height="18.9" Text="[fechaini]" Format="Date" Format.Format="d" Font="Arial, 9pt"/>
      <TextObject Name="Text21" Left="614.25" Top="179.55" Width="94.5" Height="18.9" Text="[fechafin]" Format="Date" Format.Format="d" Font="Arial, 9pt"/>
      <TextObject Name="Text24" Left="718.2" Top="9.45" Width="94.5" Height="18.9" Text="[Date]" Format="Date" Format.Format="d" Font="Arial, 9pt"/>
    </ReportTitleBand>
    <PageHeaderBand Name="PageHeader1" Top="211.9" Width="1047.06" Height="28.35">
      <TextObject Name="Text2" Left="9.45" Width="94.5" Height="28.35" Text="CLAVE PRODUCTO" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text4" Left="113.4" Width="141.75" Height="28.35" Text="DESCRIPCION 1 PRODUCTO" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text6" Left="255.15" Width="122.85" Height="28.35" Text="DESCRIPCION 2 PRODUCTO" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text8" Left="378" Width="94.5" Height="18.9" Text="CANTIDAD" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text10" Left="472.5" Width="103.95" Height="28.35" Text="DESC. PZA/CAJA" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text12" Left="708.75" Width="179.55" Height="28.35" Text="TOTAL CON IMPUESTOS Y DESCUENTOS" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text14" Left="576.45" Width="132.3" Height="18.9" Text="IMPORTE" Font="Arial, 10pt, style=Bold"/>
    </PageHeaderBand>
    <DataBand Name="Data1" Top="244.25" Width="1047.06" Height="28.35" CanGrow="true" DataSource="Table">
      <TextObject Name="Text1" Left="9.45" Width="94.5" Height="28.35" Text="[Table.CLAVEPRODUCTO]" Font="Arial, 9pt"/>
      <TextObject Name="Text3" Left="113.4" Width="141.75" Height="28.35" Text="[Table.DESCRIPCION1PRODUCTO]" Font="Arial, 9pt"/>
      <TextObject Name="Text5" Left="255.15" Width="122.85" Height="28.35" Text="[Table.DESCRIPCION2PRODUCTO]" Font="Arial, 9pt"/>
      <TextObject Name="Text7" Left="378" Width="94.5" Height="28.35" Text="[Table.CANTIDAD]" Format="Number" Format.UseLocale="true" WordWrap="false" Font="Arial, 9pt" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text9" Left="472.5" Width="103.95" Height="28.35" Text="[Table.DESCPZACAJA]" Font="Arial, 9pt"/>
      <TextObject Name="Text11" Left="708.75" Width="179.55" Height="28.35" Text="[Table.TOTALCONIMPUESTOSYDESCUENTOS]" Format="Currency" Format.UseLocale="true" HorzAlign="Right" WordWrap="false" Font="Arial, 9pt" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text13" Left="576.45" Width="132.3" Height="18.9" Text="[Table.IMPORTE]" Format="Currency" Format.UseLocale="true" HorzAlign="Right" WordWrap="false" Font="Arial, 9pt" Trimming="EllipsisCharacter"/>
    </DataBand>
    <PageFooterBand Name="PageFooter1" Top="276.6" Width="1047.06" Height="18.9">
      <TextObject Name="Text19" Left="935.55" Width="56.7" Height="18.9" Text="[Page]" Font="Arial, 8pt"/>
     <TextObject Name="TextFooterGeneral2" Left="151.2" Width="66.15" Height="18.9" PrintOn="LastPage, OddPages, EvenPages, RepeatedBand, SinglePage" Text="[Date]" Format="Date" Format.Format="d" Font="Arial, 8pt, style=Bold"/> <TextObject Name="TextFooterGeneral3" Left="217.35" Width="151.2" Height="18.9" CanShrink="true" PrintOn="LastPage, OddPages, EvenPages, RepeatedBand, SinglePage" CanBreak="false" Text="[Date]" Format="Time" Format.Format="T" WordWrap="false" Font="Arial, 8pt, style=Bold"/> <TextObject Name="TextFooterGeneral1" Left="9.45" Width="141.75" Height="18.9" CanShrink="true" CanBreak="false" Text="Power by I-POS" HorzAlign="Center" WordWrap="false" Font="Arial, 8pt, style=Bold"/> <TextObject Name="TextFooterGeneral4" Left="368.55" Width="94.5" Height="18.9" Text="[US_NAME]" Font="Arial, 8pt, style=Bold"/> </PageFooterBand>
  </ReportPage>
</Report>
