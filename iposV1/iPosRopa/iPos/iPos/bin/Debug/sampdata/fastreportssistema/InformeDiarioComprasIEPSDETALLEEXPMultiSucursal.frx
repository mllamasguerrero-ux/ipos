<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReportInfo.Created="05/06/2014 21:00:03" ReportInfo.Modified="11/29/2016 07:04:57" ReportInfo.CreatorVersion="2013.3.2.0">
  <ScriptText>using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;
using System.Drawing;
using System.Data;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;

namespace FastReport
{
  
  public class TextPositions
  {
       public TextObject textField;
       public float initialX;
       public string strField;
    public TextPositions(ref TextObject p_textField)
    {
      textField = p_textField;
      initialX = p_textField.Left;
    }
    
    public TextPositions(ref TextObject p_textField, string p_strField)
    {
      textField = p_textField;
      initialX = p_textField.Left;
      strField = p_strField;
    }
    
    
    
  }
  
  public class ReportScript
  {
     
    static float posicionInicioTextFlex;
    static TextPositions[] textFlex;    
    static TextPositions[] textIEPSPorc; 
    
         
    private void ReportTitle1_BeforePrint(object sender, EventArgs e)
    {      
      
      
      
      /*textIEPSPorc = new TextPositions[10]
        {
        new TextPositions(ref Text45,&quot;Table.IEPS_01_PORC&quot;), 
        new TextPositions(ref Text47,&quot;Table.IEPS_02_PORC&quot;), 
        new TextPositions(ref Text49,&quot;Table.IEPS_03_PORC&quot;), 
        new TextPositions(ref Text51,&quot;Table.IEPS_04_PORC&quot;), 
        new TextPositions(ref Text53,&quot;Table.IEPS_05_PORC&quot;), 
        new TextPositions(ref Text55,&quot;Table.IEPS_06_PORC&quot;),
        new TextPositions(ref Text57,&quot;Table.IEPS_07_PORC&quot;), 
        new TextPositions(ref Text59,&quot;Table.IEPS_08_PORC&quot;),
        new TextPositions(ref Text61,&quot;Table.IEPS_09_PORC&quot;), 
        new TextPositions(ref Text63,&quot;Table.IEPS_10_PORC&quot;)
        };
      
      
      textFlex = new TextPositions[16]
        {
        new TextPositions(ref Text65), 
        new TextPositions(ref Text66), 
        new TextPositions(ref Text17), 
        new TextPositions(ref Text18),
        new TextPositions(ref Text27), 
        new TextPositions(ref Text28), 
        new TextPositions(ref Text29), 
        new TextPositions(ref Text30),
        new TextPositions(ref Text35), 
        new TextPositions(ref Text36), 
        new TextPositions(ref Text37), 
        new TextPositions(ref Text38), 
        new TextPositions(ref Text39), 
        new TextPositions(ref Text40), 
        new TextPositions(ref Text41), 
        new TextPositions(ref Text42)
        };
      
        posicionInicioTextFlex = textFlex[0].initialX;     */
    }
    
    
    private void AjustarCampos()
    {
      float lastIEPSPorcX = posicionInicioTextFlex;
             
      
      foreach(TextPositions tp in textIEPSPorc)
      {
         if( ((Decimal)Report.GetColumnValue(tp.strField)) == -1)
        {
          lastIEPSPorcX = tp.initialX;
          break;
        }
      }                 
      foreach(TextPositions tp in textFlex)
      {
        if(tp.initialX &gt;= posicionInicioTextFlex)
        {
              tp.textField.Left = tp.initialX - (posicionInicioTextFlex - lastIEPSPorcX);
          
        }
      }
    
    }
              
    private void GuardarHeadersIEPS(ref List&lt;decimal&gt; datosIEPS,  string strConexion)
    {
      Report.Dictionary.Connections[0].ConnectionString = strConexion;
                                                 
      DataSourceBase rowDataSuc1 = Report.GetDataSource(&quot;Table&quot;); 
      rowDataSuc1.ForceLoadData = true;
      rowDataSuc1.Init();
        
      while (rowDataSuc1.HasMoreRows)
      {
        
        for(int i = 1; i &lt;= 10; i++)
        {
          string strI = i.ToString(&quot;00&quot;);
          try 
          {
            
            decimal ieps_porc = (Decimal)Report.GetColumnValue(&quot;Table.IEPS_&quot; + strI + &quot;_PORC&quot;) ;    
        
            if(ieps_porc &gt;= 0 &amp;&amp; !datosIEPS.Contains(ieps_porc))
            {
              datosIEPS.Add(ieps_porc);
            }
          }
          catch{
          }                                                                                     
        }
        
                  
           
        rowDataSuc1.Next();
      }
    }

    private void ImprimirHeaders(ref List&lt;decimal&gt; datosIEPS)
    {
      FastReport.Table.TableCell tc = null;
      FastReport.Table.TableRow tr =  new FastReport.Table.TableRow();
      
                        
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;TIPO&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;SUBTIPO&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;FECHA&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;FECHAHORA&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;SUCURSAL&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;ALMACEN&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;FOLIO&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;SERIE FOLIO SAT&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;ES FACTRURA ELECTRONICA&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;USUARIO&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;PROVEEDOR&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;SUC. ORIGEN&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;REF. FOLIO ORIGEN&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;ALM.FUENTE&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;MARCA NOMBRE&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;PRODUCTO CLAVE&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;PRODUCTO NOMBRE&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;PRODUCTO DESCRIPCION&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;LOTE&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;LOTE VENCE&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;COSTO PROMEDIO&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;CANTIDAD&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;COSTO&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;IMPORTE&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;DESCUENTO&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;SUBTOTAL&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;IVA&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      foreach(decimal ieps in datosIEPS)
      {
        
        tc = new FastReport.Table.TableCell();
        tc.Text = &quot;IEPS%&quot; + ieps.ToString();
        tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
        tr.AddChild(tc);
      }
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;IEPS&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
      
      tc = new FastReport.Table.TableCell();
      tc.Text = &quot;TOTAL&quot;;
      tc.Font = new System.Drawing.Font(&quot;Microsoft Sans Serif&quot;, 8F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
      tr.AddChild(tc);
                         
      
      Table1.Rows.Add(tr);
      Table1.PrintRow(1); 
      Table1.PrintColumns();
    }
    
    private void ImprimirRegistros(string strConexion, int cont, ref List&lt;decimal&gt; datosIEPS)
    {
      Report.Dictionary.Connections[0].ConnectionString = strConexion;
      FastReport.Table.TableCell tc = null;
      FastReport.Table.TableRow tr =  new FastReport.Table.TableRow();
      
      DataSourceBase rowDataSuc1 = Report.GetDataSource(&quot;Table&quot;); 
      rowDataSuc1.ForceLoadData = true;
      rowDataSuc1.Init();
      
      DataSourceBase rowDataSuc2 = Report.GetDataSource(&quot;Suc&quot;); 
      rowDataSuc2.ForceLoadData = true;
      rowDataSuc2.Init();
      
      //string sucName = ((String)Report.GetColumnValue(&quot;Suc.NOMBRE&quot;));
      
      //MessageBox.Show(sucName);
      
      while (rowDataSuc1.HasMoreRows)
      {
        tr = new FastReport.Table.TableRow();
        
        
                        
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((String)Report.GetColumnValue(&quot;Table.TIPODOC&quot;)); 
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((String)Report.GetColumnValue(&quot;Table.NOMBRESUBTIPODOCTO&quot;)); 
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((DateTime)Report.GetColumnValue(&quot;Table.FECHA&quot;)).ToString();
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((DateTime)Report.GetColumnValue(&quot;Table.FECHAHORA&quot;)).ToString();
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((String)Report.GetColumnValue(&quot;Table.NOMBRESUCURSAL&quot;));
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc); 
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((String)Report.GetColumnValue(&quot;Table.NOMBREALMACEN&quot;));
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((Int32)Report.GetColumnValue(&quot;Table.DOCTOFOLIO&quot;)).ToString();
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((String)Report.GetColumnValue(&quot;Table.SERIEFOLIOSAT&quot;));
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((String)Report.GetColumnValue(&quot;Table.ESTATUS&quot;));
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((String)Report.GetColumnValue(&quot;Table.VENDEDOR&quot;));
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text =  ((String)Report.GetColumnValue(&quot;Table.PERSONA&quot;));
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((String)Report.GetColumnValue(&quot;Table.SUCURSALORIGEN&quot;));
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((String)Report.GetColumnValue(&quot;Table.REFERENCIAORIGEN&quot;));
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((String)Report.GetColumnValue(&quot;Table.NOMBREALMACENTRASPASO&quot;));
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((String)Report.GetColumnValue(&quot;Table.MARCANOMBRE&quot;));
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((String)Report.GetColumnValue(&quot;Table.PRODUCTOCLAVE&quot;));
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((String)Report.GetColumnValue(&quot;Table.PRODUCTONOMBRE&quot;));
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((String)Report.GetColumnValue(&quot;Table.PRODUCTODESCRIPCION&quot;)); 
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((String)Report.GetColumnValue(&quot;Table.LOTE&quot;));
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((DateTime)Report.GetColumnValue(&quot;Table.LOTEVENCE&quot;)).ToString(); 
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((Decimal)Report.GetColumnValue(&quot;Table.COSTOPROMEDIO&quot;)).ToString(&quot;#,0.00#&quot;);
          tc.HorzAlign= FastReport.HorzAlign.Right;
          tc.Format = new FastReport.Format.CurrencyFormat();
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((Decimal)Report.GetColumnValue(&quot;Table.CANTIDAD&quot;)).ToString(&quot;#,0.00#&quot;);
          tc.HorzAlign= FastReport.HorzAlign.Right;
          tc.Format = new FastReport.Format.NumberFormat();
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((Decimal)Report.GetColumnValue(&quot;Table.PRECIO&quot;)).ToString(&quot;#,0.00#&quot;);
          tc.HorzAlign= FastReport.HorzAlign.Right;
          tc.Format = new FastReport.Format.CurrencyFormat();
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((Decimal)Report.GetColumnValue(&quot;Table.IMPORTE&quot;)).ToString(&quot;#,0.00#&quot;);
          tc.HorzAlign= FastReport.HorzAlign.Right;
          tc.Format = new FastReport.Format.CurrencyFormat();
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((Decimal)Report.GetColumnValue(&quot;Table.DESCUENTO&quot;)).ToString(&quot;#,0.00#&quot;);
          tc.HorzAlign= FastReport.HorzAlign.Right;
          tc.Format = new FastReport.Format.PercentFormat();
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
                             
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((Decimal)Report.GetColumnValue(&quot;Table.SUBTOTAL&quot;)).ToString(&quot;#,0.00#&quot;);
          tc.HorzAlign= FastReport.HorzAlign.Right;
          tc.Format = new FastReport.Format.CurrencyFormat();
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((Decimal)Report.GetColumnValue(&quot;Table.IVA&quot;)).ToString();
          tc.Format = new FastReport.Format.PercentFormat();
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
        
        foreach(decimal ieps in datosIEPS)
        {
          
          
          decimal valorCelda = 0;
          for(int i = 1; i &lt;= 10; i++)
          {
            string strI = i.ToString(&quot;00&quot;);
            try 
            {
            
              decimal ieps_porc = (Decimal)Report.GetColumnValue(&quot;Table.IEPS_&quot; + strI + &quot;_PORC&quot;) ;    
        
              if(ieps_porc == ieps )
              {
                valorCelda = ((Decimal)Report.GetColumnValue(&quot;Table.IEPS_&quot; + strI + &quot;_IMPORTE&quot;));
              }
            }
            catch{
            }                                                                                     
          }
          
                      
          tc = new FastReport.Table.TableCell();
          try{
              tc.Text = valorCelda.ToString();
          }
          catch(Exception ex)
          {               
          }
          tr.AddChild(tc);  
          
          
        }
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((Decimal)Report.GetColumnValue(&quot;Table.IEPS&quot;)).ToString();
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
        
        tc = new FastReport.Table.TableCell();
        try{
          tc.Text = ((Decimal)Report.GetColumnValue(&quot;Table.TOTAL&quot;)).ToString(&quot;#,0.00#&quot;);
          tc.HorzAlign= FastReport.HorzAlign.Right;
          tc.Format = new FastReport.Format.CurrencyFormat();
        }
        catch(Exception ex)
        {
          tc.Text = &quot;&quot;;
        }
        tr.AddChild(tc);
        
                          
        Table1.Rows.Add(tr);
        Table1.PrintRow(cont); 
        Table1.PrintColumns();
        cont++;
        
        rowDataSuc1.Next();
      }
      rowDataSuc2.Next();
    }
    
    private void Table1_ManualBuild(object sender, EventArgs e)
    {
      int iCount = 0; 
      int cont = 2;
      string strCadenasConexion = ((String)Report.GetParameterValue(&quot;conexiones&quot;));//TextBox1.Text;//&quot;initial catalog=C:\\IposProject\\iPosRopa\\iPos\\iPos\\bin\\Debug\\sampdata\\IPOSDB.fdb;user id=sysdba;password=masterkey|initial catalog=C:\\IPOSTHINGS\\fama\\fama.fdb;user id=sysdba;password=masterkey&quot;;
      
      string[] cadenasConexion  = strCadenasConexion.Split(new string[] { &quot;masterkey&quot; }, StringSplitOptions.None); //strCadenasConexion.Split('|');
      
      List&lt;decimal&gt; datosIEPS = new List&lt;decimal&gt;();
      
 
      foreach(string strCadena in cadenasConexion)
      {                                         
        if(strCadena.Trim().Length == 0)
          continue;

        GuardarHeadersIEPS(ref datosIEPS, strCadena+ &quot;masterkey&quot;);
      }
        ImprimirHeaders(ref datosIEPS);
      
      foreach(string strCadena in cadenasConexion)
      {                                         
        if(strCadena.Trim().Length == 0)
          continue;

        ImprimirRegistros(strCadena + &quot;masterkey&quot;, cont, ref datosIEPS);
        cont++;
      }
     
    }
  }
}
</ScriptText>
  <Dictionary>
    <FirebirdDataConnection Name="Connection" ConnectionString="rijcmlqDEsChHWgW5OFiwSyA3zls2mCAWDWIhtE3dZ3WRoD3RGa4fuV4MzKWm/7hfiVWbDFvOZVx8SOHX0gb5rmLrybnbvH2HsHWOfPgCFQoKr29izDhiy+8Awj/+LeDV/2ybkkaRwuppBeY+kFp2ZduFz9ulR4TCuKi6Kt034dXvLooc8=">
      <TableDataSource Name="Table" DataType="System.Int32" Enabled="true" SelectCommand="SELECT S.*, MOVTO.tasaieps,  MOVTO.ieps MONTOIEPS ,&#13;&#10;CASE WHEN DOCTO.TIPODOCTOID = 11 AND COALESCE(DOCTO.SUBTIPODOCTOID,0) IN (6,23) THEN '(MATRIZ)' &#13;&#10;         WHEN DOCTO.TIPODOCTOID = 41 THEN SUCURSALT.CLAVE &#13;&#10;         ELSE ''&#13;&#10;END AS SUCURSALORIGEN,&#13;&#10;&#13;&#10;&#13;&#10;CASE WHEN (DOCTO.TIPODOCTOID = 11 AND COALESCE(DOCTO.SUBTIPODOCTOID,0) IN (6,23)) OR DOCTO.TIPODOCTOID = 41 THEN DOCTO.REFERENCIA&#13;&#10;         ELSE ''&#13;&#10;END AS REFERENCIAORIGEN,&#13;&#10;&#13;&#10;SUCURSAL.CLAVE CLAVESUCURSAL,&#13;&#10;SUCURSAL.NOMBRE NOMBRESUCURSAL,&#13;&#10;SUBTIPODOCTO.NOMBRE NOMBRESUBTIPODOCTO&#13;&#10;&#13;&#10;FROM&#13;&#10;REP_VENTA_CONIEPS_DETALLE_EXP(&#13;&#10;    @FECHAINI ,&#13;&#10;    @FECHAFIN ,&#13;&#10;    @TIPODOCTOID ,&#13;&#10;    @ALMACENID ,&#13;&#10;    @VENDEDORID,&#13;&#10;    @STR_REMISIONFACTURA,&#13;&#10;    'N') S&#13;&#10;LEFT JOIN MOVTO ON MOVTO.ID = S.MOVTOID&#13;&#10;LEFT JOIN DOCTO ON DOCTO.ID = MOVTO.DOCTOID&#13;&#10;LEFT JOIN SUCURSAL SUCURSALT ON SUCURSALT.ID = DOCTO.SUCURSALTID&#13;&#10;LEFT JOIN PARAMETRO ON 1 = 1&#13;&#10;LEFT JOIN SUCURSAL ON SUCURSAL.ID = PARAMETRO.SUCURSALID&#13;&#10;LEFT JOIN SUBTIPODOCTO ON DOCTO.SUBTIPODOCTOID = SUBTIPODOCTO.ID and DOCTO.TIPODOCTOID = 11&#13;&#10;WHERE (coalesce(DOCTO.SUBTIPODOCTOID,0) = @SUBTIPO or @SUBTIPO = 0 or (coalesce(DOCTO.SUBTIPODOCTOID,0) = 0 AND @SUBTIPO = -1)   or (COALESCE(DOCTO.SUBTIPODOCTOID,0) IN (23,6) AND @SUBTIPO = 23))&#13;&#10;order by fecha">
        <Column Name="NUMERO" DataType="System.Int32"/>
        <Column Name="FECHA" DataType="System.DateTime"/>
        <Column Name="SUBTOTAL" DataType="System.Decimal"/>
        <Column Name="IVA" DataType="System.Decimal"/>
        <Column Name="TOTAL" DataType="System.Decimal"/>
        <Column Name="ESFACTURAELECTRONICA" DataType="System.String"/>
        <Column Name="IEPS" DataType="System.Decimal"/>
        <Column Name="IMPUESTO" DataType="System.Decimal"/>
        <Column Name="IEPS_01_IMPORTE" DataType="System.Decimal"/>
        <Column Name="IEPS_01_PORC" DataType="System.Decimal"/>
        <Column Name="IEPS_02_IMPORTE" DataType="System.Decimal"/>
        <Column Name="IEPS_02_PORC" DataType="System.Decimal"/>
        <Column Name="IEPS_03_IMPORTE" DataType="System.Decimal"/>
        <Column Name="IEPS_03_PORC" DataType="System.Decimal"/>
        <Column Name="IEPS_04_IMPORTE" DataType="System.Decimal"/>
        <Column Name="IEPS_04_PORC" DataType="System.Decimal"/>
        <Column Name="IEPS_05_IMPORTE" DataType="System.Decimal"/>
        <Column Name="IEPS_05_PORC" DataType="System.Decimal"/>
        <Column Name="IEPS_06_IMPORTE" DataType="System.Decimal"/>
        <Column Name="IEPS_06_PORC" DataType="System.Decimal"/>
        <Column Name="IEPS_07_IMPORTE" DataType="System.Decimal"/>
        <Column Name="IEPS_07_PORC" DataType="System.Decimal"/>
        <Column Name="IEPS_08_IMPORTE" DataType="System.Decimal"/>
        <Column Name="IEPS_08_PORC" DataType="System.Decimal"/>
        <Column Name="IEPS_09_IMPORTE" DataType="System.Decimal"/>
        <Column Name="IEPS_09_PORC" DataType="System.Decimal"/>
        <Column Name="IEPS_10_IMPORTE" DataType="System.Decimal"/>
        <Column Name="IEPS_10_PORC" DataType="System.Decimal"/>
        <Column Name="ESTATUS" DataType="System.String"/>
        <Column Name="MARCAID" DataType="System.Int64"/>
        <Column Name="MARCACLAVE" DataType="System.String"/>
        <Column Name="MARCANOMBRE" DataType="System.String"/>
        <Column Name="PRODUCTOID" DataType="System.Int64"/>
        <Column Name="PRODUCTOCLAVE" DataType="System.String"/>
        <Column Name="PRODUCTONOMBRE" DataType="System.String"/>
        <Column Name="PRODUCTODESCRIPCION" DataType="System.String"/>
        <Column Name="MOVTOID" DataType="System.Int64"/>
        <Column Name="DOCTOFOLIO" DataType="System.Int32"/>
        <Column Name="SERIEFOLIOSAT" DataType="System.String"/>
        <Column Name="DOCTOREFKITID" DataType="System.Int64"/>
        <Column Name="NOMBREALMACEN" DataType="System.String"/>
        <Column Name="PERSONA" DataType="System.String"/>
        <Column Name="VENDEDOR" DataType="System.String"/>
        <Column Name="PERSONACLAVE" DataType="System.String"/>
        <Column Name="PERSONANOMBRES" DataType="System.String"/>
        <Column Name="PERSONAAPELLIDOS" DataType="System.String"/>
        <Column Name="FECHAVENCE" DataType="System.DateTime"/>
        <Column Name="CANTIDAD" DataType="System.Decimal"/>
        <Column Name="PRECIO" DataType="System.Decimal"/>
        <Column Name="IMPORTE" DataType="System.Decimal"/>
        <Column Name="DESCUENTO" DataType="System.Decimal"/>
        <Column Name="NOMBRESUCURSALDESTINO" DataType="System.String"/>
        <Column Name="NOMBREALMACENTRASPASO" DataType="System.String"/>
        <Column Name="COSTOPROMEDIO" DataType="System.Decimal"/>
        <Column Name="TIPODOC" DataType="System.String"/>
        <Column Name="LOTE" DataType="System.String"/>
        <Column Name="LOTEVENCE" DataType="System.DateTime"/>
        <Column Name="FECHAHORA" DataType="System.DateTime"/>
        <Column Name="ESKIT" DataType="System.String"/>
        <Column Name="ESPARTEKIT" DataType="System.String"/>
        <Column Name="TASAIEPS" DataType="System.Decimal"/>
        <Column Name="MONTOIEPS" DataType="System.Decimal"/>
        <Column Name="SUCURSALORIGEN" DataType="System.String"/>
        <Column Name="REFERENCIAORIGEN" DataType="System.String"/>
        <Column Name="CLAVESUCURSAL" DataType="System.String"/>
        <Column Name="NOMBRESUCURSAL" DataType="System.String"/>
        <Column Name="NOMBRESUBTIPODOCTO" DataType="System.String"/>
        <CommandParameter Name="FECHAINI" DataType="5" Expression="[FECHAINI]" DefaultValue="01/01/2001"/>
        <CommandParameter Name="FECHAFIN" DataType="5" Expression="[FECHAFIN]" DefaultValue="01/01/2001"/>
        <CommandParameter Name="STR_REMISIONFACTURA" DataType="16" Expression="[REMISIONFACTURA]" DefaultValue="T"/>
        <CommandParameter Name="TIPODOCTOID" DataType="1" Expression="[TIPODOCTOID]" DefaultValue="21"/>
        <CommandParameter Name="VENDEDORID" DataType="1" Expression="[VENDEDORID]" DefaultValue="0"/>
        <CommandParameter Name="ALMACENID" DataType="1" Expression="[ALMACENID]" DefaultValue="0"/>
        <CommandParameter Name="SUBTIPO" DataType="1" Expression="[SUBTIPO]" DefaultValue="0"/>
      </TableDataSource>
      <TableDataSource Name="Table2" Alias="Suc" DataType="System.Int32" Enabled="true" SelectCommand="select first 1 sucursal.clave, sucursal.nombre&#13;&#10;from parametro&#13;&#10;left join sucursal on sucursal.id = parametro.sucursalid">
        <Column Name="CLAVE" DataType="System.String"/>
        <Column Name="NOMBRE" DataType="System.String"/>
      </TableDataSource>
    </FirebirdDataConnection>    <Parameter Name="US_ID" DataType="System.Decimal"/>    <Parameter Name="US_NAME" DataType="System.String"/>
    <Parameter Name="FECHAINI" DataType="System.DateTime"/>
    <Parameter Name="FECHAFIN" DataType="System.DateTime"/>
    <Parameter Name="REMISIONFACTURA" DataType="System.String"/>
    <Parameter Name="VENDEDORID" DataType="System.Decimal"/>
    <Parameter Name="VENDEDORNOMBRE" DataType="System.String"/>
    <Parameter Name="TIPODOCTOID" DataType="System.Decimal"/>
    <Parameter Name="TIPODOCTONOMBRE" DataType="System.String"/>
    <Parameter Name="NOMBREALMACEN" DataType="System.String"/>
    <Parameter Name="ALMACENID" DataType="System.Decimal"/>
    <Parameter Name="SUBTIPO" DataType="System.Decimal"/>
    <Parameter Name="conexiones" DataType="System.String"/>
  </Dictionary>
  <ReportPage Name="Page1" PaperWidth="1050" FirstPageSource="15" OtherPagesSource="15">
    <ReportTitleBand Name="ReportTitle1" Width="3893.4" Height="132.3" BeforePrintEvent="ReportTitle1_BeforePrint">
      <TextObject Name="Text67" Left="113.4" Top="9.45" Width="708.75" Height="28.35" Text="REPORTE DE DETALLE DE ENTRADAS MULTISUCURSAL" Font="Arial, 18pt, style=Bold"/>
      <TextObject Name="Text74" Left="916.65" Top="18.9" Width="94.5" Height="18.9" Text="[Date]" Format="Date" Format.Format="d" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text68" Left="132.3" Top="47.25" Width="94.5" Height="18.9" Text="De la fecha:" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text69" Left="481.95" Top="47.25" Width="94.5" Height="18.9" Text="a:" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text71" Left="236.25" Top="47.25" Width="132.3" Height="18.9" Text="[FECHAINI]" Format="Date" Format.Format="d" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text72" Left="604.8" Top="47.25" Width="170.1" Height="18.9" Text="[FECHAFIN]" Format="Date" Format.Format="d" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text70" Left="132.3" Top="75.6" Width="94.5" Height="18.9" Text="Del tipo:" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text73" Left="236.25" Top="75.6" Width="226.8" Height="18.9" Text="[TIPODOCTONOMBRE]" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text75" Left="481.95" Top="75.6" Width="94.5" Height="18.9" Text="Cajero:" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text76" Left="604.8" Top="75.6" Width="160.65" Height="18.9" Text="[VENDEDORNOMBRE]" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text81" Left="132.3" Top="103.95" Width="94.5" Height="18.9" Text="Del almacen:" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text82" Left="236.25" Top="103.95" Width="226.8" Height="18.9" Text="[NOMBREALMACEN]" Font="Arial, 10pt, style=Bold"/>
    </ReportTitleBand>
    <PageHeaderBand Name="PageHeader1" Top="136.3" Width="3893.4" Height="9.45"/>
    <DataBand Name="Data1" Top="149.75" Width="3893.4" Height="66.15">
      <TableObject Name="Table1" Top="9.45" Width="3808.35" Height="37.8" ManualBuildEvent="Table1_ManualBuild">
        <TableColumn Name="Column1" Width="94.5"/>
        <TableColumn Name="Column2" Width="226.8"/>
        <TableColumn Name="Column3" Width="94.5"/>
        <TableColumn Name="Column4" Width="94.5"/>
        <TableColumn Name="Column5" Width="94.5"/>
        <TableColumn Name="Column6" Width="94.5"/>
        <TableColumn Name="Column7" Width="94.5"/>
        <TableColumn Name="Column8" Width="132.3"/>
        <TableColumn Name="Column9" Width="160.65"/>
        <TableColumn Name="Column10" Width="103.95"/>
        <TableColumn Name="Column11" Width="103.95"/>
        <TableColumn Name="Column12" Width="94.5"/>
        <TableColumn Name="Column13" Width="94.5"/>
        <TableColumn Name="Column14" Width="94.5"/>
        <TableColumn Name="Column15" Width="94.5"/>
        <TableColumn Name="Column16" Width="94.5"/>
        <TableColumn Name="Column17" Width="94.5"/>
        <TableColumn Name="Column18" Width="94.5"/>
        <TableColumn Name="Column19" Width="94.5"/>
        <TableColumn Name="Column20" Width="94.5"/>
        <TableColumn Name="Column21" Width="94.5"/>
        <TableColumn Name="Column22" Width="94.5"/>
        <TableColumn Name="Column23" Width="94.5"/>
        <TableColumn Name="Column24" Width="94.5"/>
        <TableColumn Name="Column25" Width="94.5"/>
        <TableColumn Name="Column26" Width="103.95"/>
        <TableColumn Name="Column27" Width="94.5"/>
        <TableColumn Name="Column28" Width="94.5"/>
        <TableColumn Name="Column29" Width="94.5"/>
        <TableColumn Name="Column30" Width="94.5"/>
        <TableColumn Name="Column31" Width="94.5"/>
        <TableColumn Name="Column32" Width="94.5"/>
        <TableColumn Name="Column33" Width="94.5"/>
        <TableColumn Name="Column34" Width="94.5"/>
        <TableColumn Name="Column35" Width="103.95"/>
        <TableColumn Name="Column36" Width="94.5"/>
        <TableColumn Name="Column37"/>
        <TableColumn Name="Column38"/>
        <TableRow Name="Row1" Height="37.8">
          <TableCell Name="Cell1"/>
          <TableCell Name="Cell2"/>
          <TableCell Name="Cell3"/>
          <TableCell Name="Cell4"/>
          <TableCell Name="Cell5"/>
          <TableCell Name="Cell26"/>
          <TableCell Name="Cell27"/>
          <TableCell Name="Cell28"/>
          <TableCell Name="Cell29"/>
          <TableCell Name="Cell30"/>
          <TableCell Name="Cell31"/>
          <TableCell Name="Cell32"/>
          <TableCell Name="Cell33"/>
          <TableCell Name="Cell34"/>
          <TableCell Name="Cell35"/>
          <TableCell Name="Cell36"/>
          <TableCell Name="Cell37"/>
          <TableCell Name="Cell38"/>
          <TableCell Name="Cell39"/>
          <TableCell Name="Cell40"/>
          <TableCell Name="Cell41"/>
          <TableCell Name="Cell42"/>
          <TableCell Name="Cell43"/>
          <TableCell Name="Cell44"/>
          <TableCell Name="Cell45"/>
          <TableCell Name="Cell46"/>
          <TableCell Name="Cell47"/>
          <TableCell Name="Cell48"/>
          <TableCell Name="Cell49"/>
          <TableCell Name="Cell50"/>
          <TableCell Name="Cell51"/>
          <TableCell Name="Cell52"/>
          <TableCell Name="Cell53"/>
          <TableCell Name="Cell54"/>
          <TableCell Name="Cell55"/>
          <TableCell Name="Cell56"/>
          <TableCell Name="Cell57"/>
          <TableCell Name="Cell58"/>
        </TableRow>
      </TableObject>
    </DataBand>
    <PageFooterBand Name="PageFooter1" Top="219.9" Width="3893.4" Height="18.9"> <TextObject Name="TextFooterGeneral2" Left="151.2" Width="66.15" Height="18.9" PrintOn="LastPage, OddPages, EvenPages, RepeatedBand, SinglePage" Text="[Date]" Format="Date" Format.Format="d" Font="Arial, 8pt, style=Bold"/> <TextObject Name="TextFooterGeneral3" Left="217.35" Width="151.2" Height="18.9" CanShrink="true" PrintOn="LastPage, OddPages, EvenPages, RepeatedBand, SinglePage" CanBreak="false" Text="[Date]" Format="Time" Format.Format="T" WordWrap="false" Font="Arial, 8pt, style=Bold"/> <TextObject Name="TextFooterGeneral1" Left="9.45" Width="141.75" Height="18.9" CanShrink="true" CanBreak="false" Text="Power by I-POS" HorzAlign="Center" WordWrap="false" Font="Arial, 8pt, style=Bold"/> <TextObject Name="TextFooterGeneral4" Left="368.55" Width="94.5" Height="18.9" Text="[US_NAME]" Font="Arial, 8pt, style=Bold"/> </PageFooterBand>
  </ReportPage>
</Report>
