<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReportInfo.Created="12/14/2016 15:50:19" ReportInfo.Modified="12/18/2016 10:20:36" ReportInfo.CreatorVersion="2013.3.2.0">
  <ScriptText>using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;
using System.Drawing;
using System.Data;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;

namespace FastReport
{
  public class ReportScript
  {

    private void Picture1_BeforePrint(object sender, EventArgs e)
    {
      Picture1.ImageLocation =  ((String)Report.GetColumnValue(&quot;Empresa.LOGOIMAGE&quot;)).Replace(&quot;{BaseDirectory}&quot;, System.IO.Path.GetDirectoryName(Report.FileName ) + &quot;\\..\\..&quot; ) ;    
    }
  }
}
</ScriptText>
  <Dictionary>
    <FirebirdDataConnection Name="Connection" ConnectionString="rijcmlqDEsChHWgW5OFiwSyA3zls2mCAWDWIhtE3dZ3WRoD3RGa4fuV4MzKWm/7hfiVWbDFvOZVx8SOHX0gb5rmLrybnbvH2HsHWOfPgCFQoKr29izDhiy+8Awj/+LeDV/2ybkkaRwuppBeY+kFp2ZduFz9uuKfb6dPusXbo8/iCkYvdRY=">
      <TableDataSource Name="Table" Alias="Guia" DataType="System.Int32" Enabled="true" SelectCommand="select&#13;&#10;guia.id guiaid,&#13;&#10;guia.encargadoguiaid,&#13;&#10;guia.estadoguiaid,&#13;&#10;guia.cajeroid,&#13;&#10;guia.fecha,&#13;&#10;guia.fechahora,&#13;&#10;guia.nota,&#13;&#10;&#13;&#10;persona.nombre encargadonombre,&#13;&#10;estadoguia.nombre estadoguia,&#13;&#10;&#13;&#10;cajero.nombre cajeronombre&#13;&#10;&#13;&#10;from&#13;&#10;guia&#13;&#10;left join persona on persona.id = guia.encargadoguiaid&#13;&#10;left join persona cajero on cajero.id = guia.cajeroid&#13;&#10;left join estadoguia on estadoguia.id = guia.estadoguiaid&#13;&#10;&#13;&#10;where guia.id = @guiaid">
        <Column Name="GUIAID" DataType="System.Int64"/>
        <Column Name="ENCARGADOGUIAID" DataType="System.Int64"/>
        <Column Name="ESTADOGUIAID" DataType="System.Int64"/>
        <Column Name="CAJEROID" DataType="System.Int64"/>
        <Column Name="FECHA" DataType="System.DateTime"/>
        <Column Name="FECHAHORA" DataType="System.DateTime"/>
        <Column Name="NOTA" DataType="System.String"/>
        <Column Name="ENCARGADONOMBRE" DataType="System.String"/>
        <Column Name="ESTADOGUIA" DataType="System.String"/>
        <Column Name="CAJERONOMBRE" DataType="System.String"/>
        <CommandParameter Name="guiaid" DataType="1" Expression="[guiaid]" DefaultValue="0"/>
      </TableDataSource>
      <TableDataSource Name="Table1" Alias="Venta" DataType="System.Int32" Enabled="true" SelectCommand="select&#13;&#10;docto.id,&#13;&#10;docto.folio,&#13;&#10;docto.serie,&#13;&#10;docto.foliosat,&#13;&#10;docto.seriesat,&#13;&#10;docto.personaid clienteid,&#13;&#10;docto.vendedorid,&#13;&#10;docto.total total,&#13;&#10;&#13;&#10;docto.fecha,&#13;&#10;&#13;&#10;persona.nombre clientenombre,&#13;&#10;persona.nombres clientenombres,&#13;&#10;persona.apellidos clienteapellidos,&#13;&#10;persona.domicilio clientedomicilio,&#13;&#10;persona.colonia clientecolonia,&#13;&#10;persona.ciudad clienteciudad,&#13;&#10;persona.numeroexterior clientenumeroexterior,&#13;&#10;persona.numerointerior  clientenumerointerior,&#13;&#10;&#13;&#10;&#13;&#10;vendedor.nombre vendedornombre,&#13;&#10;&#13;&#10;movto.id movtoid,&#13;&#10;movto.cantidad cantidad,&#13;&#10;movto.productoid,&#13;&#10;movto.precio,&#13;&#10;movto.total movtototal,&#13;&#10;&#13;&#10;producto.clave productoclave,&#13;&#10;producto.nombre productonombre,&#13;&#10;producto.descripcion productodescripcion,&#13;&#10;producto.descripcion2 productodescripcion2&#13;&#10;&#13;&#10;&#13;&#10;from guiadetalle &#13;&#10;left join docto on guiadetalle.doctoid = docto.id&#13;&#10;left join persona on persona.id = docto.personaid&#13;&#10;left join persona vendedor on vendedor.id = docto.vendedorid&#13;&#10;left join movto on movto.doctoid = docto.id&#13;&#10;left join producto on producto.id = movto.productoid&#13;&#10;&#13;&#10;where guiadetalle.guiaid = @guiaid">
        <Column Name="ID" DataType="System.Int64"/>
        <Column Name="FOLIO" DataType="System.Int32"/>
        <Column Name="SERIE" DataType="System.String"/>
        <Column Name="FOLIOSAT" DataType="System.Int32"/>
        <Column Name="SERIESAT" DataType="System.String"/>
        <Column Name="CLIENTEID" DataType="System.Int64"/>
        <Column Name="VENDEDORID" DataType="System.Int64"/>
        <Column Name="TOTAL" DataType="System.Decimal"/>
        <Column Name="CLIENTENOMBRE" DataType="System.String"/>
        <Column Name="CLIENTENOMBRES" DataType="System.String"/>
        <Column Name="CLIENTEAPELLIDOS" DataType="System.String"/>
        <Column Name="CLIENTEDOMICILIO" DataType="System.String"/>
        <Column Name="CLIENTECOLONIA" DataType="System.String"/>
        <Column Name="CLIENTECIUDAD" DataType="System.String"/>
        <Column Name="VENDEDORNOMBRE" DataType="System.String"/>
        <Column Name="MOVTOID" DataType="System.Int64"/>
        <Column Name="CANTIDAD" DataType="System.Decimal"/>
        <Column Name="PRODUCTOID" DataType="System.Int64"/>
        <Column Name="PRECIO" DataType="System.Decimal"/>
        <Column Name="MOVTOTOTAL" DataType="System.Decimal"/>
        <Column Name="PRODUCTOCLAVE" DataType="System.String"/>
        <Column Name="PRODUCTONOMBRE" DataType="System.String"/>
        <Column Name="PRODUCTODESCRIPCION" DataType="System.String"/>
        <Column Name="PRODUCTODESCRIPCION2" DataType="System.String"/>
        <Column Name="FECHA" DataType="System.DateTime"/>
        <Column Name="CLIENTENUMEROEXTERIOR" DataType="System.String"/>
        <Column Name="CLIENTENUMEROINTERIOR" DataType="System.String"/>
        <CommandParameter Name="guiaid" DataType="1" Expression="[guiaid]" DefaultValue="0"/>
      </TableDataSource>
      <TableDataSource Name="Table2" Alias="Empresa" DataType="System.Int32" Enabled="true" SelectCommand="select &#13;&#10;parametro.nombre,&#13;&#10;parametro.calle,&#13;&#10;parametro.numeroexterior,&#13;&#10;parametro.numerointerior,&#13;&#10;parametro.colonia,&#13;&#10;parametro.localidad,&#13;&#10;parametro.estado,&#13;&#10;parametro.cp,&#13;&#10;parametro.telefono,&#13;&#10;parametro.rfc,&#13;&#10;parametro.correoe,&#13;&#10;sucursal.nombre nombresucursal,&#13;&#10;parametro.FACT_ELECT_FOLDER&#13;&#10;||  '\facturaelectronica\IMG\logofarmafree.png'  as logoimage&#13;&#10;&#13;&#10;from parametro&#13;&#10;left join sucursal on sucursal.id = parametro.sucursalid;">
        <Column Name="NOMBRE" DataType="System.String"/>
        <Column Name="CALLE" DataType="System.String"/>
        <Column Name="NUMEROEXTERIOR" DataType="System.String"/>
        <Column Name="NUMEROINTERIOR" DataType="System.String"/>
        <Column Name="COLONIA" DataType="System.String"/>
        <Column Name="LOCALIDAD" DataType="System.String"/>
        <Column Name="ESTADO" DataType="System.String"/>
        <Column Name="CP" DataType="System.String"/>
        <Column Name="TELEFONO" DataType="System.String"/>
        <Column Name="RFC" DataType="System.String"/>
        <Column Name="CORREOE" DataType="System.String"/>
        <Column Name="NOMBRESUCURSAL" DataType="System.String"/>
        <Column Name="LOGOIMAGE" DataType="System.String"/>
      </TableDataSource>
    </FirebirdDataConnection>    <Parameter Name="US_ID" DataType="System.Decimal"/>    <Parameter Name="US_NAME" DataType="System.String"/>
    <Parameter Name="guiaid" DataType="System.Decimal"/>
  </Dictionary>
  <ReportPage Name="Page1">
    <ReportTitleBand Name="ReportTitle1" Width="718.2" Height="321.3">
      <TextObject Name="Text90" Left="349.65" Top="122.85" Width="340.2" Height="18.9" Text="[&quot;Telefono: &quot;] [Empresa.TELEFONO] [&quot;Colonia: &quot;] [Empresa.CP]" HorzAlign="Center" Font="Arial, 9pt"/>
      <TextObject Name="Text91" Left="18.9" Top="113.4" Width="94.5" Height="18.9" Text="Expedición" Font="Arial, 9pt, style=Bold"/>
      <TextObject Name="Text92" Left="349.65" Top="103.95" Width="340.2" Height="18.9" Text="[Empresa.COLONIA]" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt"/>
      <TextObject Name="Text93" Left="349.65" Top="85.05" Width="340.2" Height="18.9" Text="[Empresa.CALLE] [Empresa.NUMEROEXTERIOR] [Empresa.NUMEROINTERIOR]" HorzAlign="Center" Font="Arial, 9pt"/>
      <TextObject Name="Text94" Left="349.65" Top="66.15" Width="340.2" Height="18.9" Text="[Empresa.RFC]" HorzAlign="Center" Font="Arial, 9pt"/>
      <TextObject Name="Text95" Left="349.65" Top="47.25" Width="340.2" Height="18.9" Text="[Empresa.NOMBRESUCURSAL]" HorzAlign="Center" Font="Arial, 9pt"/>
      <ShapeObject Name="Shape1" Left="330.75" Top="39.69" Width="387.45" Height="103.95" Shape="RoundRectangle"/>
      <TextObject Name="Text96" Left="434.7" Top="9.45" Width="292.95" Height="18.9" Text="GUIA [Guia.GUIAID]" Font="Arial, 11pt"/>
      <PictureObject Name="Picture1" Left="18.9" Top="9.45" Width="170.1" Height="85.05" BeforePrintEvent="Picture1_BeforePrint"/>
      <LineObject Name="Line1" Left="444.15" Top="151.2" Width="245.7"/>
      <TextObject Name="Text87" Left="75.6" Top="132.3" Width="236.25" Height="18.9" Text="[Guia.FECHA]" Format="Date" Format.Format="d" Font="Arial, 9pt"/>
      <TextObject Name="Text89" Left="18.9" Top="132.3" Width="47.25" Height="18.9" Text="Fecha" Font="Arial, 9pt, style=Bold"/>
      <LineObject Name="Line2" Left="444.15" Top="170.1" Width="245.7"/>
      <LineObject Name="Line3" Left="444.15" Top="189" Width="245.7"/>
      <LineObject Name="Line4" Left="415.8" Top="217.35" Width="283.5"/>
      <ShapeObject Name="Shape3" Top="226.8" Width="718.2" Height="56.7" Shape="RoundRectangle"/>
      <TextObject Name="Text33" Left="94.5" Top="236.25" Width="595.35" Height="18.9" Text="[Guia.ENCARGADONOMBRE]" Font="Arial, 9pt"/>
      <TextObject Name="Text64" Left="9.45" Top="236.25" Width="75.6" Height="18.9" Text="Encargado&#13;&#10;:" Font="Arial, 8.25pt, style=Bold"/>
      <TextObject Name="Text34" Left="94.5" Top="255.15" Width="595.35" Height="18.9" Text="[Guia.NOTA]" Font="Arial, 9pt"/>
      <LineObject Name="Line5" Left="9.45" Top="255.15" Width="699.3"/>
      <TextObject Name="Text66" Left="9.45" Top="255.15" Width="56.7" Height="18.9" Text="Nota :" Font="Arial, 8.25pt, style=Bold"/>
      <ShapeObject Name="Shape4" Top="283.5" Width="718.2" Height="37.8" Shape="RoundRectangle"/>
      <TextObject Name="Text78" Left="340.2" Top="283.5" Width="179.55" Height="37.8" Text="Domicilio" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt, style=Bold"/>
      <TextObject Name="Text74" Left="519.75" Top="283.5" Width="103.95" Height="37.8" Text="Vendedor" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt, style=Bold"/>
      <TextObject Name="Text77" Top="292.95" Width="56.7" Height="18.9" Text="Venta" HorzAlign="Center" Font="Arial, 9pt, style=Bold"/>
      <TextObject Name="Text79" Left="623.7" Top="292.95" Width="94.5" Height="18.9" Text="Total" HorzAlign="Center" Font="Arial, 9pt, style=Bold"/>
      <TextObject Name="Text73" Left="56.7" Top="292.95" Width="66.15" Height="18.9" Text="Factura" HorzAlign="Center" Font="Arial, 9pt, style=Bold"/>
      <TextObject Name="Text75" Left="122.85" Top="292.95" Width="75.6" Height="18.9" Text="Fecha" HorzAlign="Center" Font="Arial, 9pt, style=Bold"/>
      <TextObject Name="Text76" Left="198.45" Top="292.95" Width="141.75" Height="18.9" Text="Cliente" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt, style=Bold"/>
      <LineObject Name="Line7" Left="56.7" Top="321.3" Height="-37.8"/>
      <LineObject Name="Line8" Left="198.45" Top="321.3" Height="-37.8"/>
      <LineObject Name="Line10" Left="519.75" Top="321.3" Height="-37.8"/>
      <LineObject Name="Line19" Left="623.7" Top="321.3" Height="-37.8"/>
      <LineObject Name="Line18" Left="122.85" Top="321.3" Height="-37.8"/>
      <LineObject Name="Line20" Left="340.2" Top="321.3" Height="-37.8"/>
      <TextObject Name="Text97" Left="75.6" Top="151.2" Width="236.25" Height="18.9" Text="[Guia.FECHAHORA]" Format="Time" Format.Format="t" Font="Arial, 9pt"/>
      <TextObject Name="Text98" Left="18.9" Top="151.2" Width="47.25" Height="18.9" Text="Hora" Font="Arial, 9pt, style=Bold"/>
      <TextObject Name="Text99" Left="75.6" Top="170.1" Width="302.4" Height="18.9" Text="[Guia.CAJERONOMBRE]" Format="Date" Format.Format="d" Font="Arial, 9pt"/>
      <TextObject Name="Text100" Left="18.9" Top="170.1" Width="47.25" Height="18.9" Text="Cajero" Font="Arial, 9pt, style=Bold"/>
    </ReportTitleBand>
    <PageHeaderBand Name="PageHeader1" Top="325.3" Width="718.2"/>
    <GroupHeaderBand Name="GroupHeader1" Top="329.3" Width="718.2" Height="18.9" CanGrow="true" Condition="[Venta.ID]">
      <TextObject Name="Text11" Width="56.7" Height="18.9" Text="[Venta.FOLIO]" Font="Arial, 8pt"/>
      <TextObject Name="Text13" Left="56.7" Width="66.15" Height="18.9" Text="[Venta.FOLIOSAT]  [Venta.SERIESAT]" Font="Arial, 8pt"/>
      <TextObject Name="Text19" Left="198.45" Width="141.75" Height="18.9" CanGrow="true" Text="[Venta.CLIENTENOMBRE]" Font="Arial, 8pt"/>
      <TextObject Name="Text21" Left="340.2" Width="179.55" Height="18.9" CanGrow="true" Text="[Venta.CLIENTEDOMICILIO] [Venta.CLIENTENUMEROEXTERIOR] [Venta.CLIENTENUMEROINTERIOR] [Venta.CLIENTECOLONIA] [Venta.CLIENTECIUDAD]" Font="Arial, 8pt"/>
      <TextObject Name="Text25" Left="519.75" Width="103.95" Height="18.9" CanGrow="true" Text="[Venta.VENDEDORNOMBRE]" Font="Arial, 8pt"/>
      <TextObject Name="Text27" Left="623.7" Width="94.5" Height="18.9" Text="[Venta.TOTAL]" Format="Currency" Format.UseLocale="true" HorzAlign="Right" WordWrap="false" Font="Arial, 8pt" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text1" Left="122.85" Width="75.6" Height="18.9" Text="[Venta.FECHA]" Format="Date" Format.Format="d" Font="Arial, 8pt"/>
      <ChildBand Name="Child1" Top="352.2" Width="718.2" Height="18.9" Visible="false">
        <TextObject Name="Text59" Left="56.7" Width="85.05" Height="18.9" Text="Cantidad" Font="Arial, 8pt, style=Bold"/>
        <TextObject Name="Text60" Left="141.75" Width="122.85" Height="18.9" Text="Producto" Font="Arial, 8pt, style=Bold"/>
        <TextObject Name="Text61" Left="264.6" Width="189" Height="18.9" Text="Descripcion" Font="Arial, 8pt, style=Bold"/>
        <TextObject Name="Text62" Left="453.6" Width="151.2" Height="18.9" Text="Descripcion 2" Font="Arial, 8pt, style=Bold"/>
        <TextObject Name="Text63" Left="604.8" Width="189" Height="18.9" Text="Total" Font="Arial, 8pt, style=Bold"/>
      </ChildBand>
      <DataBand Name="Data1" Top="375.1" Width="718.2" Height="18.9" Visible="false" CanGrow="true" DataSource="Table1">
        <TextObject Name="Text29" Left="56.7" Width="85.05" Height="18.9" Text="[Venta.CANTIDAD]" Format="Number" Format.UseLocale="true" HorzAlign="Right" WordWrap="false" Font="Arial, 7pt" Trimming="EllipsisCharacter"/>
        <TextObject Name="Text30" Left="141.75" Width="122.85" Height="18.9" Text="[Venta.PRODUCTONOMBRE]" Font="Arial, 7pt"/>
        <TextObject Name="Text31" Left="264.6" Width="189" Height="18.9" Text="[Venta.PRODUCTODESCRIPCION]" Font="Arial, 7pt"/>
        <TextObject Name="Text32" Left="453.6" Width="151.2" Height="18.9" Text="[Venta.PRODUCTODESCRIPCION2]" Font="Arial, 7pt"/>
        <TextObject Name="Text49" Left="604.8" Width="94.5" Height="18.9" Text="[Venta.TOTAL]" Format="Currency" Format.UseLocale="true" HorzAlign="Right" WordWrap="false" Font="Arial, 7pt" Trimming="EllipsisCharacter"/>
      </DataBand>
      <GroupFooterBand Name="GroupFooter1" Top="398" Width="718.2" Height="9.45" Visible="false"/>
    </GroupHeaderBand>
    <PageFooterBand Name="PageFooter1" Top="411.45" Width="718.2" Height="18.9"> <TextObject Name="TextFooterGeneral2" Left="151.2" Width="66.15" Height="18.9" PrintOn="LastPage, OddPages, EvenPages, RepeatedBand, SinglePage" Text="[Date]" Format="Date" Format.Format="d" Font="Arial, 8pt, style=Bold"/> <TextObject Name="TextFooterGeneral3" Left="217.35" Width="151.2" Height="18.9" CanShrink="true" PrintOn="LastPage, OddPages, EvenPages, RepeatedBand, SinglePage" CanBreak="false" Text="[Date]" Format="Time" Format.Format="T" WordWrap="false" Font="Arial, 8pt, style=Bold"/> <TextObject Name="TextFooterGeneral1" Left="9.45" Width="141.75" Height="18.9" CanShrink="true" CanBreak="false" Text="Power by I-POS" HorzAlign="Center" WordWrap="false" Font="Arial, 8pt, style=Bold"/> <TextObject Name="TextFooterGeneral4" Left="368.55" Width="94.5" Height="18.9" Text="[US_NAME]" Font="Arial, 8pt, style=Bold"/> </PageFooterBand>
  </ReportPage>
</Report>
